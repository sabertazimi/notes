"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([["49311"],{3672(e,n,r){r.r(n),r.d(n,{metadata:()=>s,default:()=>h,frontMatter:()=>i,contentTitle:()=>a,toc:()=>c,assets:()=>l});var s=JSON.parse('{"id":"web/javascript/error","title":"Error and Exception","description":"Error","source":"@site/content/web/javascript/error.md","sourceDirName":"web/javascript","slug":"/web/javascript/error","permalink":"/notes/web/javascript/error","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/web/javascript/error.md","tags":[{"inline":true,"label":"Web","permalink":"/notes/tags/web"},{"inline":true,"label":"JavaScript","permalink":"/notes/tags/java-script"},{"inline":true,"label":"ECMAScript","permalink":"/notes/tags/ecma-script"},{"inline":true,"label":"Error","permalink":"/notes/tags/error"},{"inline":true,"label":"Exception","permalink":"/notes/tags/exception"}],"version":"current","lastUpdatedBy":"Sabertaz","lastUpdatedAt":1769518084000,"sidebarPosition":25,"frontMatter":{"sidebar_position":25,"tags":["Web","JavaScript","ECMAScript","Error","Exception"]},"sidebar":"tutorialSidebar","previous":{"title":"Proxy and Reflect","permalink":"/notes/web/javascript/proxy"},"next":{"title":"Regular Expression","permalink":"/notes/web/javascript/regexp"}}'),o=r(62615),t=r(30416);let i={sidebar_position:25,tags:["Web","JavaScript","ECMAScript","Error","Exception"]},a="Error and Exception",l={},c=[{value:"Error",id:"error",level:2},{value:"Type",id:"type",level:3},{value:"Object",id:"object",level:3},{value:"Exception",id:"exception",level:2},{value:"Call Stack Overflow",id:"call-stack-overflow",level:3},{value:"Handler",id:"handler",level:3}];function d(e){let n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"error-and-exception",children:"Error and Exception"})}),"\n",(0,o.jsx)(n.h2,{id:"error",children:"Error"}),"\n",(0,o.jsx)(n.h3,{id:"type",children:"Type"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Error."}),"\n",(0,o.jsx)(n.li,{children:"EvalError."}),"\n",(0,o.jsx)(n.li,{children:"RangeError."}),"\n",(0,o.jsx)(n.li,{children:"ReferenceError."}),"\n",(0,o.jsx)(n.li,{children:"SyntaxError."}),"\n",(0,o.jsx)(n.li,{children:"TypeError."}),"\n",(0,o.jsx)(n.li,{children:"URIError."}),"\n",(0,o.jsx)(n.li,{children:"AggregateError."}),"\n",(0,o.jsx)(n.li,{children:"\u81EA\u5B9A\u4E49\u9519\u8BEF."}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"class Error {\n  // Instance properties\n  message: string\n  cause?: any // ES2022\n  stack: string // non-standard but widely supported\n\n  constructor(message = '', options?: ErrorOptions) {\n    this.name = 'Error'\n    this.message = message\n    this.cause = options?.cause // ES2022: error chain.\n  }\n}\n\ninterface ErrorOptions {\n  cause?: string | Error // ES2022\n}\n\nclass CustomError extends Error {\n  constructor(message, options) {\n    super(message, options)\n    this.name = 'CustomError'\n  }\n}\n"})}),"\n",(0,o.jsx)(n.h3,{id:"object",children:"Object"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"const err = {\n  name: 'XXError',\n  message: 'something wrong',\n  extra: 'This was rather embarrassing',\n  remedy: genericErrorHandler, // \u5904\u7406\u9519\u8BEF\u7684\u51FD\u6570\u540D.\n}\n\ntry {\n  throwError()\n} catch (e) {\n  console.log(e.message)\n  e.remedy() // genericErrorHandler.\n}\n"})}),"\n",(0,o.jsx)(n.h2,{id:"exception",children:"Exception"}),"\n",(0,o.jsx)(n.h3,{id:"call-stack-overflow",children:"Call Stack Overflow"}),"\n",(0,o.jsx)(n.p,{children:"\u8C03\u7528\u6808\u5C3A\u5BF8\u9650\u5236\u5F02\u5E38, \u5E94\u7ACB\u5373\u5B9A\u4F4D\u5728\u4EE3\u7801\u4E2D\u7684\u9012\u5F52\u5B9E\u4F8B\u4E0A:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"try {\n  recursion()\n} catch (ex) {\n  console.error('error info')\n}\n"})}),"\n",(0,o.jsx)(n.h3,{id:"handler",children:"Handler"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"try catch"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"Promise.catch"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"window.addEventListener('error', handler, true)"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"window.addEventListener('unhandledrejection', handler, true)"}),"."]}),"\n",(0,o.jsx)(n.li,{children:"Web Worker heartbeat monitoring."}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"process.on('uncaughtException', handleError)"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"process.on('SIGHUP', handleExit)"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"process.on('SIGINT', handleExit)"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"process.on('SIGQUIT', handleExit)"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"process.on('SIGTERM', handleExit)"}),"."]}),"\n",(0,o.jsx)(n.li,{children:"AOP (Aspect Oriented Programming): Middleware/Interceptor/Monkey Patch."}),"\n",(0,o.jsxs)(n.li,{children:["\u5728\u53EF\u80FD\u5931\u8D25\u7684\u5730\u65B9\u629B\u51FA\u5F02\u5E38, \u5BF9\u5931\u8D25\u5904\u505A\u6807\u7B7E, \u6613\u4E8E",(0,o.jsx)(n.strong,{children:"\u8C03\u8BD5\u4E0E\u6D4B\u8BD5"}),"."]}),"\n",(0,o.jsx)(n.li,{children:"\u4FEE\u590D bug \u540E, \u53EF\u8003\u8651\u662F\u5426\u5728\u6B64\u5904\u629B\u51FA\u5F02\u5E38."}),"\n",(0,o.jsx)(n.li,{children:"Avoid using try-catch inside a loop:"}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"const object = ['foo', 'bar']\n\ntry {\n  for (let i = 0; i < object.length; i++) {\n    // do something that throws an exception\n  }\n} catch (e) {\n  // handle exception\n}\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"// \u76D1\u542C\u6355\u83B7\u9636\u6BB5\u7684\u5F02\u5E38\u4E8B\u4EF6\nwindow.addEventListener(\n  'error',\n  (error) => {\n    handleError(error)\n    error.preventDefault()\n  },\n  true\n)\n\n// Un-catch `Promise` handler\nwindow.addEventListener(\n  'unhandledrejection',\n  (error) => {\n    handleError(error)\n    error.preventDefault()\n  },\n  true\n)\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"const instance = axios.create({\n  baseURL: 'https://api.test.com',\n  timeout: 15000,\n  headers: {\n    'Content-Type': 'application/json',\n  },\n})\n\ninstance.interceptors.response.use(\n  (response) => {\n    return response.data\n  },\n  (error) => {\n    // \u53D1\u751F\u5F02\u5E38\u4F1A\u8D70\u5230\u8FD9\u91CC\n    if (error.response) {\n      const response = error.response\n\n      if (response.status >= 400)\n        handleError(response)\n    } else {\n      handleError(null)\n    }\n\n    return Promise.reject(error)\n  }\n)\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"globalThis.onunhandledrejection = (event) => {\n  console.log(event.type)\n  // \"unhandledrejection\"\n  console.log(event.reason.message)\n  // \"Oops!\"\n  console.log(rejected === event.promise)\n  // true\n}\n\nglobalThis.onrejectionhandled = (event) => {\n  console.log(event.type)\n  // \"rejectionhandled\"\n  console.log(event.reason.message)\n  // \"Oops!\"\n  console.log(rejected === event.promise)\n  // true\n}\n\nconst possiblyUnhandledRejections = new Map()\n\n// when a rejection is unhandled, add it to the map\nglobalThis.onunhandledrejection = (event) => {\n  // prevents the console warning\n  event.preventDefault()\n  possiblyUnhandledRejections.set(event.promise, event.reason)\n}\n\n// when a rejection is handled, remove it from the map\nglobalThis.onrejectionhandled = (event) => {\n  possiblyUnhandledRejections.delete(event.promise)\n}\n\nsetInterval(() => {\n  possiblyUnhandledRejections.forEach((reason, promise) => {\n    console.error('Unhandled rejection')\n    console.error(promise)\n    console.error(reason.message ? reason.message : reason)\n    // do something to handle these rejections\n  })\n  possiblyUnhandledRejections.clear()\n}, 60000)\n\nconst rejected = Promise.reject(new Error('Oops!'))\n\nprocess.on('unhandledRejection', (reason, promise) => {\n  console.log(reason.message)\n  // \"Oops!\"\n  console.log(rejected === promise)\n  // true\n})\n\nconst rejected = Promise.reject(new Error('Oops!'))\n\nsetTimeout(() => {\n  // \"rejectionhandled\" triggered here\n  rejected.catch(\n    reason => console.error(reason.message) // \"Oops!\"\n  )\n}, 500)\n\nprocess.on('rejectionHandled', (promise) => {\n  console.log(rejected === promise) // true\n})\n\nconst possiblyUnhandledRejections = new Map()\n\n// when a rejection is unhandled, add it to the map\nprocess.on('unhandledRejection', (reason, promise) => {\n  possiblyUnhandledRejections.set(promise, reason)\n})\n\nprocess.on('rejectionHandled', (promise) => {\n  possiblyUnhandledRejections.delete(promise)\n})\n\nsetInterval(() => {\n  possiblyUnhandledRejections.forEach((reason, promise) => {\n    console.error('Unhandled rejection')\n    console.error(promise)\n    console.error(reason.message ? reason.message : reason)\n    // do something to handle these rejections\n  })\n  possiblyUnhandledRejections.clear()\n}, 60000)\n"})})]})}function h(e={}){let{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},30416(e,n,r){r.d(n,{R:()=>i,x:()=>a});var s=r(59471);let o={},t=s.createContext(o);function i(e){let n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);