"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([["6801"],{38440(e,n,t){t.r(n),t.d(n,{metadata:()=>o,default:()=>u,frontMatter:()=>a,contentTitle:()=>s,toc:()=>l,assets:()=>d});var o=JSON.parse('{"id":"web/react/hooks/media","title":"Media","description":"Media Query","source":"@site/content/web/react/hooks/media.md","sourceDirName":"web/react/hooks","slug":"/web/react/hooks/media","permalink":"/notes/web/react/hooks/media","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/web/react/hooks/media.md","tags":[{"inline":true,"label":"Web","permalink":"/notes/tags/web"},{"inline":true,"label":"React","permalink":"/notes/tags/react"},{"inline":true,"label":"Hook","permalink":"/notes/tags/hook"},{"inline":true,"label":"Media","permalink":"/notes/tags/media"}],"version":"current","lastUpdatedBy":"renovate[bot]","lastUpdatedAt":1772011424000,"sidebarPosition":23,"frontMatter":{"sidebar_position":23,"tags":["Web","React","Hook","Media"]},"sidebar":"tutorialSidebar","previous":{"title":"Form","permalink":"/notes/web/react/hooks/form"},"next":{"title":"Router","permalink":"/notes/web/react/hooks/router"}}'),r=t(62615),i=t(30416);let a={sidebar_position:23,tags:["Web","React","Hook","Media"]},s="Media",d={},l=[{value:"Media Query",id:"media-query",level:2},{value:"Locked Body",id:"locked-body",level:2},{value:"Mouse",id:"mouse",level:2}];function c(e){let n={code:"code",h1:"h1",h2:"h2",header:"header",pre:"pre",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"media",children:"Media"})}),"\n",(0,r.jsx)(n.h2,{id:"media-query",children:"Media Query"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"export default function useMedia<T>(\n  queries: string[],\n  values: T[],\n  defaultValue: T\n) {\n  // Array containing a media query list for each query\n  const mediaQueryLists = queries.map(q => window.matchMedia(q))\n\n  const getValue = () => {\n    // Get index of first media query that matches\n    const index = mediaQueryLists.findIndex(mql => mql.matches)\n    return values?.[index] || defaultValue\n  }\n\n  // State and setter for matched value\n  const [value, setValue] = useState<T>(getValue)\n\n  useMount(() => {\n    const handler = () => setValue(getValue)\n    mediaQueryLists.forEach(mql => mql.addListener(handler))\n    return () => mediaQueryLists.forEach(mql => mql.removeListener(handler))\n  })\n\n  return value\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"locked-body",children:"Locked Body"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"import { useEffect, useLayoutEffect, useState } from 'react'\n\ntype ReturnType = [boolean, (locked: boolean) => void]\n\nfunction useLockedBody(initialLocked = false): ReturnType {\n  const [locked, setLocked] = useState(initialLocked)\n\n  // Do the side effect before render\n  useLayoutEffect(() => {\n    // Key point 1\n    if (!locked)\n      return\n\n    // Save initial body style\n    const originalOverflow = document.body.style.overflow\n    const originalPaddingRight = document.body.style.paddingRight\n\n    // Lock body scroll\n    document.body.style.overflow = 'hidden'\n\n    // Get the scrollBar width\n    const root = document.getElementById('___gatsby') // or root\n    const scrollBarWidth = root ? root.offsetWidth - root.scrollWidth : 0\n\n    // Avoid width reflow\n    if (scrollBarWidth)\n      document.body.style.paddingRight = `${scrollBarWidth}px`\n\n    // Key point 2\n    return () => {\n      document.body.style.overflow = originalOverflow\n\n      if (scrollBarWidth)\n        document.body.style.paddingRight = originalPaddingRight\n    }\n  }, [locked])\n\n  // Update state if initialValue changes\n  useEffect(() => {\n    if (locked !== initialLocked) {\n      setLocked(initialLocked)\n    }\n  }, [initialLocked])\n\n  return [locked, setLocked]\n}\n\nexport default useLockedBody\n"})}),"\n",(0,r.jsx)(n.h2,{id:"mouse",children:"Mouse"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"import { useRef, useState } from 'react'\n\nexport default function useLongPress(time = 500) {\n  const [action, setAction] = useState()\n\n  const timerRef = useRef()\n  const isLongPressRef = useRef()\n\n  function startPressTimer() {\n    isLongPressRef.current = false\n    timerRef.current = setTimeout(() => {\n      isLongPressRef.current = true\n      setAction('LongPress')\n    }, time)\n  }\n\n  function handleClick() {\n    if (isLongPressRef.current)\n      return\n\n    setAction('Click')\n  }\n\n  function handleMouseDown() {\n    startPressTimer()\n  }\n\n  function handleMouseUp() {\n    clearTimeout(timerRef.current)\n  }\n\n  function handleTouchStart() {\n    startPressTimer()\n  }\n\n  function handleTouchEnd() {\n    if (action === 'LongPress')\n      return\n\n    clearTimeout(timerRef.current)\n  }\n\n  return {\n    action,\n    handlers: {\n      onClick: handleClick,\n      onMouseDown: handleMouseDown,\n      onMouseUp: handleMouseUp,\n      onTouchStart: handleTouchStart,\n      onTouchEnd: handleTouchEnd,\n    },\n  }\n}\n"})})]})}function u(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},30416(e,n,t){t.d(n,{R:()=>a,x:()=>s});var o=t(59471);let r={},i=o.createContext(r);function a(e){let n=o.useContext(i);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),o.createElement(i.Provider,{value:n},e.children)}}}]);