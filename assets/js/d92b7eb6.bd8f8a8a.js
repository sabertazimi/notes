"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([["9679"],{90170(e,n,i){i.r(n),i.d(n,{metadata:()=>t,default:()=>h,frontMatter:()=>s,contentTitle:()=>c,toc:()=>o,assets:()=>a});var t=JSON.parse('{"id":"web/javascript/webrtc","title":"WebRTC","description":"Communication","source":"@site/content/web/javascript/webrtc.md","sourceDirName":"web/javascript","slug":"/web/javascript/webrtc","permalink":"/notes/web/javascript/webrtc","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/web/javascript/webrtc.md","tags":[{"inline":true,"label":"Web","permalink":"/notes/tags/web"},{"inline":true,"label":"JavaScript","permalink":"/notes/tags/java-script"},{"inline":true,"label":"ECMAScript","permalink":"/notes/tags/ecma-script"},{"inline":true,"label":"Network","permalink":"/notes/tags/network"},{"inline":true,"label":"WebRTC","permalink":"/notes/tags/web-rtc"}],"version":"current","lastUpdatedBy":"Sabertaz","lastUpdatedAt":1769518084000,"sidebarPosition":52,"frontMatter":{"sidebar_position":52,"tags":["Web","JavaScript","ECMAScript","Network","WebRTC"]},"sidebar":"tutorialSidebar","previous":{"title":"WebSocket","permalink":"/notes/web/javascript/websocket"},"next":{"title":"Animations","permalink":"/notes/web/javascript/animation"}}'),r=i(62615),l=i(30416);let s={sidebar_position:52,tags:["Web","JavaScript","ECMAScript","Network","WebRTC"]},c="WebRTC",a={},o=[{value:"Communication",id:"communication",level:2},{value:"Protocol",id:"protocol",level:2},{value:"Performance",id:"performance",level:2},{value:"References",id:"references",level:2}];function d(e){let n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"webrtc",children:"WebRTC"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const ice = {\n  iceServers: [\n    { url: 'stun:stun.l.google.com:19302' },\n    { url: 'turn:user@turnserver.com', credential: 'pass' },\n  ],\n}\nconst signalingChannel = new SignalingChannel()\nconst pc = new RTCPeerConnection(ice)\n\nnavigator.getUserMedia({ audio: true }, getStream, logError)\n\nfunction getStream(evt) {\n  pc.addstream(evt.stream)\n\n  const localVideo = document.querySelector('#local-video')\n  localVideo.src = window.URL.createObjectURL(evt.stream)\n\n  pc.createOffer((offer) => {\n    pc.setLocalDescription(offer)\n    signalingChannel.send(offer.sdp)\n  })\n}\n\npc.onicecandidate = function (evt) {\n  if (evt.candidate)\n    signalingChannel.send(evt.candidate)\n}\n\npc.oniceconnectionstatechange = function (evt) {\n  logStatus(`ICE connection state change: ${evt.target.iceConnectionState}`)\n}\n\npc.onaddstream = function (evt) {\n  const remoteVideo = document.querySelector('#remote-video')\n  remoteVideo.src = window.URL.createObjectURL(evt.stream)\n}\n\nsignalingChannel.onmessage = function (msg) {\n  if (msg.candidate)\n    pc.addIceCandidate(msg.candidate)\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"communication",children:"Communication"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://developer.mozilla.org/docs/Web/API/WebRTC_API",children:"Web Real-Time Communication"}),"\n(Web \u5B9E\u65F6\u901A\u4FE1, WebRTC) \u7531\u4E00\u7EC4\u6807\u51C6, \u534F\u8BAE\u548C JavaScript API \u7EC4\u6210,\n\u7528\u4E8E\u5B9E\u73B0\u6D4F\u89C8\u5668\u4E4B\u95F4 (\u7AEF\u5230\u7AEF, P2P) \u7684\u97F3\u9891/\u89C6\u9891/\u6570\u636E\u5171\u4EAB:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://developer.mozilla.org/docs/Web/API/MediaStream",children:"MediaStream"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://developer.mozilla.org/docs/Web/API/RTCPeerConnection",children:"RTCPeerConnection"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u7BA1\u7406\u7A7F\u900F NAT \u7684\u5B8C\u6574 ICE \u5DE5\u4F5C\u6D41."}),"\n",(0,r.jsx)(n.li,{children:"\u53D1\u9001\u81EA\u52A8 (STUN) \u6301\u4E45\u5316\u4FE1\u53F7."}),"\n",(0,r.jsx)(n.li,{children:"\u8DDF\u8E2A\u672C\u5730\u6D41."}),"\n",(0,r.jsx)(n.li,{children:"\u8DDF\u8E2A\u8FDC\u7A0B\u6D41."}),"\n",(0,r.jsx)(n.li,{children:"\u6309\u9700\u89E6\u53D1\u81EA\u52A8\u6D41\u534F\u5546."}),"\n",(0,r.jsx)(n.li,{children:"\u751F\u6210\u8FDE\u63A5\u63D0\u8BAE, \u63A5\u6536\u5E94\u7B54, \u5141\u8BB8\u67E5\u8BE2\u8FDE\u63A5\u7684\u5F53\u524D\u72B6\u6001\u7B49."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://developer.mozilla.org/docs/Web/API/RTCDataChannel",children:"RTCDataChannel"}),":\nDataChannel API \u7528\u4E8E\u5B9E\u73B0\u7AEF\u5230\u7AEF\u4E4B\u95F4\u7684\u4EFB\u610F\u5E94\u7528\u6570\u636E\u4EA4\u6362 (\u7AEF\u5230\u7AEF\u4EA4\u6362\u7248\u672C\u7684 WebSocket)."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"WebRTC Engine",src:i(93450).A+"",title:"WebRTC Engine",width:"1265",height:"933"})}),"\n",(0,r.jsx)(n.h2,{id:"protocol",children:"Protocol"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"WebRTC Layer Protocol",src:i(23544).A+"",title:"WebRTC Layer Protocol",width:"1837",height:"894"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"WebRTC \u4F7F\u7528 UDP \u4F5C\u4E3A\u4F20\u8F93\u5C42\u534F\u8BAE: \u4F4E\u5EF6\u8FDF\u548C\u53CA\u65F6\u6027\u624D\u662F\u5173\u952E."}),"\n",(0,r.jsxs)(n.li,{children:["ICE: Interactive Connectivity Establishment (RFC 5245).","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"STUN: Session Traversal Utilities for NAT (RFC 5389)."}),"\n",(0,r.jsx)(n.li,{children:"TURN: Traversal Using Relays around NAT (RFC 5766)."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"SDP: Session Description Protocol (RFC 4566)."}),"\n",(0,r.jsx)(n.li,{children:"DTLS: Datagram Transport Layer Security (RFC 6347)."}),"\n",(0,r.jsx)(n.li,{children:"SCTP: Stream Control Transport Protocol (RFC 4960)."}),"\n",(0,r.jsx)(n.li,{children:"SRTP: Secure Real-Time Transport Protocol (RFC 3711)."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"performance",children:"Performance"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u53D1\u4FE1\u670D\u52A1:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u4F7F\u7528\u4F4E\u5EF6\u8FDF\u4F20\u8F93\u673A\u5236."}),"\n",(0,r.jsx)(n.li,{children:"\u63D0\u4F9B\u8DB3\u591F\u7684\u5BB9\u91CF."}),"\n",(0,r.jsx)(n.li,{children:"\u5EFA\u7ACB\u8FDE\u63A5\u540E, \u8003\u8651\u4F7F\u7528 DataChannel \u53D1\u4FE1."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\u9632\u706B\u5899\u548C NAT \u7A7F\u900F:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u521D\u59CB\u5316 RTCPeerConnection \u65F6\u63D0\u4F9B STUN \u670D\u52A1\u5668."}),"\n",(0,r.jsx)(n.li,{children:"\u5C3D\u53EF\u80FD\u4F7F\u7528\u589E\u91CF ICE, \u867D\u7136\u53D1\u4FE1\u6B21\u6570\u591A, \u4F46\u5EFA\u7ACB\u8FDE\u63A5\u901F\u5EA6\u5FEB."}),"\n",(0,r.jsx)(n.li,{children:"\u63D0\u4F9B STUN \u670D\u52A1\u5668, \u4EE5\u5907\u7AEF\u5230\u7AEF\u8FDE\u63A5\u5931\u8D25\u540E\u8F6C\u53D1\u6570\u636E."}),"\n",(0,r.jsx)(n.li,{children:"\u9884\u8BA1\u5E76\u4FDD\u8BC1 TURN \u8F6C\u53D1\u65F6\u5BB9\u91CF\u8DB3\u591F\u7528."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\u6570\u636E\u5206\u53D1:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u5BF9\u4E8E\u5927\u578B\u591A\u65B9\u901A\u4FE1, \u8003\u8651\u4F7F\u7528\u8D85\u7EA7\u8282\u70B9\u6216\u4E13\u7528\u7684\u4E2D\u95F4\u8BBE\u5907."}),"\n",(0,r.jsx)(n.li,{children:"\u4E2D\u95F4\u8BBE\u5907\u5728\u8F6C\u53D1\u6570\u636E\u524D, \u8003\u8651\u5148\u5BF9\u5176\u8FDB\u884C\u4F18\u5316\u6216\u538B\u7F29."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\u6570\u636E\u6548\u7387:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u5BF9\u97F3\u9891\u548C\u89C6\u9891\u6D41\u6307\u5B9A\u9002\u5F53\u7684\u5A92\u4F53\u7EA6\u675F."}),"\n",(0,r.jsx)(n.li,{children:"\u4F18\u5316\u901A\u8FC7 DataChannel \u53D1\u9001\u7684\u4E8C\u8FDB\u5236\u51C0\u8377."}),"\n",(0,r.jsx)(n.li,{children:"\u8003\u8651\u538B\u7F29\u901A\u8FC7 DataChannel \u53D1\u9001\u7684 UTF-8 \u6570\u636E."}),"\n",(0,r.jsx)(n.li,{children:"\u76D1\u63A7 DataChannel \u7F13\u51B2\u6570\u636E\u7684\u91CF, \u540C\u65F6\u6CE8\u610F\u9002\u5E94\u7F51\u7EDC\u6761\u4EF6\u53D8\u5316."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\u4EA4\u4ED8\u53CA\u53EF\u9760\u6027:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u4F7F\u7528\u4E71\u5E8F\u4EA4\u4ED8\u907F\u514D\u961F\u9996\u963B\u585E."}),"\n",(0,r.jsx)(n.li,{children:"\u5982\u679C\u4F7F\u7528\u6709\u5E8F\u4EA4\u4ED8, \u628A\u6D88\u606F\u5927\u5C0F\u63A7\u5236\u5230\u6700\u5C0F, \u4EE5\u964D\u4F4E\u961F\u9996\u963B\u585E\u7684\u5F71\u54CD."}),"\n",(0,r.jsx)(n.li,{children:"\u53D1\u9001\u5C0F\u6D88\u606F (\u5C0F\u4E8E 1150 \u5B57\u8282), \u4EE5\u4FBF\u5C06\u5206\u6BB5\u5E94\u7528\u6D88\u606F\u9020\u6210\u7684\u4E22\u5305\u635F\u5931\u964D\u81F3\u6700\u4F4E."}),"\n",(0,r.jsxs)(n.li,{children:["\u5BF9\u90E8\u5206\u53EF\u9760\u4EA4\u4ED8:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u8BBE\u7F6E\u9002\u5F53\u7684\u91CD\u4F20\u6B21\u6570\u548C\u8D85\u65F6\u95F4\u9694."}),"\n",(0,r.jsx)(n.li,{children:"\u6B63\u786E\u7684\u8BBE\u7F6E\u53D6\u51B3\u4E8E\u6D88\u606F\u5927\u5C0F, \u5E94\u7528\u6570\u636E\u7C7B\u578B, \u7AEF\u4E0E\u7AEF\u4E4B\u95F4\u7684\u5EF6\u8FDF."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://hpbn.co/webrtc",children:"WebRTC Guide"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://dzone.com/articles/webrtc-security-vulnerabilities-you-should-know-ab",children:"WebRTC Security List"})}),"\n"]})]})}function h(e={}){let{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},93450(e,n,i){i.d(n,{A:()=>t});let t=i.p+"assets/images/web-rtc-engine-3efa376d25cb54089770b343f38d02dc.png"},23544(e,n,i){i.d(n,{A:()=>t});let t=i.p+"assets/images/web-rtc-layer-protocol-218599046ac438940de64e1bcafe902f.png"},30416(e,n,i){i.d(n,{R:()=>s,x:()=>c});var t=i(59471);let r={},l=t.createContext(r);function s(e){let n=t.useContext(l);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),t.createElement(l.Provider,{value:n},e.children)}}}]);