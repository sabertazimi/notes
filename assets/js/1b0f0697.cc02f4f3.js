"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([["43171"],{7024(e,n,i){i.r(n),i.d(n,{metadata:()=>r,default:()=>h,frontMatter:()=>t,contentTitle:()=>o,toc:()=>a,assets:()=>c});var r=JSON.parse('{"id":"web/javascript/engine","title":"Engine","description":"Variables Lifecycle","source":"@site/content/web/javascript/engine.md","sourceDirName":"web/javascript","slug":"/web/javascript/engine","permalink":"/notes/web/javascript/engine","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/web/javascript/engine.md","tags":[{"inline":true,"label":"Web","permalink":"/notes/tags/web"},{"inline":true,"label":"JavaScript","permalink":"/notes/tags/java-script"},{"inline":true,"label":"ECMAScript","permalink":"/notes/tags/ecma-script"},{"inline":true,"label":"Engine","permalink":"/notes/tags/engine"}],"version":"current","lastUpdatedBy":"Sabertaz","lastUpdatedAt":1769518084000,"sidebarPosition":30,"frontMatter":{"sidebar_position":30,"tags":["Web","JavaScript","ECMAScript","Engine"]},"sidebar":"tutorialSidebar","previous":{"title":"Style Guide","permalink":"/notes/web/javascript/style-guide"},"next":{"title":"BOM","permalink":"/notes/web/javascript/bom"}}'),s=i(62615),l=i(30416);let t={sidebar_position:30,tags:["Web","JavaScript","ECMAScript","Engine"]},o="Engine",c={},a=[{value:"Variables Lifecycle",id:"variables-lifecycle",level:2},{value:"Execution Context",id:"execution-context",level:2},{value:"Global",id:"global",level:3},{value:"Function",id:"function",level:3},{value:"Event Loop",id:"event-loop",level:2},{value:"Browser",id:"browser",level:3},{value:"Node.js",id:"nodejs",level:3},{value:"V8",id:"v8",level:2},{value:"Object Shape",id:"object-shape",level:3},{value:"Inline Cache",id:"inline-cache",level:3},{value:"Object Structure",id:"object-structure",level:3},{value:"Garbage Collection",id:"garbage-collection",level:3},{value:"Scavenge",id:"scavenge",level:3},{value:"Mark-Sweep-Compact",id:"mark-sweep-compact",level:3},{value:"Stop-The-World",id:"stop-the-world",level:3},{value:"Performance",id:"performance",level:3},{value:"Browser Engine",id:"browser-engine",level:2},{value:"RenderingNG",id:"renderingng",level:2},{value:"Architecture",id:"architecture",level:3},{value:"Pipeline",id:"pipeline",level:3},{value:"Render Process",id:"render-process",level:3},{value:"HTML Parser",id:"html-parser",level:3},{value:"CSS Parser",id:"css-parser",level:3},{value:"Layout Engine",id:"layout-engine",level:3},{value:"Paint Engine",id:"paint-engine",level:3},{value:"Video Engine",id:"video-engine",level:3},{value:"Scrolling Performance",id:"scrolling-performance",level:3},{value:"Animation Performance",id:"animation-performance",level:3},{value:"References",id:"references",level:2}];function d(e){let n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"engine",children:"Engine"})}),"\n",(0,s.jsx)(n.h2,{id:"variables-lifecycle",children:"Variables Lifecycle"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Creation phase (",(0,s.jsx)(n.strong,{children:"Hoisting"}),")","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Declaration phase: \u5728\u4F5C\u7528\u57DF\u4E2D\u6CE8\u518C\u53D8\u91CF"}),"\n",(0,s.jsxs)(n.li,{children:["Initialization phase: \u5206\u914D\u5185\u5B58, \u5728\u4F5C\u7528\u57DF\u4E2D\u7ED1\u5B9A\u53D8\u91CF (",(0,s.jsx)(n.code,{children:"undefined"}),")"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"Execution phase/Assignment phase"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"execution-context",children:"Execution Context"}),"\n",(0,s.jsx)(n.h3,{id:"global",children:"Global"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Create global object (",(0,s.jsx)(n.code,{children:"window"}),")."]}),"\n",(0,s.jsxs)(n.li,{children:["Create ",(0,s.jsx)(n.code,{children:"this"})," object (refer to ",(0,s.jsx)(n.code,{children:"window"}),")."]}),"\n",(0,s.jsxs)(n.li,{children:["Declare and initialize variable/function (",(0,s.jsx)(n.code,{children:"undefined"}),"),\nsetup memory space for them."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"function",children:"Function"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Create arguments object."}),"\n",(0,s.jsxs)(n.li,{children:["Create ",(0,s.jsx)(n.code,{children:"this"})," object."]}),"\n",(0,s.jsxs)(n.li,{children:["Declare and initialize variable(",(0,s.jsx)(n.code,{children:"undefined"}),")/function, store them into memory."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\u5982\u679C JavaScript \u5F15\u64CE\u5728\u51FD\u6570\u6267\u884C\u4E0A\u4E0B\u6587\u4E2D\u627E\u4E0D\u5230\u53D8\u91CF,\n\u5B83\u4F1A\u5728\u6700\u8FD1\u7684\u7236\u7EA7\u6267\u884C\u4E0A\u4E0B\u6587\u4E2D\u67E5\u627E\u8BE5\u53D8\u91CF.\n\u8FD9\u4E2A\u67E5\u627E\u94FE\u5C06\u4F1A\u4E00\u76F4\u6301\u7EED, \u76F4\u5230\u5F15\u64CE\u67E5\u627E\u5230\u5168\u5C40\u6267\u884C\u4E0A\u4E0B\u6587.\n\u8FD9\u79CD\u60C5\u51B5\u4E0B, \u5982\u679C\u5168\u5C40\u6267\u884C\u4E0A\u4E0B\u6587\u4E5F\u6CA1\u6709\u8BE5\u53D8\u91CF, \u90A3\u4E48\u5C06\u4F1A\u629B\u51FA\u5F15\u7528\u9519\u8BEF (Reference Error).\n\u5B50\u51FD\u6570",(0,s.jsx)(n.strong,{children:"\u5305\u542B"}),"\u5B83\u7236\u7EA7\u51FD\u6570\u7684\u53D8\u91CF\u73AF\u5883, \u628A\u8FD9\u4E2A\u6982\u5FF5\u79F0\u4E3A",(0,s.jsx)(n.strong,{children:"\u95ED\u5305(Closure)"}),",\n\u5373\u4F7F\u7236\u7EA7\u51FD\u6570\u6267\u884C\u73AF\u5883\u5DF2\u7ECF\u4ECE\u6267\u884C\u6808\u5F39\u51FA\u4E86, \u5B50\u51FD\u6570\u8FD8\u662F\u53EF\u4EE5\u8BBF\u95EE\u7236\u7EA7\u51FD\u6570\u53D8\u91CF x (\u901A\u8FC7\u4F5C\u7528\u57DF\u94FE)."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Scope Chain",src:i(29728).A+"",title:"Scope Chain",width:"1383",height:"865"})}),"\n",(0,s.jsx)(n.h2,{id:"event-loop",children:"Event Loop"}),"\n",(0,s.jsx)(n.h3,{id:"browser",children:"Browser"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Event Loop",src:i(44106).A+"",title:"Event Loop",width:"392",height:"740"})}),"\n",(0,s.jsxs)(n.p,{children:["The job of the ",(0,s.jsx)(n.strong,{children:"event loop"})," is to look into the call stack\nand determine if the call stack is empty or not.\nIf the ",(0,s.jsx)(n.strong,{children:"call stack"})," is empty,\nit looks into the ",(0,s.jsx)(n.strong,{children:"ES6 job queue"})," and ",(0,s.jsx)(n.strong,{children:"message queue"})," to see\nif there\u2019s any pending call back waiting to be executed:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["ES6 job queue: used by ",(0,s.jsx)(n.code,{children:"Promises"})," (higher priority)."]}),"\n",(0,s.jsxs)(n.li,{children:["Message queue: used by ",(0,s.jsx)(n.code,{children:"setTimeout"}),", ",(0,s.jsx)(n.code,{children:"DOM events"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["\u5FAE\u4EFB\u52A1 MicroTask (Jobs), \u6709\u7279\u6743, \u53EF\u4EE5\u63D2\u961F:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"process.nextTick"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Promises.then"})," (",(0,s.jsx)(n.strong,{children:"Promise \u6784\u9020\u51FD\u6570\u662F\u540C\u6B65\u51FD\u6570"}),")."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Object.observer"}),", ",(0,s.jsx)(n.code,{children:"MutationObserver"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"catch finally"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\u5B8F\u4EFB\u52A1 MacroTask (Tasks), \u6CA1\u6709\u7279\u6743:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"scripts"}),": \u6574\u4F53\u811A\u672C\u89C6\u4F5C\u4E00\u4E2A\u5B8F\u4EFB\u52A1."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"MessageChannel"}),", ",(0,s.jsx)(n.code,{children:"postMessage"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"setImmediate"}),", ",(0,s.jsx)(n.code,{children:"I/O"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"setTimeout"}),", ",(0,s.jsx)(n.code,{children:"setInterval"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"XHR"})," callback function."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"requestAnimationFrame"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["UI interaction ",(0,s.jsx)(n.code,{children:"events"})," callback function."]}),"\n",(0,s.jsx)(n.li,{children:"UI rendering."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"MicroTask \u4F18\u5148\u4E8E MacroTask."}),"\n",(0,s.jsx)(n.li,{children:"\u6D4F\u89C8\u5668\u4E3A\u4E86\u80FD\u591F\u4F7F\u5F97 JS \u5185\u90E8 (macro)task \u4E0E DOM \u4EFB\u52A1\u80FD\u591F\u6709\u5E8F\u7684\u6267\u884C,\n\u4F1A\u5728\u4E00\u4E2A (macro)task \u6267\u884C\u7ED3\u675F\u540E, \u5728\u4E0B\u4E00\u4E2A (macro)task \u6267\u884C\u5F00\u59CB\u524D, \u5BF9\u9875\u9762\u8FDB\u884C\u91CD\u65B0\u6E32\u67D3.\n\u5F53 JS \u5F15\u64CE\u4ECE\u4EFB\u52A1\u961F\u5217\u4E2D\u53D6\u51FA\u4E00\u4E2A\u5B8F\u4EFB\u52A1\u6765\u6267\u884C, \u5982\u679C\u6267\u884C\u8FC7\u7A0B\u4E2D\u6709\u9047\u5230\u5FAE\u4EFB\u52A1,\n\u90A3\u4E48\u6267\u884C\u5B8C\u8BE5\u5B8F\u4EFB\u52A1\u5C31\u4F1A\u53BB\u6267\u884C\u5B8F\u4EFB\u52A1\u5185\u7684\u6240\u6709\u5FAE\u4EFB\u52A1, \u7136\u540E\u66F4\u65B0 UI.\n\u540E\u9762\u5C31\u662F\u518D\u4ECE\u4EFB\u52A1\u961F\u5217\u4E2D\u53D6\u51FA\u4E0B\u4E00\u4E2A\u5B8F\u4EFB\u52A1\u6765\u7EE7\u7EED\u6267\u884C, \u4EE5\u6B64\u7C7B\u63A8."}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Event Loop"})," \u4E0E ",(0,s.jsx)(n.code,{children:"Call Stack"})," \u6709\u4E14\u4EC5\u6709\u4E00\u4E2A, ",(0,s.jsx)(n.code,{children:"Task/Job/Message Queue"})," \u53EF\u4EE5\u6709\u591A\u4E2A."]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{title:"Event Loop",type:"tip",children:(0,s.jsx)(n.p,{children:"\u5B8F\u4EFB\u52A1\u961F\u5217\u53D6\u5B8F\u4EFB\u52A1 -> \u6267\u884C 1 \u4E2A\u5B8F\u4EFB\u52A1 -> \u68C0\u67E5\u5FAE\u4EFB\u52A1\u961F\u5217\u5E76\u6267\u884C\u6240\u6709\u5FAE\u4EFB\u52A1\n-> requestAnimationFrame -> \u6D4F\u89C8\u5668\u91CD\u6392/\u91CD\u7ED8 -> requestIdleCallback\n-> \u5B8F\u4EFB\u52A1\u961F\u5217\u53D6\u5B8F\u4EFB\u52A1"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"Event Loop"})," simple model:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"for (const macroTask of macroTaskQueue) {\n  // 1. Handle current MacroTask.\n  runTask(macroTask)\n\n  // 2. Handle all MicroTasks.\n  for (const microTask of microTaskQueue)\n    runTask(microTask)\n\n  // 3. Handle Animation Frame.\n  if (shouldRepaint()) {\n    if (!animationFrameCallbackQueue.isEmpty()) {\n      const animationTasks = animationFrameCallbackQueue.copyTasks()\n\n      for (const animationTask of animationTasks)\n        runTask(animationTask)\n    }\n\n    repaint()\n  }\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Using ",(0,s.jsx)(n.code,{children:"setTimeout"})," with ",(0,s.jsx)(n.code,{children:"0"})," seconds timer\nhelps to defer execution of ",(0,s.jsx)(n.code,{children:"Promise"})," and ",(0,s.jsx)(n.code,{children:"bar"})," until the ",(0,s.jsx)(n.strong,{children:"stack"})," is ",(0,s.jsx)(n.strong,{children:"empty"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"function bar() {\n  console.log('bar')\n}\n\nfunction baz() {\n  console.log('baz')\n}\n\nfunction foo() {\n  console.log('foo')\n  setTimeout(bar, 0)\n  new Promise((resolve, reject) => {\n    resolve('Promise resolved')\n  })\n    .then(res => console.log(res))\n    .catch(err => console.log(err))\n  baz()\n}\n\nfoo()\n\n// foo\n// baz\n// Promised resolved\n// bar\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"process.nextTick()"})," run before ",(0,s.jsx)(n.code,{children:"Promise.then()"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"console.log('1')\n\nsetTimeout(() => {\n  console.log(2)\n  Promise.resolve().then(() => {\n    console.log(3)\n    process.nextTick(() => {\n      console.log(4)\n    })\n  })\n})\n\nPromise.resolve().then(() => {\n  console.log(5)\n  setTimeout(() => {\n    console.log(6)\n  })\n  Promise.resolve().then(() => {\n    console.log(7)\n  })\n})\n\nprocess.nextTick(() => {\n  console.log(8)\n  process.nextTick(() => {\n    console.log(9)\n  })\n})\n\nconsole.log('10')\n// 1 10 8 9 5 7 2 3 4 6\n"})}),"\n",(0,s.jsx)(n.p,{children:"Promise \u6784\u9020\u51FD\u6570\u672C\u8EAB\u662F\u540C\u6B65\u51FD\u6570:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"console.log('script start')\n\nconst promise1 = new Promise((resolve) => {\n  console.log('promise1')\n  resolve()\n  console.log('promise1 end')\n}).then(() => {\n  console.log('promise2')\n})\n\nsetTimeout(() => {\n  console.log('setTimeout')\n})\n\nconsole.log('script end')\n\n// \u8F93\u51FA\u987A\u5E8F:\n// script start\n// promise1\n// promise1 end\n// script end\n// promise2\n// setTimeout.\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"await a(); b()"})," \u7B49\u4EF7\u4E8E ",(0,s.jsx)(n.code,{children:"Promise(a()).then(b())"}),",\n",(0,s.jsx)(n.code,{children:"a"})," \u662F\u540C\u6B65\u6267\u884C, ",(0,s.jsx)(n.code,{children:"b"})," \u662F MicroTask:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"async function async1() {\n  console.log('async1 start')\n  await async2()\n  console.log('async1 end')\n}\n\nasync function async2() {\n  console.log('async2')\n}\n\nconsole.log('script start')\n\nsetTimeout(() => {\n  console.log('setTimeout')\n}, 0)\n\nasync1()\n\nnew Promise((resolve) => {\n  console.log('promise1')\n  resolve()\n}).then(() => {\n  console.log('promise2')\n})\n\nconsole.log('script end')\n\n// script start\n// async1 start\n// async2\n// promise1\n// script end\n// async1 end\n// promise2\n// setTimeout\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5F53\u8C03\u7528\u6808\u6CA1\u6709\u540C\u6B65\u51FD\u6570\u65F6, \u6E05\u7A7A MicroTask \u4EFB\u52A1\u961F\u5217\u91CC\u7684\u51FD\u6570,\n\u518D\u4ECE MacroTask \u4EFB\u52A1\u961F\u5217\u91CC\u53D6\u51FA\u4E00\u4E2A\u51FD\u6570\u6267\u884C (\u7B2C\u4E8C\u6B21 Event Loop):"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"function test() {\n  console.log('start')\n\n  setTimeout(() => {\n    console.log('children2')\n    Promise.resolve().then(() => {\n      console.log('children2-1')\n    })\n  }, 0)\n\n  setTimeout(() => {\n    console.log('children3')\n    Promise.resolve().then(() => {\n      console.log('children3-1')\n    })\n  }, 0)\n\n  Promise.resolve().then(() => {\n    console.log('children1')\n  })\n\n  console.log('end')\n}\n\ntest()\n\n// start\n// end\n// children1\n// children2\n// children2-1\n// children3\n// children3-1\n"})}),"\n",(0,s.jsx)(n.h3,{id:"nodejs",children:"Node.js"}),"\n",(0,s.jsx)(n.p,{children:"Node.js can run I/O operations in a non-blocking way,\nmeaning other code (and even other I/O operations) can be executed\nwhile an I/O operation is in progress."}),"\n",(0,s.jsxs)(n.p,{children:["Instead of having to ",(0,s.jsx)(n.strong,{children:"wait"})," for an I/O operation to complete\n(and essentially waste CPU cycles sitting idle),\nNode.js can use the time to execute other tasks."]}),"\n",(0,s.jsxs)(n.p,{children:["When the I/O operation completes,\n",(0,s.jsx)(n.strong,{children:"event loop"})," give back control to the piece of code\nthat is waiting for the result of that I/O operation."]}),"\n",(0,s.jsxs)(n.p,{children:["The Node.js execution model was designed to cater to the needs of most web servers,\nwhich tend to be ",(0,s.jsx)(n.strong,{children:"I/O-intensive"})," (due to non-blocking I/O)."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"console.log('glob1')\n\nsetTimeout(() => {\n  console.log('timeout1')\n  process.nextTick(() => {\n    console.log('timeout1_nextTick')\n  })\n  new Promise((resolve) => {\n    console.log('timeout1_promise')\n    resolve()\n  }).then(() => {\n    console.log('timeout1_then')\n  })\n})\n\nsetImmediate(() => {\n  console.log('immediate1')\n  process.nextTick(() => {\n    console.log('immediate1_nextTick')\n  })\n  new Promise((resolve) => {\n    console.log('immediate1_promise')\n    resolve()\n  }).then(() => {\n    console.log('immediate1_then')\n  })\n})\n\nprocess.nextTick(() => {\n  console.log('glob1_nextTick')\n})\nnew Promise((resolve) => {\n  console.log('glob1_promise')\n  resolve()\n}).then(() => {\n  console.log('glob1_then')\n})\n\nsetTimeout(() => {\n  console.log('timeout2')\n  process.nextTick(() => {\n    console.log('timeout2_nextTick')\n  })\n  new Promise((resolve) => {\n    console.log('timeout2_promise')\n    resolve()\n  }).then(() => {\n    console.log('timeout2_then')\n  })\n})\n\nprocess.nextTick(() => {\n  console.log('glob2_nextTick')\n})\nnew Promise((resolve) => {\n  console.log('glob2_promise')\n  resolve()\n}).then(() => {\n  console.log('glob2_then')\n})\n\nsetImmediate(() => {\n  console.log('immediate2')\n  process.nextTick(() => {\n    console.log('immediate2_nextTick')\n  })\n  new Promise((resolve) => {\n    console.log('immediate2_promise')\n    resolve()\n  }).then(() => {\n    console.log('immediate2_then')\n  })\n})\n\nconsole.log('glob2')\n\n// glob1\n// glob1_promise\n// glob2_promise\n// glob2\n// glob1_nextTick\n// glob2_nextTick\n// glob1_then\n// glob2_then\n// timeout1\n// timeout1_promise\n// timeout1_nextTick\n// timeout1_then\n// timeout2\n// timeout2_promise\n// timeout2_nextTick\n// timeout2_then\n// immediate1\n// immediate1_promise\n// immediate1_nextTick\n// immediate1_then\n// immediate2\n// immediate2_promise\n// immediate2_nextTick\n// immediate2_then\n"})}),"\n",(0,s.jsx)(n.h2,{id:"v8",children:"V8"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"source code (parser) AST (interpreter) bytecode"}),"\n",(0,s.jsx)(n.li,{children:"send profiling data from bytecode to optimizing compiler, generate optimized code"}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Ignition"})," interpreter"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"TurboFan"})," optimizing compiler (2 for SpiderMonkey/Edge, 3 for Safari)"]}),"\n",(0,s.jsxs)(n.li,{children:["JavaScript implementation ",(0,s.jsx)(n.a,{href:"https://notes.eatonphil.com/javascript-implementations.html",children:"list"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"object-shape",children:"Object Shape"}),"\n",(0,s.jsxs)(n.p,{children:["V8 object ",(0,s.jsx)(n.a,{href:"https://mathiasbynens.be/notes/shapes-ics",children:"shapes"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// o1 and o2 have the same shape\n// JSObject(1, 2) => Shape('x', 'y')\n// JSObject(3, 4) => Shape('x', 'y')\n// 'x' => 0 Offset, Writable, Enumerable, Configurable\n// 'y' => 1 Offset, Writable, Enumerable, Configurable\nconst o1 = { x: 1, y: 2 }\nconst o2 = { x: 3, y: 4 }\n"})}),"\n",(0,s.jsx)(n.p,{children:"Shape transform:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// Shape chain: Shape(empty) => Shape(x) => Shape(x, y)\nconst o = {}\no.x = 1\no.y = 2\n\n// Shape chain: Shape(empty) => Shape(y) => Shape(y, x)\nconst o = {}\no.y = 2\no.x = 1\n\n// Shape chain: Shape(x)\nconst o = { x: 1 }\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Array shape: ",(0,s.jsx)(n.code,{children:"Shape('length'), 'length' => 0 Offset, Writable"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"inline-cache",children:"Inline Cache"}),"\n",(0,s.jsxs)(n.p,{children:["V8 use ",(0,s.jsx)(n.a,{href:"https://blog.frontend-almanac.com/js-optimisation-ic",children:"ICs"}),"\nto memorize information (same shape) where to find properties on objects:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"always initialize objects in the same way (generate the same shape)"}),"\n",(0,s.jsx)(n.li,{children:"don't add property to objects dynamically (invalid inline cache)"}),"\n",(0,s.jsx)(n.li,{children:"don't mess with property attributes of array elements"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["V8 \u4E3A\u4E86\u63D0\u9AD8\u5BF9\u8C61\u5C5E\u6027\u7684\u8BBF\u95EE\u6548\u7387, \u5C06\u5C5E\u6027\u5206\u4E3A",(0,s.jsx)(n.a,{href:"https://v8.dev/blog/fast-properties",children:"\u591A\u79CD\u7C7B\u578B"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u6392\u5E8F\u5C5E\u6027 (elements): \u7B26\u5408\u6570\u7EC4\u7D22\u5F15\u7C7B\u578B\u7684\u5C5E\u6027 (\u6B63\u6574\u6570), \u5B58\u50A8\u4E3A\u7EBF\u6027\u7ED3\u6784, \u53EF\u5FEB\u901F\u8BBF\u95EE."}),"\n",(0,s.jsx)(n.li,{children:"\u5E38\u89C4\u5C5E\u6027 (properties): \u5B57\u7B26\u4E32\u7C7B\u578B\u7684\u5C5E\u6027 (\u5305\u62EC\u8D1F\u6570/\u6D6E\u70B9\u6570/Symbol), \u5B58\u50A8\u4E3A\u7EBF\u6027\u7ED3\u6784, \u53EF\u5FEB\u901F\u8BBF\u95EE."}),"\n",(0,s.jsx)(n.li,{children:"\u6162\u5C5E\u6027: \u5C5E\u6027\u9700\u8981\u53CD\u590D\u589E\u5220\u65F6, \u4F1A\u5C06\u5C5E\u6027\u5B58\u50A8\u7C7B\u578B\u4ECE\u7EBF\u6027\u7ED3\u6784 (\u5FEB\u5C5E\u6027) \u6539\u4E3A\u5B57\u5178\u7ED3\u6784 (\u6162\u5C5E\u6027)."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"object-structure",children:"Object Structure"}),"\n",(0,s.jsxs)(n.p,{children:["Basic ",(0,s.jsx)(n.a,{href:"https://blog.frontend-almanac.com/js-object-structure",children:"object structure"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Every object in JavaScript has its main internal class\nand a ",(0,s.jsx)(n.a,{href:"https://v8.dev/docs/hidden-classes",children:"hidden class"})," that describes its shape."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://v8.dev/docs/hidden-classes",children:"Hidden classes"}),"\ninherit from each other and are organized into class trees.\nThe shape of an object ",(0,s.jsx)(n.code,{children:"{ a: 1 }"})," will be the parent\nfor the shape of an object ",(0,s.jsx)(n.code,{children:"{ a: 1, b: 2 }"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["The order of properties matters.\nObjects ",(0,s.jsx)(n.code,{children:"{ a: 1, b: 2 }"})," and ",(0,s.jsx)(n.code,{children:"{ b: 2, a: 1 }"})," will have two different shapes."]}),"\n",(0,s.jsx)(n.li,{children:"A subclass holds a reference to the superclass\nand information about what has changed (transition)."}),"\n",(0,s.jsx)(n.li,{children:"In the class tree of each object,\nthe number of levels is not less than the number of properties in the object."}),"\n",(0,s.jsx)(n.li,{children:"The fastest properties of an object will be those declared at initialization,\nin-object property faster than external property."}),"\n",(0,s.jsxs)(n.li,{children:["Atypical changes in the object's structure, such as property removal (",(0,s.jsx)(n.code,{children:"delete"}),"),\ncan lead to a change in the storage type of properties to a slower one."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'const obj1 = { a: undefined }\nobj1.a = 1 // <- "a" - in-object property.\n\nconst obj2 = {}\nobj2.a = 1 // <- "a" - external property.\n\n// Change storage type to NameDictionary.\nconst obj1 = { a: 1, b: 2 }\ndelete obj1.a\n\n// Storage type is not changed.\nconst obj2 = { a: 1, b: 2 }\nobj2.a = undefined\n'})}),"\n",(0,s.jsxs)(n.p,{children:["An array is a regular class whose structure looks like ",(0,s.jsx)(n.code,{children:"{ length: [W__] }"}),".\nThe elements of the array are stored in special structures,\nand references to these structures are placed inside the object:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Adding or removing elements from the array\n",(0,s.jsx)(n.strong,{children:"does not"})," lead to an increase in the class tree."]}),"\n",(0,s.jsxs)(n.li,{children:["The use of atypical keys in an array,\nsuch as non-numeric keys or keys outside the range ",(0,s.jsx)(n.code,{children:"[0 .. 2**32 - 2]"}),",\nleads to the creation of new shapes in the class tree."]}),"\n",(0,s.jsx)(n.li,{children:"Attempting to modify an array element's attribute\nwill result in a switch to a slower storage type."}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// 1. New element of the array doesn't extends the shapes tree.\nconst arr = []\narr[0] = 1\n\n// 2. Leads to the shapes tree generation:\n// { length } => { length, [-1] } => { length, [-1], [2**32 - 1] }.\nconst arr = []\narr[-1] = 1\narr[2 ** 32 - 1] = 2\n\n// 3. Modify element's attribute result in switch to slower storage type.\nconst arr = [1, 2, 3]\n// { elements: {\n//   #0: 1,\n//   #1: 2,\n//   #2: 3\n// }}\n\nObject.defineProperty(arr, '0', { writable: false })\n// { elements: {\n//   #0: { value: 1, attrs: [_EC] },\n//   #1: { value: 2, attrs: [WEC] },\n//   #2: { value: 3, attrs: [WEC] }\n// }}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"garbage-collection",children:"Garbage Collection"}),"\n",(0,s.jsxs)(n.p,{children:["V8 ",(0,s.jsx)(n.a,{href:"https://mp.weixin.qq.com/s/VbAUPGt3sUVzEQHxWYmlBw",children:"garbage collection"}),"\n\u5206\u4EE3\u5783\u573E\u56DE\u6536\u7B97\u6CD5, \u5C06\u5806\u5206\u4E3A\u4E24\u4E2A\u7A7A\u95F4:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u65B0\u751F\u4EE3: \u5B58\u653E\u77ED\u5468\u671F\u5BF9\u8C61, \u7A7A\u95F4\u5C0F, \u4F7F\u7528 ",(0,s.jsx)(n.code,{children:"Scavenge"})," \u56DE\u6536\u7B97\u6CD5, \u526F\u5783\u573E\u56DE\u6536\u5668."]}),"\n",(0,s.jsxs)(n.li,{children:["\u8001\u751F\u4EE3: \u5B58\u653E\u957F\u5468\u671F\u5BF9\u8C61, \u7A7A\u95F4\u5927, \u4F7F\u7528 ",(0,s.jsx)(n.code,{children:"Mark-Sweep-Compact"})," \u56DE\u6536\u7B97\u6CD5, \u4E3B\u5783\u573E\u56DE\u6536\u5668."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"scavenge",children:"Scavenge"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u7A7A\u95F4\u6362\u65F6\u95F4\u7B97\u6CD5 (\u590D\u5236\u7B97\u6CD5)."}),"\n",(0,s.jsx)(n.li,{children:"\u6807\u8BB0\u6D3B\u52A8\u5BF9\u8C61\u548C\u975E\u6D3B\u52A8\u5BF9\u8C61."}),"\n",(0,s.jsx)(n.li,{children:"\u590D\u5236 from-space \u4E2D\u7684\u6D3B\u52A8\u5BF9\u8C61\u5230 to-space \u4E2D\u5E76\u8FDB\u884C\u6392\u5E8F."}),"\n",(0,s.jsx)(n.li,{children:"\u6E05\u9664 from-space \u4E2D\u7684\u6240\u6709\u5BF9\u8C61."}),"\n",(0,s.jsx)(n.li,{children:"\u5C06 from-space \u548C to-space \u8FDB\u884C\u89D2\u8272\u4E92\u6362, \u7B49\u5F85\u4E0B\u4E00\u6B21 GC."}),"\n",(0,s.jsx)(n.li,{children:"\u65B0\u751F\u4EE3\u5BF9\u8C61\u664B\u5347 (\u8BA1\u7B97\u5B58\u6D3B\u5468\u671F, \u521D\u59CB\u4E3A nursery \u5B50\u4EE3):\nallocation -> nursery \u5B50\u4EE3 -> intermediate \u5B50\u4EE3 -> \u8001\u751F\u4EE3."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"mark-sweep-compact",children:"Mark-Sweep-Compact"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u8001\u751F\u4EE3\u7A7A\u95F4\u5927, \u65E0\u6CD5\u4F7F\u7528\u7A7A\u95F4\u6362\u65F6\u95F4 (\u590D\u5236) \u7B97\u6CD5."}),"\n",(0,s.jsx)(n.li,{children:"\u6807\u8BB0\u9636\u6BB5: \u5BF9\u8001\u751F\u4EE3\u5BF9\u8C61\u8FDB\u884C\u7B2C\u4E00\u6B21\u626B\u63CF, \u5BF9\u6D3B\u52A8\u5BF9\u8C61\u8FDB\u884C\u6807\u8BB0."}),"\n",(0,s.jsx)(n.li,{children:"\u6E05\u7406\u9636\u6BB5: \u5BF9\u8001\u751F\u4EE3\u5BF9\u8C61\u8FDB\u884C\u7B2C\u4E8C\u6B21\u626B\u63CF, \u6E05\u9664\u672A\u6807\u8BB0\u7684\u5BF9\u8C61."}),"\n",(0,s.jsx)(n.li,{children:"\u538B\u7F29\u9636\u6BB5: \u6BCF\u6B21\u6E05\u7406\u5B8C\u975E\u6D3B\u52A8\u5BF9\u8C61, \u628A\u5269\u4E0B\u6D3B\u52A8\u5BF9\u8C61\u6574\u7406\u5230\u5185\u5B58\u7684\u4E00\u4FA7, \u56DE\u6536\u6389\u8FB9\u754C\u4E0A\u7684\u5185\u5B58 (\u4EE5\u5907\u540E\u7EED\u5927\u5BF9\u8C61\u8001\u751F\u4EE3)."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"stop-the-world",children:"Stop-The-World"}),"\n",(0,s.jsx)(n.p,{children:"\u5783\u573E\u56DE\u6536\u4F18\u5148\u4E8E\u4EE3\u7801\u6267\u884C, \u4F1A\u5148\u505C\u6B62\u4EE3\u7801\u7684\u6267\u884C,\n\u7B49\u5230\u5783\u573E\u56DE\u6536\u5B8C\u6BD5, \u518D\u6267\u884C JS \u4EE3\u7801, \u6210\u4E3A\u5168\u505C\u987F."}),"\n",(0,s.jsx)(n.p,{children:"Orinoco \u4F18\u5316 (\u4F18\u5316\u5168\u505C\u987F\u73B0\u8C61):"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Incremental marking (time slice): ",(0,s.jsx)(n.code,{children:"JS + Mark + JS + Mark ..."}),"."]}),"\n",(0,s.jsx)(n.li,{children:"Lazy sweeping."}),"\n",(0,s.jsx)(n.li,{children:"Concurrent GC."}),"\n",(0,s.jsx)(n.li,{children:"Parallel GC."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"performance",children:"Performance"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/thlorenz/deoptigate",children:"Deoptigate"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/thlorenz/turbolizer",children:"Turbolizer"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/thlorenz/v8-map-processor",children:"v8 map processor"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/thlorenz/v8-perf",children:"v8 perf"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"browser-engine",children:"Browser Engine"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Chrome: Blink (fork of ",(0,s.jsx)(n.code,{children:"WebCore"})," component from ",(0,s.jsx)(n.code,{children:"WebKit"}),") + V8."]}),"\n",(0,s.jsx)(n.li,{children:"Edge: Trident/EdgeHTML + Chakra -> Chromium."}),"\n",(0,s.jsx)(n.li,{children:"Firefox: Gecko + SpiderMonkey."}),"\n",(0,s.jsxs)(n.li,{children:["Safari: Webkit (fork of ",(0,s.jsx)(n.code,{children:"KHTML"})," and ",(0,s.jsx)(n.code,{children:"KJS"})," from ",(0,s.jsx)(n.code,{children:"KDE"}),") + JavaScriptCore (Nitro)."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Browser process architecture:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u6D4F\u89C8\u5668\u8FDB\u7A0B:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Singleton."}),"\n",(0,s.jsx)(n.li,{children:"\u6D4F\u89C8\u5668\u754C\u9762\u663E\u793A, \u63D0\u4F9B\u7528\u6237\u4EA4\u4E92, e.g. \u524D\u8FDB/\u540E\u9000."}),"\n",(0,s.jsx)(n.li,{children:"\u5B50\u8FDB\u7A0B\u7BA1\u7406."}),"\n",(0,s.jsx)(n.li,{children:"\u7F51\u7EDC\u8D44\u6E90\u7BA1\u7406."}),"\n",(0,s.jsx)(n.li,{children:"\u5B58\u50A8\u7BA1\u7406."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\u7F51\u7EDC\u8FDB\u7A0B:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Singleton."}),"\n",(0,s.jsx)(n.li,{children:"\u4E3B\u8981\u8D1F\u8D23\u9875\u9762\u7684\u7F51\u7EDC\u8D44\u6E90\u52A0\u8F7D."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsxs)(n.a,{href:"https://developer.chrome.com/articles/renderingng-architecture/#viz-process",children:[(0,s.jsx)(n.code,{children:"Viz"})," process"]}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Singleton."}),"\n",(0,s.jsx)(n.li,{children:"\u5B9E\u73B0 3D CSS, \u7ED8\u5236 UI \u754C\u9762."}),"\n",(0,s.jsx)(n.li,{children:"GPU main thread:\nrasters display lists and video frames into GPU texture tiles,\ndraws compositor frames to screen using GPU,\nOut-of-Process display compositor, raster and iframes (OOP-D, OOP-R, OOPIFs)."}),"\n",(0,s.jsxs)(n.li,{children:["Display compositor thread:\n",(0,s.jsx)(n.strong,{children:"aggregates and optimizes"})," compositing from render processes and browser process."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\u6E32\u67D3\u8FDB\u7A0B:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u6838\u5FC3\u4EFB\u52A1\u662F\u5C06 HTML/CSS \u548C JavaScript \u8F6C\u6362\u4E3A\u7528\u6237\u53EF\u4EE5\u4E0E\u4E4B\u4EA4\u4E92\u7684\u7F51\u9875 (\u9875\u9762\u6E32\u67D3, \u811A\u672C\u6267\u884C, \u4E8B\u4EF6\u5904\u7406)."}),"\n",(0,s.jsx)(n.li,{children:"\u6392\u7248\u5F15\u64CE Blink \u548C JavaScript \u5F15\u64CE V8 \u90FD\u662F\u8FD0\u884C\u5728\u8BE5\u8FDB\u7A0B\u4E2D."}),"\n",(0,s.jsx)(n.li,{children:"\u9ED8\u8BA4\u60C5\u51B5\u4E0B, Chrome \u4F1A\u4E3A\u6BCF\u4E2A Tab \u6807\u7B7E\u521B\u5EFA\u4E00\u4E2A\u6E32\u67D3\u8FDB\u7A0B."}),"\n",(0,s.jsxs)(n.li,{children:["Within a single browser tab,\nframes (",(0,s.jsx)(n.code,{children:"<iframe>"}),") from different sites are always in different render processes\n(OOPIFs, ",(0,s.jsx)(n.a,{href:"https://www.chromium.org/developers/design-documents/oop-iframes",children:"Out-of-Process iframes"}),"),\nbut frames (",(0,s.jsx)(n.code,{children:"<iframe>"}),") from same site are always in same render process."]}),"\n",(0,s.jsx)(n.li,{children:"\u51FA\u4E8E\u5B89\u5168\u8003\u8651, \u6E32\u67D3\u8FDB\u7A0B\u90FD\u662F\u8FD0\u884C\u5728\u6C99\u7BB1\u6A21\u5F0F\u4E0B."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"\u63D2\u4EF6\u8FDB\u7A0B:\n\u4E3B\u8981\u662F\u8D1F\u8D23\u63D2\u4EF6\u7684\u8FD0\u884C, \u56E0\u63D2\u4EF6\u6613\u5D29\u6E83, \u6240\u4EE5\u9700\u8981\u901A\u8FC7\u9694\u79BB\u4EE5\u4FDD\u8BC1\u63D2\u4EF6\u8FDB\u7A0B\u5D29\u6E83\u4E0D\u4F1A\u5BF9\u6D4F\u89C8\u5668\u548C\u9875\u9762\u9020\u6210\u5F71\u54CD."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"renderingng",children:"RenderingNG"}),"\n",(0,s.jsx)(n.p,{children:"Chromium rendering engine."}),"\n",(0,s.jsx)(n.h3,{id:"architecture",children:"Architecture"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://developer.chrome.com/articles/renderingng",children:(0,s.jsx)(n.img,{alt:"RenderingNG Architecture",src:i(1278).A+"",width:"1252",height:"1235"})})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"RenderingNG"})," key goals:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://developer.chrome.com/articles/renderingng/#reliability",children:"Reliability"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://developer.chrome.com/articles/renderingng/#scalable-performance",children:"Scalable Performance"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://developer.chrome.com/articles/renderingng/#extensibility-the-right-tools-for-the-job",children:"Extensibility"})}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"RenderingNG"})," key changes:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Uniform point of entry:\nalways enter the pipeline at the beginning\n(no longer possible to enter the pipeline starting at an intermediate phase)."}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Functional"})," stages:\neach stage should have well-defined inputs and outputs,\nand its behavior should be functional."]}),"\n",(0,s.jsx)(n.li,{children:"Constant inputs:\ninputs should be effectively constant while the stage is running."}),"\n",(0,s.jsx)(n.li,{children:"Immutable outputs:\noutputs should be immutable for the remainder of the rendering update."}),"\n",(0,s.jsx)(n.li,{children:"Checkpoint consistency:\nrendering data produced thus far should be in a self-consistent state\nat the end of each stage."}),"\n",(0,s.jsx)(n.li,{children:"De-duplication of work:\nonly compute each thing once."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"pipeline",children:"Pipeline"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://developer.chrome.com/articles/renderingng-architecture",children:"RenderingNG"}),"\n",(0,s.jsx)(n.a,{href:"https://developer.chrome.com/articles/renderingng-architecture/#the-pipeline-stages",children:"pipeline"}),"\n(green ",(0,s.jsx)(n.code,{children:"main"})," thread -> yellow ",(0,s.jsx)(n.code,{children:"compositor"})," thread -> orange ",(0,s.jsx)(n.code,{children:"Viz"})," process):"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Animate."}),"\n",(0,s.jsx)(n.li,{children:"Style."}),"\n",(0,s.jsx)(n.li,{children:"Layout."}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://developer.chrome.com/articles/blinkng/#the-pre-paint-phase",children:"Pre-paint"}),"."]}),"\n",(0,s.jsx)(n.li,{children:"Scroll."}),"\n",(0,s.jsx)(n.li,{children:"Paint."}),"\n",(0,s.jsx)(n.li,{children:"Commit."}),"\n",(0,s.jsx)(n.li,{children:"Layerize."}),"\n",(0,s.jsx)(n.li,{children:"Raster, decode and paint worklet (GPU hardware acceleration)."}),"\n",(0,s.jsx)(n.li,{children:"Activate."}),"\n",(0,s.jsx)(n.li,{children:"Aggregate (GPU hardware acceleration)."}),"\n",(0,s.jsx)(n.li,{children:"Draw (GPU hardware acceleration)."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://developer.chrome.com/articles/renderingng-architecture/#rendering-pipeline-structure",children:(0,s.jsx)(n.img,{alt:"RenderingNG Pipeline",src:i(14915).A+"",width:"845",height:"1344"})})}),"\n",(0,s.jsxs)(n.p,{children:["Stages of the rendering pipeline can be skipped if they aren't needed:\nScrolling and visual effects animation can skip ",(0,s.jsx)(n.code,{children:"layout"}),", ",(0,s.jsx)(n.code,{children:"pre-paint"})," and ",(0,s.jsx)(n.code,{children:"paint"}),".\nIf ",(0,s.jsx)(n.code,{children:"layout"}),", ",(0,s.jsx)(n.code,{children:"pre-paint"}),", and ",(0,s.jsx)(n.code,{children:"paint"})," can be skipped for visual effects,\nthey can be run entirely on ",(0,s.jsx)(n.code,{children:"compositor"})," thread and ",(0,s.jsxs)(n.strong,{children:["skip ",(0,s.jsx)(n.code,{children:"main"})," thread"]}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"render-process",children:"Render Process"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Download HTML."}),"\n",(0,s.jsx)(n.li,{children:"Parser/Script."}),"\n",(0,s.jsx)(n.li,{children:"DOM and CSSOM Construction."}),"\n",(0,s.jsx)(n.li,{children:"Render Tree = DOM Tree + Styled Tree."}),"\n",(0,s.jsx)(n.li,{children:"Layout."}),"\n",(0,s.jsx)(n.li,{children:"Paint."}),"\n",(0,s.jsx)(n.li,{children:"Composite."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://developer.chrome.com/articles/renderingng-architecture/#threads",children:(0,s.jsx)(n.img,{alt:"Render Process",src:i(44706).A+"",width:"845",height:"587"})})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["GUI \u6E32\u67D3\u7EBF\u7A0B (",(0,s.jsxs)(n.a,{href:"https://developer.chrome.com/articles/renderingng-architecture/#render-process-main-thread-components",children:[(0,s.jsx)(n.code,{children:"main"})," thread"]}),"):","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Parse ",(0,s.jsx)(n.code,{children:"HTML"}),"/",(0,s.jsx)(n.code,{children:"CSS"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Construct ",(0,s.jsx)(n.code,{children:"DOM"})," tree, ",(0,s.jsx)(n.code,{children:"CSSOM"})," tree and ",(0,s.jsx)(n.code,{children:"RenderObject"})," tree."]}),"\n",(0,s.jsx)(n.li,{children:"Layout render tree."}),"\n",(0,s.jsx)(n.li,{children:"Paint render tree."}),"\n",(0,s.jsxs)(n.li,{children:["Send information to GPU (Composite render tree):\nseparating\n",(0,s.jsx)(n.a,{href:"https://developer.chrome.com/articles/renderingng-architecture/#render-process-main-thread-components",children:(0,s.jsx)(n.code,{children:"main"})}),"\nand\n",(0,s.jsx)(n.a,{href:"https://developer.chrome.com/articles/renderingng-architecture/#render-process-compositor-thread-structure",children:(0,s.jsx)(n.code,{children:"compositor"})}),"\nthreads is critically important for\n",(0,s.jsx)(n.code,{children:"performance isolation"})," of animation and scrolling from main thread work."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["JS \u5F15\u64CE\u7EBF\u7A0B:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["JS \u5185\u6838\u8FD0\u884C\u7EBF\u7A0B, \u8D1F\u8D23\u89E3\u6790 ",(0,s.jsx)(n.code,{children:"JavaScript"})," \u811A\u672C, \u8FD0\u884C\u4EE3\u7801."]}),"\n",(0,s.jsx)(n.li,{children:"\u4E00\u4E2A Tab \u9875 (\u6E32\u67D3\u8FDB\u7A0B) \u4E2D\u53EA\u6709\u4E00\u4E2A JS \u5F15\u64CE\u7EBF\u7A0B\u5728\u8FD0\u884C JS \u7A0B\u5E8F."}),"\n",(0,s.jsx)(n.li,{children:"JS \u5F15\u64CE\u4E00\u76F4\u7B49\u5F85\u7740\u4EFB\u52A1\u961F\u5217\u4E2D\u4EFB\u52A1\u7684\u5230\u6765, \u7136\u540E\u52A0\u4EE5\u5904\u7406."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\u4E8B\u4EF6\u89E6\u53D1\u7EBF\u7A0B:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u8D1F\u8D23\u63A7\u5236\u4E8B\u4EF6\u5FAA\u73AF."}),"\n",(0,s.jsx)(n.li,{children:"JS \u5F15\u64CE\u7EBF\u7A0B\u89E6\u53D1 MacroTask/MicroTask, \u4E8B\u4EF6\u7EBF\u7A0B\u5C06\u4EFB\u52A1\u6DFB\u52A0\u5230\u4EFB\u52A1\u961F\u5217, \u7B49\u5F85 JS \u5F15\u64CE\u7EBF\u7A0B\u6267\u884C."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\u5B9A\u65F6\u89E6\u53D1\u5668\u7EBF\u7A0B:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"setInterval"})," \u4E0E ",(0,s.jsx)(n.code,{children:"setTimeout"})," \u6267\u884C\u7EBF\u7A0B."]}),"\n",(0,s.jsx)(n.li,{children:"\u6B64\u7EBF\u7A0B\u8BA1\u65F6\u5E76\u89E6\u53D1\u5B9A\u65F6\u5668\u4EFB\u52A1, \u8BA1\u65F6\u5B8C\u6BD5\u540E, \u4E8B\u4EF6\u7EBF\u7A0B\u5C06\u5B9A\u65F6\u5668\u4EFB\u52A1\u6DFB\u52A0\u5230\u4EFB\u52A1\u961F\u5217, \u7B49\u5F85 JS \u5F15\u64CE\u7EBF\u7A0B\u6267\u884C."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\u5F02\u6B65 HTTP \u8BF7\u6C42\u7EBF\u7A0B:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"XMLHttpRequest"})," \u8FDE\u63A5\u540E, \u901A\u8FC7\u6D4F\u89C8\u5668\u4EA7\u751F\u4E00\u4E2A\u65B0\u7684\u5F02\u6B65 HTTP \u8BF7\u6C42\u7EBF\u7A0B."]}),"\n",(0,s.jsx)(n.li,{children:"\u5F53\u68C0\u6D4B\u5230 HTTP \u8BF7\u6C42\u72B6\u6001\u53D8\u66F4\u65F6, \u6B64\u7EBF\u7A0B\u4EA7\u751F\u72B6\u6001\u53D8\u66F4\u4E8B\u4EF6,\n\u5E76\u5C06 HTTP \u54CD\u5E94\u5904\u7406\u51FD\u6570 (\u7528\u6237\u56DE\u8C03\u51FD\u6570) \u6DFB\u52A0\u5230\u4EFB\u52A1\u961F\u5217, \u7B49\u5F85 JS \u5F15\u64CE\u7EBF\u7A0B\u6267\u884C."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{title:"GUI and JS Thread",type:"danger",children:(0,s.jsx)(n.p,{children:"GUI \u6E32\u67D3\u7EBF\u7A0B\u4E0E JS \u5F15\u64CE\u7EBF\u7A0B\u4E92\u65A5."})}),"\n",(0,s.jsxs)(n.admonition,{title:"Multi-threads Architecture",type:"tip",children:[(0,s.jsx)(n.p,{children:"Threads help achieve:"}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Performance isolation and responsiveness in spite of slow tasks."}),"\n",(0,s.jsx)(n.li,{children:"Helper threads:\nsending long-running subtasks off to additional threads,\nto keep parent thread responsive to other requests happening simultaneously."}),"\n",(0,s.jsx)(n.li,{children:"Multiple buffering:\nshowing previously rendered content while rendering new content,\nto hide latency of rendering."}),"\n",(0,s.jsx)(n.li,{children:"Pipeline parallelization:\nrunning rendering pipeline in multiple places simultaneously\n(fast scrolling and animation)."}),"\n"]})]}),"\n",(0,s.jsx)(n.h3,{id:"html-parser",children:"HTML Parser"}),"\n",(0,s.jsx)(n.p,{children:"DTD is context-sensitive grammar.\nUse State Machine pattern to implement a tokenizer:"}),"\n",(0,s.jsx)(n.admonition,{title:"Tokenizer",type:"tip",children:(0,s.jsx)(n.p,{children:"Data -> Tag Open -> Tag Name -> Tag Close -> Data."})}),"\n",(0,s.jsx)(n.p,{children:"tokenizer send tokens to constructor, constructing DOM tree:"}),"\n",(0,s.jsx)(n.admonition,{title:"DOM Tree Constructor",type:"tip",children:(0,s.jsx)(n.p,{children:"initial -> before HTML -> before head -> in head -> after head\n-> in body -> after body -> after after body -> EOF token."})}),"\n",(0,s.jsx)(n.p,{children:"HTML parser performance:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"<= 1500"})," DOM nodes."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"<= 60"})," children nodes."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"<= 32"})," levels."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"css-parser",children:"CSS Parser"}),"\n",(0,s.jsx)(n.p,{children:"CSS is context-free grammar.\nWebkit use flex/bison (bottom-to-up), Gecko use up-to-bottom."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ruleSet\n  : selector [ ',' S* selector ]*\n    '{' S* declaration [ ';' S* declaration ]* '}' S*\n  ;\nselector\n  : simple_selector [ combinator selector | S+ [ combinator? selector ]? ]?\n  ;\nsimple_selector\n  : element_name [ HASH | class | attrib | pseudo ]*\n  | [ HASH | class | attrib | pseudo ]+\n  ;\nclass\n  : '.' IDENT\n  ;\nelement_name\n  : IDENT | '*'\n  ;\nattrib\n  : '[' S* IDENT S* [ [ '=' | INCLUDES | DASHMATCH ] S*\n    [ IDENT | STRING ] S* ] ']'\n  ;\npseudo\n  : ':' [ IDENT | FUNCTION S* [IDENT S*] ')' ]\n  ;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"layout-engine",children:"Layout Engine"}),"\n",(0,s.jsxs)(n.p,{children:["\u4E3A\u907F\u514D\u5BF9\u6240\u6709\u7EC6\u5C0F\u66F4\u6539\u90FD\u8FDB\u884C\u6574\u4F53\u5E03\u5C40, \u6D4F\u89C8\u5668\u91C7\u7528\u4E86\u4E00\u79CD ",(0,s.jsx)(n.code,{children:"dirty bit"})," \u7CFB\u7EDF.\n\u5982\u679C\u67D0\u4E2A\u5448\u73B0\u5668\u53D1\u751F\u4E86\u66F4\u6539, \u6216\u8005\u5C06\u81EA\u8EAB\u53CA\u5176\u5B50\u4EE3\u6807\u6CE8\u4E3A ",(0,s.jsx)(n.code,{children:"dirty"}),", \u5219\u9700\u8981\u8FDB\u884C\u5E03\u5C40:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u7236\u5448\u73B0\u5668\u786E\u5B9A\u81EA\u5DF1\u7684\u5BBD\u5EA6."}),"\n",(0,s.jsxs)(n.li,{children:["\u7236\u5448\u73B0\u5668\u4F9D\u6B21\u5904\u7406\u5B50\u5448\u73B0\u5668, \u5E76\u4E14:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u653E\u7F6E\u5B50\u5448\u73B0\u5668 (\u8BBE\u7F6E ",(0,s.jsx)(n.code,{children:"(x, y)"})," \u5750\u6807)."]}),"\n",(0,s.jsx)(n.li,{children:"\u5982\u679C\u6709\u5FC5\u8981, \u8C03\u7528\u5B50\u5448\u73B0\u5668\u7684\u5E03\u5C40 (\u5982\u679C\u5B50\u5448\u73B0\u5668\u662F dirty \u7684, \u6216\u8005\u8FD9\u662F\u5168\u5C40\u5E03\u5C40, \u6216\u51FA\u4E8E\u5176\u4ED6\u67D0\u4E9B\u539F\u56E0),\n\u8FD9\u4F1A\u8BA1\u7B97\u5B50\u5448\u73B0\u5668\u7684\u9AD8\u5EA6."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"\u7236\u5448\u73B0\u5668\u6839\u636E\u5B50\u5448\u73B0\u5668\u7684\u7D2F\u52A0\u9AD8\u5EA6\u4EE5\u53CA\u8FB9\u8DDD\u548C\u8865\u767D\u7684\u9AD8\u5EA6\u6765\u8BBE\u7F6E\u81EA\u8EAB\u9AD8\u5EA6, \u6B64\u503C\u4E5F\u53EF\u4F9B\u7236\u5448\u73B0\u5668\u7684\u7236\u5448\u73B0\u5668\u4F7F\u7528."}),"\n",(0,s.jsxs)(n.li,{children:["\u5C06\u5176 ",(0,s.jsx)(n.code,{children:"dirty \u4F4D"})," \u8BBE\u7F6E\u4E3A ",(0,s.jsx)(n.code,{children:"false"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"RenderingNG"})," ",(0,s.jsx)(n.a,{href:"https://developer.chrome.com/articles/layoutng",children:"layout engine"}),"\ngenerate\n",(0,s.jsx)(n.a,{href:"https://developer.chrome.com/articles/renderingng-data-structures/#the-immutable-fragment-tree",children:"immutable fragment tree"}),"\nand\n",(0,s.jsx)(n.a,{href:"https://developer.chrome.com/articles/renderingng-data-structures/#inline-fragment-items",children:"immutable flat list"}),".\nIt helps mitigate layout bugs including:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://developer.chrome.com/articles/layoutng/#correctness",children:"Correctness"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://developer.chrome.com/articles/layoutng/#under-invalidation",children:"Under-invalidation"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://developer.chrome.com/articles/layoutng/#over-invalidation-and-performance",children:"Over-invalidation"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://developer.chrome.com/articles/layoutng/#hysteresis",children:"Hysteresis"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"paint-engine",children:"Paint Engine"}),"\n",(0,s.jsx)(n.p,{children:"Paint order:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u80CC\u666F\u989C\u8272."}),"\n",(0,s.jsx)(n.li,{children:"\u80CC\u666F\u56FE\u7247."}),"\n",(0,s.jsx)(n.li,{children:"\u8FB9\u6846."}),"\n",(0,s.jsx)(n.li,{children:"\u5B50\u4EE3."}),"\n",(0,s.jsx)(n.li,{children:"\u8F6E\u5ED3."}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://developer.chrome.com/articles/renderingng-data-structures/#property-trees",children:"Property trees"}),"\nare data structures that explain how visual and scrolling effects apply to DOM elements.\nEvery web document has four separate property trees:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Transform tree represents CSS transforms and scrolling."}),"\n",(0,s.jsx)(n.li,{children:"Clip tree represents overflow clips."}),"\n",(0,s.jsx)(n.li,{children:"Effect tree represents all other visual effects:\nopacity, filters, masks, blend modes, and other kinds of clips such as clip-path."}),"\n",(0,s.jsx)(n.li,{children:"Scroll tree represents information about scrolling,.\nsuch as how scrolls chain together"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"JavaScript \u963B\u585E\u6E32\u67D3:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u6E32\u67D3\u8FDB\u7A0B (",(0,s.jsx)(n.code,{children:"Render"})," process) \u4E2D\u4E3B\u7EBF\u7A0B (",(0,s.jsx)(n.code,{children:"main"})," thread) ",(0,s.jsx)(n.code,{children:"Layout"})," \u9636\u6BB5\u4E0E ",(0,s.jsx)(n.code,{children:"Paint"})," \u9636\u6BB5\u4E0D\u8D1F\u8D23\u5B9E\u9645\u7684\u7ED8\u5236\u64CD\u4F5C:\n",(0,s.jsx)(n.code,{children:"Layout"})," \u9636\u6BB5\u6267\u884C ",(0,s.jsx)(n.code,{children:"Update Layer Tree"}),", \u66F4\u65B0\u6BCF\u5C42\u4FE1\u606F,\n",(0,s.jsx)(n.code,{children:"Paint"})," \u9636\u6BB5\u6574\u7406\u6BCF\u5C42\u9875\u9762\u7684\u7ED8\u5236\u4FE1\u606F, \u6784\u5EFA\u7ED8\u5236\u5217\u8868."]}),"\n",(0,s.jsxs)(n.li,{children:["\u4EE5\u4E0A\u9636\u6BB5\u7684\u6570\u636E\u6700\u7EC8\u4F1A\u4EA4\u7ED9\n\u6E32\u67D3\u8FDB\u7A0B (",(0,s.jsx)(n.code,{children:"Render"})," process) \u4E2D\u5408\u6210\u7EBF\u7A0B (",(0,s.jsx)(n.code,{children:"compositor"})," thread) \u4E0E ",(0,s.jsx)(n.code,{children:"Viz"})," process \u6267\u884C\u5B9E\u9645\u7684\u7ED8\u5236\u64CD\u4F5C."]}),"\n",(0,s.jsxs)(n.li,{children:["JavaScript \u963B\u585E\u4E86\u540C\u5728\u4E3B\u7EBF\u7A0B\u7684 ",(0,s.jsx)(n.code,{children:"Layout"})," \u9636\u6BB5\u4E0E ",(0,s.jsx)(n.code,{children:"Paint"})," \u9636\u6BB5,\n\u95F4\u63A5\u963B\u585E\u4E86 ",(0,s.jsx)(n.code,{children:"compositor"})," thread \u4E0E ",(0,s.jsx)(n.code,{children:"Viz"})," process \u7684\u7ED8\u5236\u64CD\u4F5C."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"video-engine",children:"Video Engine"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://developer.chrome.com/articles/videong",children:(0,s.jsx)(n.img,{alt:"RenderingNG Video Engine",src:i(74905).A+"",width:"845",height:"474"})})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Each video talks directly to ",(0,s.jsx)(n.code,{children:"Viz"})," process:\nvideo rendering is largely decoupled from ",(0,s.jsx)(n.code,{children:"RenderingNG"})," main rendering pipeline."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"scrolling-performance",children:"Scrolling Performance"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Cached GPU textures and display lists:\nhelp battery life and animation frame rate for scrolling."}),"\n",(0,s.jsx)(n.li,{children:"Every possible scroll is threaded:\ndon't have to depend on the JavaScript and layout thread."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"animation-performance",children:"Animation Performance"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://developer.chrome.com/articles/renderingng-architecture/#an-example-in-practice",children:(0,s.jsx)(n.img,{alt:"RenderingNG Transform Animation",src:i(92153).A+"",width:"845",height:"516"})})}),"\n",(0,s.jsxs)(n.p,{children:["CSS transform animation only runs on ",(0,s.jsx)(n.code,{children:"compositor"})," thread and ",(0,s.jsx)(n.code,{children:"Viz"})," process."]}),"\n",(0,s.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Chromium rendering engine: ",(0,s.jsx)(n.a,{href:"https://developer.chrome.com/blog/renderingng",children:"RenderingNG"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Chromium ",(0,s.jsx)(n.code,{children:"RenderingNG"})," ",(0,s.jsx)(n.a,{href:"https://developer.chrome.com/blog/renderingng-architecture",children:"architecture"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Chromium ",(0,s.jsx)(n.code,{children:"RenderingNG"})," ",(0,s.jsx)(n.a,{href:"https://developer.chrome.com/blog/renderingng-data-structures",children:"key data structures"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Chromium ",(0,s.jsx)(n.a,{href:"https://developer.chrome.com/blog/videong",children:"video engine architecture"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Chromium ",(0,s.jsx)(n.a,{href:"https://developer.chrome.com/articles/layoutng",children:"layout engine architecture"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Chromium ",(0,s.jsx)(n.code,{children:"Blink"})," ",(0,s.jsx)(n.a,{href:"https://developer.chrome.com/articles/blinkng",children:"architecture"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Web platform ",(0,s.jsx)(n.a,{href:"https://wpt.fyi",children:"tests"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Google Chrome platform feature ",(0,s.jsx)(n.a,{href:"https://github.com/GoogleChrome/chromium-dashboard",children:"status"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Mozilla Firefox platform feature ",(0,s.jsx)(n.a,{href:"https://github.com/mozilla/standards-positions",children:"status"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Thin wrappers around ",(0,s.jsx)(n.a,{href:"https://polypane.app/blog/not-all-browser-apis-are-web-apis",children:"native APIs"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["JavaScript ",(0,s.jsx)(n.a,{href:"https://buttondown.com/whatever_jamie/archive/the-many-many-many-javascript-runtimes-of-the-last-decade",children:"runtimes"}),"."]}),"\n"]})]})}function h(e={}){let{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},29728(e,n,i){i.d(n,{A:()=>r});let r=i.p+"assets/images/context-stack-and-scope-chain-1fe54b80b91bd079b55a126e7d2fec4a.png"},44106(e,n,i){i.d(n,{A:()=>r});let r=i.p+"assets/images/event-loop-55376b882d25e724423d4dc9883cf416.jpg"},44706(e,n,i){i.d(n,{A:()=>r});let r=i.p+"assets/images/render-process-d33647f97a751f3e6601f1209758c41f.webp"},92153(e,n,i){i.d(n,{A:()=>r});let r=i.p+"assets/images/rendering-ng-animation-ebbf3b677788319cd6f78d7c148ef594.webp"},14915(e,n,i){i.d(n,{A:()=>r});let r=i.p+"assets/images/rendering-ng-pipeline-fb49aa882cd3041e0db55f2b47c728f7.webp"},74905(e,n,i){i.d(n,{A:()=>r});let r=i.p+"assets/images/rendering-ng-video-engine-7c8d28a5bf1cda6a76d9eebe34c97031.webp"},1278(e,n,i){i.d(n,{A:()=>r});let r=i.p+"assets/images/rendering-ng-9f126cf8c6b7acb6bbb8fedb207599bb.webp"},30416(e,n,i){i.d(n,{R:()=>t,x:()=>o});var r=i(59471);let s={},l=r.createContext(s);function t(e){let n=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),r.createElement(l.Provider,{value:n},e.children)}}}]);