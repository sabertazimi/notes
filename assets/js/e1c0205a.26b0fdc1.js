"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([["75813"],{17746(e,n,l){l.r(n),l.d(n,{metadata:()=>s,default:()=>h,frontMatter:()=>r,contentTitle:()=>c,toc:()=>t,assets:()=>d});var s=JSON.parse('{"id":"cs/database/sql","title":"SQL","description":"Data-intensive applications may not use DBMS or query language at all,","source":"@site/content/cs/database/sql.md","sourceDirName":"cs/database","slug":"/cs/database/sql","permalink":"/notes/cs/database/sql","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/cs/database/sql.md","tags":[{"inline":true,"label":"CS","permalink":"/notes/tags/cs"},{"inline":true,"label":"Database","permalink":"/notes/tags/database"},{"inline":true,"label":"SQL","permalink":"/notes/tags/sql"}],"version":"current","lastUpdatedBy":"Sabertaz","lastUpdatedAt":1769518084000,"sidebarPosition":10,"frontMatter":{"sidebar_position":10,"tags":["CS","Database","SQL"]},"sidebar":"tutorialSidebar","previous":{"title":"Transactions","permalink":"/notes/cs/database/transactions"},"next":{"title":"Graph Processing","permalink":"/notes/cs/graph/"}}'),a=l(62615),i=l(30416);let r={sidebar_position:10,tags:["CS","Database","SQL"]},c="SQL",d={},t=[{value:"CRUD",id:"crud",level:2},{value:"Table",id:"table",level:2},{value:"Where",id:"where",level:2},{value:"Order",id:"order",level:2},{value:"Group",id:"group",level:2},{value:"Aggregation",id:"aggregation",level:2},{value:"Limit",id:"limit",level:2},{value:"Distinct",id:"distinct",level:2},{value:"Set",id:"set",level:2},{value:"Join",id:"join",level:2},{value:"Index",id:"index",level:2},{value:"Export and Import",id:"export-and-import",level:2},{value:"View",id:"view",level:2},{value:"MySQL",id:"mysql",level:2},{value:"Container",id:"container",level:3},{value:"Infrastructure",id:"infrastructure",level:3}];function o(e){let n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"sql",children:"SQL"})}),"\n",(0,a.jsx)(n.admonition,{type:"note",children:(0,a.jsxs)(n.p,{children:["Data-intensive applications may not use ",(0,a.jsx)(n.code,{children:"DBMS"})," or query language at all,\ne.g. Hadoop, all operations on data stores in files."]})}),"\n",(0,a.jsx)(n.h2,{id:"crud",children:"CRUD"}),"\n",(0,a.jsx)(n.p,{children:"\u589E\u5220\u67E5\u6539:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"-- \u63D2\u5165\nINSERT INTO table_name (column_name) VALUES (sql_value);\n\n-- \u5220\u9664\nDELETE FROM table_name WHERE column_name = sql_value;\n\n-- \u67E5\u8BE2\nSELECT * FROM table_name WHERE column_name = sql_value;\n\n-- \u66F4\u65B0\nUPDATE table_name SET column1 = value1 WHERE column2 = value2;\n"})}),"\n",(0,a.jsx)(n.h2,{id:"table",children:"Table"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"-- \u6DFB\u52A0\u5217\nALTER TABLE table_name ADD COLUMN column_name;\n\n-- \u5220\u9664\u5217\nALTER TABLE table_name DROP COLUMN column_name;\n\n-- \u4FEE\u6539\u5217\nALTER TABLE table_name MODIFY COLUMN column_name;\n\n-- \u91CD\u547D\u540D\u5217\nALTER TABLE table_name RENAME COLUMN column_name TO new_column_name;\n\n-- \u91CD\u547D\u540D\u8868\nALTER TABLE table_name RENAME TO new_table_name;\n"})}),"\n",(0,a.jsx)(n.h2,{id:"where",children:"Where"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"="})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"<>"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:">"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:">="})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"<"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"<="})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"NOT"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"AND"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"OR"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"IN (collection)"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"BETWEEN value1 AND value2"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"LIKE '%\u738B_'"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"REGEXP 'regexp'"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"IS NULL"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"IS NOT NULL"})}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"order",children:"Order"}),"\n",(0,a.jsx)(n.p,{children:"\u6392\u5E8F:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"ORDER BY column_name [ASC|DESC]\n"})}),"\n",(0,a.jsx)(n.h2,{id:"group",children:"Group"}),"\n",(0,a.jsx)(n.p,{children:"\u5206\u7EC4:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"GROUP BY column_name [HAVING condition]\n"})}),"\n",(0,a.jsx)(n.h2,{id:"aggregation",children:"Aggregation"}),"\n",(0,a.jsx)(n.p,{children:"\u805A\u5408\u51FD\u6570:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"AVG(column_name)\n\nCOUNT(column_name)\n\nMAX(column_name)\n\nMIN(column_name)\n\nSUM(column_name)\n"})}),"\n",(0,a.jsx)(n.h2,{id:"limit",children:"Limit"}),"\n",(0,a.jsx)(n.p,{children:"\u9650\u5236\u6570\u91CF:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"LIMIT [offset,] length\n"})}),"\n",(0,a.jsx)(n.h2,{id:"distinct",children:"Distinct"}),"\n",(0,a.jsx)(n.p,{children:"\u53BB\u91CD:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"DISTINCT column_name\n"})}),"\n",(0,a.jsx)(n.h2,{id:"set",children:"Set"}),"\n",(0,a.jsx)(n.p,{children:"\u5E76\u96C6:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"query UNION query\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u4EA4\u96C6:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"query INTERSECT query\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u5DEE\u96C6:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"query EXCEPT query\n"})}),"\n",(0,a.jsx)(n.h2,{id:"join",children:"Join"}),"\n",(0,a.jsx)(n.p,{children:"\u8868\u5173\u8054:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"-- \u5185\u8FDE\u63A5\nINNER JOIN table_name ON condition\n\n-- \u5DE6\u8FDE\u63A5\nLEFT JOIN table_name ON condition\n\n-- \u53F3\u8FDE\u63A5\nRIGHT JOIN table_name ON condition\n\n-- \u5916\u8FDE\u63A5\nOUTER JOIN table_name ON condition\n"})}),"\n",(0,a.jsx)(n.h2,{id:"index",children:"Index"}),"\n",(0,a.jsx)(n.p,{children:"\u7D22\u5F15:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"CREATE [UNIQUE|FULLTEXT|SPATIAL] INDEX index ON table_name (column1, column2, ...);\n\nDROP INDEX index ON table_name;\n\nSHOW INDEX FROM table_name;\n\nALTER TABLE table_name ADD INDEX index (column1, column2, ...);\n"})}),"\n",(0,a.jsx)(n.h2,{id:"export-and-import",children:"Export and Import"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"mysqldump -u <user> -p<password> <database> > sync.sql\nmysql -u <user> -p<password> <database> < sync.sql\n"})}),"\n",(0,a.jsx)(n.h2,{id:"view",children:"View"}),"\n",(0,a.jsx)(n.p,{children:"\u89C6\u56FE:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Logical layer: hiding data from users"}),"\n",(0,a.jsx)(n.li,{children:"Modularity and reuse of query"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"CREATE VIEW view AS query;\n\nDROP VIEW view;\n\nALTER VIEW view AS query;\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"DROP VIEW IF EXISTS Standings;\nDROP VIEW IF EXISTS Count;\nDROP VIEW IF EXISTS Wins;\nDROP TABLE IF EXISTS Matches;\nDROP TABLE IF EXISTS Players;\n\n-- Players Table\nCREATE TABLE Players (\n  id SERIAL primary key,\n  name varchar(255)\n);\n\n-- Matches Table\nCREATE TABLE Matches (\n  id SERIAL primary key,\n  player int references Players(id),\n  opponent int references Players(id),\n  result int\n);\n\n-- Wins View shows number of wins for each Player\nCREATE VIEW Wins AS\n  SELECT Players.id, COUNT(Matches.opponent) AS n\n  FROM Players\n  LEFT JOIN (SELECT * FROM Matches WHERE result>0) as Matches\n  ON Players.id = Matches.player\n  GROUP BY Players.id;\n\n-- Count View shows number of matches for each Player\nCREATE VIEW Count AS\n  SELECT Players.id, Count(Matches.opponent) AS n\n  FROM Players\n  LEFT JOIN Matches\n  ON Players.id = Matches.player\n  GROUP BY Players.id;\n\n-- Standings View shows number of wins and matches for each Player\nCREATE VIEW Standings AS\n  SELECT Players.id,Players.name,Wins.n as wins,Count.n as matches\n  FROM Players,Count,Wins\n  WHERE Players.id = Wins.id and Wins.id = Count.id;\n"})}),"\n",(0,a.jsx)(n.p,{children:"Owing to views are logical layer, it's senseless to modify data on views:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"CREATE TRIGGER TriggerName\nINSTEAD OF DELETE/UPDATE OF/INSERT ON ViewName\n[ referencing-variables ]\n[ FOR EACH ROW ]\nWHEN ( Condition )\n[ BEGIN ]\nAction\n[ END ];\n"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"SELECT"})," (no ",(0,a.jsx)(n.code,{children:"DISTINCT"}),") on single table ",(0,a.jsx)(n.code,{children:"T"})]}),"\n",(0,a.jsxs)(n.li,{children:["No ",(0,a.jsx)(n.code,{children:"GROUP BY/HAVING"})," or aggregation"]}),"\n",(0,a.jsxs)(n.li,{children:["Attributes can't be ",(0,a.jsx)(n.code,{children:"NULL"})," or default values"]}),"\n",(0,a.jsxs)(n.li,{children:["Sub-queries can't refer to table ",(0,a.jsx)(n.code,{children:"T"})]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"mysql",children:"MySQL"}),"\n",(0,a.jsx)(n.h3,{id:"container",children:"Container"}),"\n",(0,a.jsxs)(n.p,{children:["Setup in ",(0,a.jsx)(n.a,{href:"https://github.com/dromara/RuoYi-Vue-Plus/blob/5.X/script/docker/docker-compose.yml",children:"Docker"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yml",children:"services:\n  mysql:\n    image: mysql:8.0.33\n    container_name: mysql\n    restart: unless-stopped\n    environment:\n      # \u65F6\u533A\u4E0A\u6D77\n      TZ: Asia/Shanghai\n      # root \u5BC6\u7801\n      MYSQL_ROOT_PASSWORD: 123456\n      # \u521D\u59CB\u5316\u6570\u636E\u5E93\n      MYSQL_DATABASE: ry-vue\n    ports:\n      - '3306:3306'\n    volumes:\n      # \u914D\u7F6E\u6302\u8F7D\n      - ./docker/mysql/conf:/etc/mysql/conf.d/\n      - ./docker/mysql/conf/ry.cnf:/etc/mysql/conf.d/ry.cnf:ro\n      # \u6570\u636E\u6302\u8F7D\n      - ./docker/mysql/data:/var/lib/mysql/\n      # \u65E5\u5FD7\u6302\u8F7D\n      - ./docker/mysql/logs:/var/log/mysql\n      # \u6570\u636E\u5E93\u521D\u59CB\u5316\n      - ./docker/mysql/init:/docker-entrypoint-initdb.d\n      # \u6570\u636E\u5E93\u811A\u672C\n      - ./docker/mysql/sql:/opt/mysql/sql\n    privileged: true\n    command:\n      # \u5C06mysql8.0\u9ED8\u8BA4\u5BC6\u7801\u7B56\u7565 \u4FEE\u6539\u4E3A \u539F\u5148 \u7B56\u7565 (mysql8.0\u5BF9\u5176\u9ED8\u8BA4\u7B56\u7565\u505A\u4E86\u66F4\u6539 \u4F1A\u5BFC\u81F4\u5BC6\u7801\u65E0\u6CD5\u5339\u914D)\n      --default-authentication-plugin=mysql_native_password\n      --character-set-server=utf8mb4\n      --collation-server=utf8mb4_general_ci\n      --explicit_defaults_for_timestamp=true\n      --lower_case_table_names=1\n"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.a,{href:"https://cloud.tencent.com/developer/article/2356690",children:"\u5141\u8BB8\u5916\u90E8\u8FDE\u63A5"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"mysql -uroot -proot\nGRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY 'root' WITH GRANT OPTION;\nFLUSH PRIVILEGES;\nchmod 644 /etc/mysql/conf.d/mysql.cnf\nmysql -h 127.0.0.1 -P 3306 -uroot -proot\n"})}),"\n",(0,a.jsx)(n.h3,{id:"infrastructure",children:"Infrastructure"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"MySQL Server Layer",src:l(79655).A+"",title:"MySQL Server Layer",width:"738",height:"922"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"MySQL Infrastructure",src:l(42007).A+"",title:"MySQL Infrastructure",width:"1080",height:"608"})})]})}function h(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(o,{...e})}):o(e)}},42007(e,n,l){l.d(n,{A:()=>s});let s=l.p+"assets/images/mysql-infrastructure-04ee14e9c70eec52175a628e5efa2f38.jpg"},79655(e,n,l){l.d(n,{A:()=>s});let s=l.p+"assets/images/mysql-server-layer-8feb10da050341827c2bc03d07a3a686.png"},30416(e,n,l){l.d(n,{R:()=>r,x:()=>c});var s=l(59471);let a={},i=s.createContext(a);function r(e){let n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);