"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([["35275"],{63607(e,n,i){i.r(n),i.d(n,{metadata:()=>s,default:()=>o,frontMatter:()=>d,contentTitle:()=>a,toc:()=>t,assets:()=>c});var s=JSON.parse('{"id":"programming/linux/user","title":"User","description":"- w/who: \u67E5\u770B\u7528\u6237\u8BE6\u7EC6\u4FE1\u606F","source":"@site/content/programming/linux/user.md","sourceDirName":"programming/linux","slug":"/programming/linux/user","permalink":"/notes/programming/linux/user","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/programming/linux/user.md","tags":[{"inline":true,"label":"Programming","permalink":"/notes/tags/programming"},{"inline":true,"label":"OS","permalink":"/notes/tags/os"},{"inline":true,"label":"Linux","permalink":"/notes/tags/linux"},{"inline":true,"label":"Security","permalink":"/notes/tags/security"},{"inline":true,"label":"User","permalink":"/notes/tags/user"},{"inline":true,"label":"Group","permalink":"/notes/tags/group"}],"version":"current","lastUpdatedBy":"sabertazimi","lastUpdatedAt":1772423614000,"sidebarPosition":20,"frontMatter":{"sidebar_position":20,"tags":["Programming","OS","Linux","Security","User","Group"]},"sidebar":"tutorialSidebar","previous":{"title":"Toolchain","permalink":"/notes/programming/linux/toolchain"},"next":{"title":"System","permalink":"/notes/programming/linux/system"}}'),l=i(62615),r=i(30416);let d={sidebar_position:20,tags:["Programming","OS","Linux","Security","User","Group"]},a="User",c={},t=[{value:"\u7EC4",id:"\u7EC4",level:2},{value:"\u521B\u5EFA\u7EC4",id:"\u521B\u5EFA\u7EC4",level:3},{value:"\u4FEE\u6539\u7EC4",id:"\u4FEE\u6539\u7EC4",level:3},{value:"\u5220\u9664\u7EC4",id:"\u5220\u9664\u7EC4",level:3},{value:"\u67E5\u770B\u7EC4",id:"\u67E5\u770B\u7EC4",level:3},{value:"\u7528\u6237",id:"\u7528\u6237",level:2},{value:"\u589E\u52A0\u7528\u6237",id:"\u589E\u52A0\u7528\u6237",level:3},{value:"\u4FEE\u6539\u7528\u6237",id:"\u4FEE\u6539\u7528\u6237",level:3},{value:"\u5220\u9664\u7528\u6237",id:"\u5220\u9664\u7528\u6237",level:3},{value:"\u67E5\u770B\u7528\u6237",id:"\u67E5\u770B\u7528\u6237",level:3},{value:"\u9650\u5236\u7528\u6237",id:"\u9650\u5236\u7528\u6237",level:3},{value:"\u767B\u5F55\u5931\u8D25\u9501\u5B9A",id:"\u767B\u5F55\u5931\u8D25\u9501\u5B9A",level:3},{value:"Common Privilege",id:"common-privilege",level:2},{value:"ACL Privilege",id:"acl-privilege",level:2},{value:"Sudo Privilege",id:"sudo-privilege",level:2},{value:"SetUID and SetGID",id:"setuid-and-setgid",level:2}];function h(e){let n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"user",children:"User"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"w/who"}),": \u67E5\u770B\u7528\u6237\u8BE6\u7EC6\u4FE1\u606F"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"last"}),": \u663E\u793A\u6240\u6709\u7528\u6237\u767B\u9646\u4FE1\u606F(/var/log/wtmp)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"lastlog"}),": \u663E\u793A\u6240\u6709\u7528\u6237\u6700\u540E\u4E00\u6B21\u767B\u9646\u65F6\u95F4(/var/log/lastlog)"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"\u7EC4",children:"\u7EC4"}),"\n",(0,l.jsx)(n.h3,{id:"\u521B\u5EFA\u7EC4",children:"\u521B\u5EFA\u7EC4"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"groupadd test\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u4FEE\u6539\u7EC4",children:"\u4FEE\u6539\u7EC4"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"groupmod -n test2 test -g\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u5220\u9664\u7EC4",children:"\u5220\u9664\u7EC4"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"groupdel test2\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u67E5\u770B\u7EC4",children:"\u67E5\u770B\u7EC4"}),"\n",(0,l.jsx)(n.p,{children:"\u67E5\u770B\u7528\u6237\u6240\u5C5E\u7EC4:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"groups <username>\ncat /etc/group\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"/etc/passwd"})," is a configuration file which stores user account information.\nIt is a plaintext-based file containing information\nlike username, user ID and group ID."]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"cat /etc/passwd | awk -F [:] \u2018{print $4}\u2019 | sort | uniq | getent group | awk -F [:] \u2018{print $1}\u2019\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u7528\u6237",children:"\u7528\u6237"}),"\n",(0,l.jsx)(n.h3,{id:"\u589E\u52A0\u7528\u6237",children:"\u589E\u52A0\u7528\u6237"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"useradd [options] LOGIN\n"})}),"\n",(0,l.jsx)(n.p,{children:"Options:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"-b, --base-dir BASE_DIR \u8BBE\u7F6E\u57FA\u672C\u8DEF\u5F84\u4F5C\u4E3A\u7528\u6237\u7684\u767B\u5F55\u76EE\u5F55"}),"\n",(0,l.jsx)(n.li,{children:"-c, --comment COMMENT \u5BF9\u7528\u6237\u7684\u6CE8\u91CA"}),"\n",(0,l.jsx)(n.li,{children:"-d, --home-dir HOME_DIR \u8BBE\u7F6E\u7528\u6237\u7684\u767B\u5F55\u76EE\u5F55"}),"\n",(0,l.jsx)(n.li,{children:"-D, --defaults \u6539\u53D8\u8BBE\u7F6E"}),"\n",(0,l.jsx)(n.li,{children:"-e, --expiredate EXPIRE_DATE \u8BBE\u7F6E\u7528\u6237\u7684\u6709\u6548\u671F"}),"\n",(0,l.jsx)(n.li,{children:"-f, --inactive INACTIVE \u7528\u6237\u8FC7\u671F\u540E\uFF0C\u8BA9\u5BC6\u7801\u65E0\u6548"}),"\n",(0,l.jsx)(n.li,{children:"-g, --gid GROUP \u4F7F\u7528\u6237\u53EA\u5C5E\u4E8E\u67D0\u4E2A\u7EC4"}),"\n",(0,l.jsx)(n.li,{children:"-G, --groups GROUPS \u4F7F\u7528\u6237\u52A0\u5165\u67D0\u4E2A\u7EC4(\u9644\u8BBE\u7EC4)"}),"\n",(0,l.jsx)(n.li,{children:"-h, --help \u5E2E\u52A9"}),"\n",(0,l.jsx)(n.li,{children:"-k, --skel SKEL_DIR \u6307\u5B9A\u5176\u4ED6\u7684 skel \u76EE\u5F55"}),"\n",(0,l.jsx)(n.li,{children:"-K, --key KEY=VALUE \u8986\u76D6 /etc/login.defs \u914D\u7F6E\u6587\u4EF6"}),"\n",(0,l.jsx)(n.li,{children:"-m, --create-home \u81EA\u52A8\u521B\u5EFA\u767B\u5F55\u76EE\u5F55"}),"\n",(0,l.jsx)(n.li,{children:"-l, \u4E0D\u628A\u7528\u6237\u52A0\u5165\u5230 lastlog \u6587\u4EF6\u4E2D"}),"\n",(0,l.jsx)(n.li,{children:"-M, \u4E0D\u81EA\u52A8\u521B\u5EFA\u767B\u5F55\u76EE\u5F55"}),"\n",(0,l.jsx)(n.li,{children:"-r, \u5EFA\u7ACB\u7CFB\u7EDF\u8D26\u53F7"}),"\n",(0,l.jsx)(n.li,{children:"-o, --non-unique \u5141\u8BB8\u7528\u6237\u62E5\u6709\u76F8\u540C\u7684 UID"}),"\n",(0,l.jsx)(n.li,{children:"-p, --password PASSWORD \u4E3A\u65B0\u7528\u6237\u4F7F\u7528\u52A0\u5BC6\u5BC6\u7801"}),"\n",(0,l.jsx)(n.li,{children:"-s, --shell SHELL \u767B\u5F55\u65F6\u5019\u7684 shell"}),"\n",(0,l.jsx)(n.li,{children:"-u, --uid UID \u4E3A\u65B0\u7528\u6237\u6307\u5B9A\u4E00\u4E2A UID"}),"\n",(0,l.jsx)(n.li,{children:"-Z, --selinux-user SEUSER use a specific SEUSER for the SELinux user mapping"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"useradd -s bash -m testUser\npasswd testUser # modify `/etc/passwd`, then add to `/etc/sudoers`\n\nuseradd -s /sbin/nologin username\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"adduser"})," is a perl script which uses ",(0,l.jsx)(n.code,{children:"useradd"})," binary in back-end,\n",(0,l.jsx)(n.code,{children:"adduser"})," is more user friendly and interactive."]}),"\n",(0,l.jsx)(n.h3,{id:"\u4FEE\u6539\u7528\u6237",children:"\u4FEE\u6539\u7528\u6237"}),"\n",(0,l.jsx)(n.p,{children:"usermod -d /home/test -G test2 test"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"-l \u65B0\u7528\u6237\u540D \u65E7\u7528\u6237\u540D \u4FEE\u6539\u7528\u6237\u540D"}),"\n",(0,l.jsx)(n.li,{children:"-g \u65B0\u7528\u6237\u7EC4 \u76EE\u6807\u7528\u6237 \u6539\u53D8\u7528\u6237\u6240\u5C5E\u7EC4"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"gpasswd -a test test2 \u5C06\u7528\u6237 test \u52A0\u5165\u5230 test2 \u7EC4(\u9644\u8BBE\u7EC4)"}),"\n",(0,l.jsx)(n.p,{children:"gpasswd -d test test2 \u5C06\u7528\u6237 test \u4ECE test2 \u7EC4\u4E2D\u79FB\u51FA"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"usermod -aG sudo <username>\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u5220\u9664\u7528\u6237",children:"\u5220\u9664\u7528\u6237"}),"\n",(0,l.jsx)(n.p,{children:"userdel test -r \u540C\u65F6\u5220\u9664\u7528\u6237\u767B\u5F55\u76EE\u5F55(/home/xxx)"}),"\n",(0,l.jsx)(n.h3,{id:"\u67E5\u770B\u7528\u6237",children:"\u67E5\u770B\u7528\u6237"}),"\n",(0,l.jsx)(n.p,{children:"w/who \u67E5\u770B\u5F53\u524D\u767B\u5F55\u7684\u6240\u6709\u7528\u6237"}),"\n",(0,l.jsx)(n.p,{children:"whoami \u67E5\u770B\u5F53\u524D\u767B\u5F55\u7528\u6237\u540D"}),"\n",(0,l.jsx)(n.p,{children:"finger apacheUser \u67E5\u770B\u5355\u4E2A\u7528\u6237\u4FE1\u606F"}),"\n",(0,l.jsx)(n.h3,{id:"\u9650\u5236\u7528\u6237",children:"\u9650\u5236\u7528\u6237"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"passwd -l \u7528\u6237\u540D \u9501\u5B9A\u7528\u6237"}),"\n",(0,l.jsx)(n.li,{children:"passwd -u \u7528\u6237\u540D \u89E3\u9501\u7528\u6237"}),"\n",(0,l.jsx)(n.li,{children:"passwd -d \u7528\u6237\u540D \u6E05\u9664\u7528\u6237\u5BC6\u7801"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"\u767B\u5F55\u5931\u8D25\u9501\u5B9A",children:"\u767B\u5F55\u5931\u8D25\u9501\u5B9A"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"faillock --user username           # \u67E5\u770B\u7528\u6237\u5931\u8D25\u767B\u5F55\u8BB0\u5F55\nfaillock --reset --user username   # \u91CD\u7F6E\u7528\u6237\u5931\u8D25\u767B\u5F55\u8BA1\u6570\n"})}),"\n",(0,l.jsx)(n.h2,{id:"common-privilege",children:"Common Privilege"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"chown \u7528\u6237\u540D\uFF1A\u7EC4\u540D \u6587\u4EF6\u540D"}),"\n",(0,l.jsx)(n.li,{children:"chgrp \u7EC4\u540D \u6587\u4EF6\u540D"}),"\n",(0,l.jsx)(n.li,{children:"umask \u5B58\u50A8\u4F4D\u7F6E \u2014\u2014/etc/profile"}),"\n",(0,l.jsx)(n.li,{children:"\u6587\u4EF6\u9ED8\u8BA4\u6743\u9650 = \u6587\u4EF6\u9ED8\u8BA4\u6700\u5927\u6743\u9650 rw-(666) \u51CF\u53BB umask \u503C(\u5982----w--w-)(022)"}),"\n",(0,l.jsx)(n.li,{children:"\u76EE\u5F55\u9ED8\u8BA4\u6743\u9650 = \u76EE\u5F55\u9ED8\u8BA4\u6700\u5927\u6743\u9650 rwx(777) \u51CF\u53BB umask \u503C"}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"id <username>"})}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"acl-privilege",children:"ACL Privilege"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"\u67E5\u770B\u5206\u533A ACL \u6743\u9650\u662F\u5426\u5F00\u542F dumpe2fs -h \u8BBE\u5907\u5206\u533A\u540D"}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"\u4E34\u65F6\u5F00\u542F\u5206\u533A ACL \u6743\u9650 mount -o remount,acl \u8BBE\u5907\u5206\u533A\u540D"}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"\u6C38\u4E45\u5F00\u542F\u5206\u533A ACL \u6743\u9650 /etc/fstab"}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"setfacl -m (d:\u9ED8\u8BA4\u6743\u9650) u/g:\u7528\u6237\u540D/\u7EC4\u540D:\u6743\u9650(rwx) \u6587\u4EF6\u540D"}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"getfacl \u6587\u4EF6\u540D\u2014\u2014\u67E5\u770B\u6587\u4EF6 ACL \u6743\u9650"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"sudo-privilege",children:"Sudo Privilege"}),"\n",(0,l.jsx)(n.p,{children:"/etc/sudoers.tmp"}),"\n",(0,l.jsx)(n.h2,{id:"setuid-and-setgid",children:"SetUID and SetGID"}),"\n",(0,l.jsx)(n.p,{children:"\u53EF\u6267\u884C\u7A0B\u5E8F/\u76EE\u5F55+\u666E\u901A\u7528\u6237\u4E34\u65F6\u83B7\u5F97 root \u6743\u9650 \uFF08rws\uFF09:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"chmod 0xxx \u53D6\u6D88\u53CC\u6743\u9650"}),"\n",(0,l.jsx)(n.li,{children:"chmod 2xxx \u8BBE\u7F6E SetGID \u6743\u9650"}),"\n",(0,l.jsx)(n.li,{children:"chmod 4xxx \u8BBE\u7F6E SetUID \u6743\u9650"}),"\n",(0,l.jsx)(n.li,{children:"chmod 6xxx \u8BBE\u7F6E\u53CC\u6743\u9650"}),"\n"]})]})}function o(e={}){let{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(h,{...e})}):h(e)}},30416(e,n,i){i.d(n,{R:()=>d,x:()=>a});var s=i(59471);let l={},r=s.createContext(l);function d(e){let n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:d(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);