"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([["3139"],{41023(e,n,t){t.r(n),t.d(n,{metadata:()=>i,default:()=>p,frontMatter:()=>o,contentTitle:()=>d,toc:()=>l,assets:()=>c});var i=JSON.parse('{"id":"web/vue/options","title":"Options","description":"Parent component options:","source":"@site/content/web/vue/options.md","sourceDirName":"web/vue","slug":"/web/vue/options","permalink":"/notes/web/vue/options","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/web/vue/options.md","tags":[{"inline":true,"label":"Web","permalink":"/notes/tags/web"},{"inline":true,"label":"Vue","permalink":"/notes/tags/vue"},{"inline":true,"label":"Internals","permalink":"/notes/tags/internals"},{"inline":true,"label":"Options","permalink":"/notes/tags/options"}],"version":"current","lastUpdatedBy":"Sabertaz","lastUpdatedAt":1769518084000,"sidebarPosition":22,"frontMatter":{"tags":["Web","Vue","Internals","Options"],"sidebar_position":22},"sidebar":"tutorialSidebar","previous":{"title":"Core","permalink":"/notes/web/vue/architecture"},"next":{"title":"Lifecycle","permalink":"/notes/web/vue/lifecycle"}}'),s=t(62615),r=t(30416);let o={tags:["Web","Vue","Internals","Options"],sidebar_position:22},d="Options",c={},l=[{value:"Merge",id:"merge",level:2},{value:"Normalize",id:"normalize",level:2}];function a(e){let n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"options",children:"Options"})}),"\n",(0,s.jsx)(n.p,{children:"Parent component options:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"vm.$options = {\n  components: {\n    KeepAlive,\n    Transition,\n    TransitionGroup,\n    ...UserRegisterComponents,\n  },\n  created: [\n    function created() {\n      console.log('parent created')\n    },\n  ],\n  directives: {\n    model,\n    show,\n    ...userCustomDirectives,\n  },\n  filters: {},\n  _base: function Vue(options) {},\n  el: '#app',\n  render: function _render(h) {},\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"Children component options:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"vm.$options = {\n  parent: Vue /* \u7236Vue\u5B9E\u4F8B */,\n  propsData: undefined,\n  _componentTag: undefined,\n  _parentVnode: VNode /* \u7236VNode\u5B9E\u4F8B */,\n  _renderChildren: undefined,\n  __proto__: {\n    components: {\n      KeepAlive,\n      Transition,\n      TransitionGroup,\n      ...UserRegisterComponents,\n    },\n    directives: {\n      model,\n      show,\n      ...userCustomDirectives,\n    },\n    filters: {},\n    _base: function Vue(options) {},\n  },\n  created: [\n    function created() {\n      console.log('parent created')\n    },\n    function created() {\n      console.log('child created')\n    },\n  ],\n  directives: {\n    model,\n    show,\n    ...userCustomDirectives,\n  },\n  filters: {},\n  _base: function Vue(options) {},\n  el: '#app',\n  render: function _render(h) {},\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"core/instance/state.js/initProps()"}),": ",(0,s.jsx)(n.code,{children:"this.XXX"})," -> ",(0,s.jsx)(n.code,{children:"this._props.XXX"}),".\n",(0,s.jsx)(n.code,{children:"core/instance/state.js/initData()"}),": ",(0,s.jsx)(n.code,{children:"this.XXX"})," -> ",(0,s.jsx)(n.code,{children:"this._data.XXX"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"merge",children:"Merge"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"mergeOptions"})," (",(0,s.jsx)(n.code,{children:"core/util/options.js"}),"):"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u5BF9\u4E8E ",(0,s.jsx)(n.code,{children:"el"}),"/",(0,s.jsx)(n.code,{children:"propsData"})," \u9009\u9879\u4F7F\u7528\u9ED8\u8BA4\u7684\u5408\u5E76\u7B56\u7565 ",(0,s.jsx)(n.code,{children:"defaultStrategy"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["\u5BF9\u4E8E ",(0,s.jsx)(n.code,{children:"data"})," \u9009\u9879, \u4F7F\u7528 ",(0,s.jsx)(n.code,{children:"mergeDataOrFn"})," \u51FD\u6570\u8FDB\u884C\u5904\u7406, \u6700\u7EC8\u7ED3\u679C\u662F ",(0,s.jsx)(n.code,{children:"data"})," \u9009\u9879\u5C06\u53D8\u6210\u4E00\u4E2A\u51FD\u6570, \u4E14\u8BE5\u51FD\u6570\u7684\u6267\u884C\u7ED3\u679C\u4E3A\u771F\u6B63\u7684\u6570\u636E\u5BF9\u8C61."]}),"\n",(0,s.jsx)(n.li,{children:"\u5BF9\u4E8E\u751F\u547D\u5468\u671F\u94A9\u5B50\u9009\u9879, \u5C06\u5408\u5E76\u6210\u6570\u7EC4, \u4F7F\u5F97\u7236\u5B50\u9009\u9879\u4E2D\u7684\u94A9\u5B50\u51FD\u6570\u90FD\u80FD\u591F\u88AB\u6267\u884C."}),"\n",(0,s.jsxs)(n.li,{children:["\u5BF9\u4E8E ",(0,s.jsx)(n.code,{children:"directives"}),"/",(0,s.jsx)(n.code,{children:"filters"})," \u4EE5\u53CA ",(0,s.jsx)(n.code,{children:"components"})," \u7B49\u8D44\u6E90\u9009\u9879,\n\u7236\u5B50\u9009\u9879\u5C06\u4EE5\u539F\u578B\u94FE\u7684\u5F62\u5F0F\u88AB\u5904\u7406, \u6B63\u662F\u56E0\u4E3A\u8FD9\u6837\u6211\u4EEC\u624D\u80FD\u591F\u5728\u4EFB\u4F55\u5730\u65B9\u90FD\u4F7F\u7528\u5185\u7F6E\u7EC4\u4EF6\u6216\u6307\u4EE4\u7B49."]}),"\n",(0,s.jsxs)(n.li,{children:["\u5BF9\u4E8E ",(0,s.jsx)(n.code,{children:"watch"})," \u9009\u9879\u7684\u5408\u5E76\u5904\u7406, \u7C7B\u4F3C\u4E8E\u751F\u547D\u5468\u671F\u94A9\u5B50, \u5982\u679C\u7236\u5B50\u9009\u9879\u90FD\u6709\u76F8\u540C\u7684\u89C2\u6D4B\u5B57\u6BB5, \u5C06\u88AB\u5408\u5E76\u4E3A\u6570\u7EC4, \u8FD9\u6837\u89C2\u5BDF\u8005\u90FD\u5C06\u88AB\u6267\u884C."]}),"\n",(0,s.jsxs)(n.li,{children:["\u5BF9\u4E8E ",(0,s.jsx)(n.code,{children:"props"}),"/",(0,s.jsx)(n.code,{children:"methods"}),"/",(0,s.jsx)(n.code,{children:"inject"}),"/",(0,s.jsx)(n.code,{children:"computed"})," \u9009\u9879, \u7236\u5B50\u9009\u9879\u59CB\u7EC8\u53EF\u7528, \u4F46\u662F\u5B50\u9009\u9879\u4F1A\u8986\u76D6\u540C\u540D\u7684\u7236\u9009\u9879\u5B57\u6BB5\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:["\u5BF9\u4E8E ",(0,s.jsx)(n.code,{children:"provide"})," \u9009\u9879, \u5176\u5408\u5E76\u7B56\u7565\u4F7F\u7528\u4E0E ",(0,s.jsx)(n.code,{children:"data"})," \u9009\u9879\u76F8\u540C\u7684 ",(0,s.jsx)(n.code,{children:"mergeDataOrFn"})," \u51FD\u6570\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:["\u6700\u540E, \u4EE5\u4E0A\u6CA1\u6709\u63D0\u53CA\u5230\u7684\u9009\u9879\u90FD\u5C06\u4F7F\u9ED8\u8BA4\u9009\u9879 ",(0,s.jsx)(n.code,{children:"defaultStrategy"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["\u6700\u6700\u540E, \u9ED8\u8BA4\u8BA4\u5408\u5E76\u7B56\u7565\u51FD\u6570 ",(0,s.jsx)(n.code,{children:"defaultStrategy"})," \u7684\u7B56\u7565\u662F: \u53EA\u8981\u5B50\u9009\u9879\u4E0D\u662F ",(0,s.jsx)(n.code,{children:"undefined"})," \u5C31\u4F7F\u7528\u5B50\u9009\u9879, \u5426\u5219\u4F7F\u7528\u7236\u9009\u9879\u3002"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"/**\n * Merge two option objects into a new one.\n * Core utility used in both instantiation and inheritance.\n */\nexport function mergeOptions(\n  parent: object,\n  child: object,\n  vm?: Component\n): object {\n  if (typeof child === 'function')\n    child = child.options\n\n  normalizeProps(child, vm)\n  normalizeInject(child, vm)\n  normalizeDirectives(child)\n\n  const extendsFrom = child.extends\n\n  if (extendsFrom)\n    parent = mergeOptions(parent, extendsFrom, vm)\n\n  if (child.mixins) {\n    for (let i = 0, l = child.mixins.length; i < l; i++)\n      parent = mergeOptions(parent, child.mixins[i], vm)\n  }\n\n  const options = {}\n  let key\n\n  for (key in parent) mergeField(key)\n\n  for (key in child) {\n    if (!hasOwn(parent, key))\n      mergeField(key)\n  }\n\n  return options\n}\n\nfunction mergeField(key) {\n  const strategy = strategies[key] || defaultStrategy\n  options[key] = strategy(parent[key], child[key], vm, key)\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"normalize",children:"Normalize"}),"\n",(0,s.jsx)(n.p,{children:"Props:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"export default {\n  props: {\n    someData1: {\n      type: Number,\n    },\n    someData2: {\n      type: String,\n      default: '',\n    },\n  },\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"Injects:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"export default {\n  inject: {\n    data1: { from: 'data1' },\n    d2: { from: 'data2' },\n    data3: { from: 'data3', someProperty: 'someValue' },\n  },\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"Directives:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"for (const key in dirs) {\n  const def = dirs[key]\n  if (typeof def === 'function')\n    dirs[key] = { bind: def, update: def }\n}\n"})})]})}function p(e={}){let{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},30416(e,n,t){t.d(n,{R:()=>o,x:()=>d});var i=t(59471);let s={},r=i.createContext(s);function o(e){let n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);