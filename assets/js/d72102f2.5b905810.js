"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([["4470"],{75066(e,n,t){t.r(n),t.d(n,{metadata:()=>l,default:()=>h,frontMatter:()=>i,contentTitle:()=>r,toc:()=>o,assets:()=>c});var l=JSON.parse('{"id":"web/javascript/dom","title":"DOM","description":"- DOM Level 0.","source":"@site/content/web/javascript/dom.md","sourceDirName":"web/javascript","slug":"/web/javascript/dom","permalink":"/notes/web/javascript/dom","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/web/javascript/dom.md","tags":[{"inline":true,"label":"Web","permalink":"/notes/tags/web"},{"inline":true,"label":"JavaScript","permalink":"/notes/tags/java-script"},{"inline":true,"label":"ECMAScript","permalink":"/notes/tags/ecma-script"},{"inline":true,"label":"DOM","permalink":"/notes/tags/dom"}],"version":"current","lastUpdatedBy":"Sabertaz","lastUpdatedAt":1769518084000,"sidebarPosition":32,"frontMatter":{"sidebar_position":32,"tags":["Web","JavaScript","ECMAScript","DOM"]},"sidebar":"tutorialSidebar","previous":{"title":"BOM","permalink":"/notes/web/javascript/bom"},"next":{"title":"CSSOM","permalink":"/notes/web/javascript/cssom"}}'),s=t(62615),d=t(30416);let i={sidebar_position:32,tags:["Web","JavaScript","ECMAScript","DOM"]},r="DOM",c={},o=[{value:"Nodes",id:"nodes",level:2},{value:"Node Type",id:"node-type",level:3},{value:"Attribute",id:"attribute",level:3},{value:"Text",id:"text",level:3},{value:"Document",id:"document",level:3},{value:"Document Type",id:"document-type",level:3},{value:"Document Fragment",id:"document-fragment",level:3},{value:"Manipulation",id:"manipulation",level:2},{value:"Append",id:"append",level:3},{value:"Insert",id:"insert",level:3},{value:"Replace",id:"replace",level:3},{value:"Remove",id:"remove",level:3},{value:"Traverse",id:"traverse",level:3},{value:"Attributes",id:"attributes",level:3},{value:"Select",id:"select",level:3},{value:"Geometry",id:"geometry",level:2},{value:"Dimensions",id:"dimensions",level:3},{value:"Position",id:"position",level:3},{value:"Scrolling",id:"scrolling",level:3},{value:"Loading",id:"loading",level:2},{value:"Dynamic Scripts",id:"dynamic-scripts",level:3},{value:"Dynamic Styles",id:"dynamic-styles",level:3},{value:"XML Namespace",id:"xml-namespace",level:2}];function a(e){let n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"dom",children:"DOM"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"DOM Level 0."}),"\n",(0,s.jsxs)(n.li,{children:["DOM Level 1:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"DOM Core."}),"\n",(0,s.jsx)(n.li,{children:"DOM XML."}),"\n",(0,s.jsx)(n.li,{children:"DOM HTML."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["DOM Level 2:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"DOM2 Core."}),"\n",(0,s.jsx)(n.li,{children:"DOM2 XML."}),"\n",(0,s.jsx)(n.li,{children:"DOM2 HTML."}),"\n",(0,s.jsx)(n.li,{children:"DOM2 Views."}),"\n",(0,s.jsx)(n.li,{children:"DOM2 StyleSheets."}),"\n",(0,s.jsx)(n.li,{children:"DOM2 CSS."}),"\n",(0,s.jsx)(n.li,{children:"DOM2 CSS 2."}),"\n",(0,s.jsx)(n.li,{children:"DOM2 Events."}),"\n",(0,s.jsx)(n.li,{children:"DOM2 UIEvents."}),"\n",(0,s.jsx)(n.li,{children:"DOM2 MouseEvents."}),"\n",(0,s.jsx)(n.li,{children:"DOM2 MutationEvents (Deprecated)."}),"\n",(0,s.jsx)(n.li,{children:"DOM2 HTMLEvents."}),"\n",(0,s.jsx)(n.li,{children:"DOM2 Range."}),"\n",(0,s.jsx)(n.li,{children:"DOM2 Traversal."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["DOM Level 3:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"DOM3 Core."}),"\n",(0,s.jsx)(n.li,{children:"DOM3 XML."}),"\n",(0,s.jsx)(n.li,{children:"DOM3 Events."}),"\n",(0,s.jsx)(n.li,{children:"DOM3 UIEvents."}),"\n",(0,s.jsx)(n.li,{children:"DOM3 MouseEvents."}),"\n",(0,s.jsx)(n.li,{children:"DOM3 MutationEvents (Deprecated)."}),"\n",(0,s.jsx)(n.li,{children:"DOM3 MutationNameEvents."}),"\n",(0,s.jsx)(n.li,{children:"DOM3 TextEvents."}),"\n",(0,s.jsx)(n.li,{children:"DOM3 Load and Save."}),"\n",(0,s.jsx)(n.li,{children:"DOM3 Load and Save Async."}),"\n",(0,s.jsx)(n.li,{children:"DOM3 Validation."}),"\n",(0,s.jsx)(n.li,{children:"DOM3 XPath."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const hasXmlDom = document.implementation.hasFeature('XML', '1.0')\nconst hasHtmlDom = document.implementation.hasFeature('HTML', '1.0')\n"})}),"\n",(0,s.jsx)(n.h2,{id:"nodes",children:"Nodes"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"document.createElement('nodeName')\ndocument.createTextNode('String')\n\ndocument.getElementById(id)\ndocument.getElementsByName(elementName)\ndocument.getElementsByTagName(tagName)\ndocument.getElementsByClassName(className) // HTML5\ndocument.querySelector(cssSelector) // Selectors API\ndocument.querySelectorAll(cssSelector) // Selectors API\n\nelement.getAttribute(attrName) // get default HTML attribute\nelement.setAttribute(attrName, attrValue)\nelement.removeAttribute(attrName)\n\nelement.compareDocumentPosition(element)\nelement.contains(element)\nelement.isSameNode(element) // Same node reference\nelement.isEqualNode(element) // Same nodeName/nodeValue/attributes/childNodes\nelement.matches(cssSelector)\nelement.closest(cssSelector) // Returns closest ancestor matching selector\nelement.cloneNode()\nelement.normalize()\nelement.before(...elements)\nelement.after(...elements)\nelement.replaceWith(...elements)\nelement.remove()\n\nparentElement.hasChildNodes()\nparentElement.appendChild(childElement)\nparentElement.append(childElements)\nparentElement.insertBefore(newChild, targetChild)\nparentElement.replaceChild(newChild, targetChild)\nparentElement.replaceChildren(children)\nparentElement.removeChild(child)\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"function showAlert(type, message, duration = 3) {\n  const div = document.createElement('div')\n  div.className = type\n  div.appendChild(document.createTextNode(message))\n  container.insertBefore(div, form)\n  setTimeout(() => div.remove(), duration * 1000)\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"node-type",children:"Node Type"}),"\n",(0,s.jsxs)(n.p,{children:["Node \u9664\u5305\u62EC\u5143\u7D20\u7ED3\u70B9 (tag) \u5916,\n\u5305\u62EC\u8BB8\u591A\u5176\u5B83\u7ED3\u70B9 (\u751A\u81F3\u7A7A\u683C\u7B26\u89C6\u4F5C\u4E00\u4E2A\u7ED3\u70B9),\n\u9700\u501F\u52A9 ",(0,s.jsx)(n.code,{children:"nodeType"})," \u627E\u51FA\u76EE\u6807\u7ED3\u70B9."]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"Node Type"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"Node Representation"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"Node Name"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"Node Value"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"1"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"ELEMENT_NODE"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Tag Name"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"null"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"2"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"ATTRIBUTE_NODE"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Attr Name"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Attr Value"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"3"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"TEXT_NODE"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"#text"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Text"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"4"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"CDATA_SECTION_NODE"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"#cdata-section"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"CDATA Section"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"5"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"ENTITY_REFERENCE_NODE"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"}}),(0,s.jsx)(n.td,{style:{textAlign:"left"}})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"6"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"ENTITY_NODE"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"}}),(0,s.jsx)(n.td,{style:{textAlign:"left"}})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"8"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"COMMENT_NODE"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"#comment"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Comment"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"9"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"DOCUMENT_NODE"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"#document"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"null"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"10"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"DOCUMENT_TYPE_NODE"})}),(0,s.jsxs)(n.td,{style:{textAlign:"left"},children:[(0,s.jsx)(n.code,{children:"html"}),"/",(0,s.jsx)(n.code,{children:"xml"})]}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"null"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"11"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"DOCUMENT_FRAGMENT_NODE"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"#document-fragment"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"null"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"12"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"NOTATION_NODE"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"}}),(0,s.jsx)(n.td,{style:{textAlign:"left"}})]})]})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const type = node.nodeType\nconst name = node.nodeName\nconst value = node.nodeValue\n\nif (someNode.nodeType === Node.ELEMENT_NODE)\n  alert('Node is an element.')\n"})}),"\n",(0,s.jsx)(n.h3,{id:"attribute",children:"Attribute"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const id = element.attributes.getNamedItem('id').nodeValue\nconst id = element.attributes.id.nodeValue\nelement.attributes.id.nodeValue = 'someOtherId'\nconst oldAttr = element.attributes.removeNamedItem('id')\nelement.attributes.setNamedItem(newAttr)\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const attr = document.createAttribute('align')\nattr.value = 'left'\nelement.setAttributeNode(attr)\n\nalert(element.attributes.align.value) // \"left\"\nalert(element.getAttributeNode('align').value) // \"left\"\nalert(element.getAttribute('align')) // \"left\"\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Further reading:\n",(0,s.jsx)(n.a,{href:"/notes/web/html/attributes#reflection",children:"DOM properties reflection on HTML attributes"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"text",children:"Text"}),"\n",(0,s.jsx)(n.p,{children:"Text node methods:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"appendData(text): \u5411\u8282\u70B9\u672B\u5C3E\u6DFB\u52A0\u6587\u672C text."}),"\n",(0,s.jsx)(n.li,{children:"deleteData(offset, count): \u4ECE\u4F4D\u7F6E offset \u5F00\u59CB\u5220\u9664 count \u4E2A\u5B57\u7B26."}),"\n",(0,s.jsx)(n.li,{children:"insertData(offset, text): \u5728\u4F4D\u7F6E offset \u63D2\u5165 text."}),"\n",(0,s.jsx)(n.li,{children:"replaceData(offset, count, text): \u7528 text \u66FF\u6362\u4ECE\u4F4D\u7F6E offset \u5230 offset + count \u7684\u6587\u672C."}),"\n",(0,s.jsx)(n.li,{children:"splitText(offset): \u5728\u4F4D\u7F6E offset \u5C06\u5F53\u524D\u6587\u672C\u8282\u70B9\u62C6\u5206\u4E3A\u4E24\u4E2A\u6587\u672C\u8282\u70B9."}),"\n",(0,s.jsx)(n.li,{children:"substringData(offset, count): \u63D0\u53D6\u4ECE\u4F4D\u7F6E offset \u5230 offset + count \u7684\u6587\u672C."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Normalize text nodes:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const element = document.createElement('div')\nelement.className = 'message'\n\nconst textNode = document.createTextNode('Hello world!')\nconst anotherTextNode = document.createTextNode('Yippee!')\n\nelement.appendChild(textNode)\nelement.appendChild(anotherTextNode)\ndocument.body.appendChild(element)\nalert(element.childNodes.length) // 2\n\nelement.normalize()\nalert(element.childNodes.length) // 1\nalert(element.firstChild.nodeValue) // \"Hello world!Yippee!\"\n"})}),"\n",(0,s.jsx)(n.p,{children:"Split text nodes:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const element = document.createElement('div')\nelement.className = 'message'\n\nconst textNode = document.createTextNode('Hello world!')\nelement.appendChild(textNode)\ndocument.body.appendChild(element)\n\nconst newNode = element.firstChild.splitText(5)\nalert(element.firstChild.nodeValue) // \"Hello\"\nalert(newNode.nodeValue) // \" world!\"\nalert(element.childNodes.length) // 2\n"})}),"\n",(0,s.jsxs)(n.admonition,{title:"TextContent vs InnerText vs InnerHTML",type:"tip",children:[(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"textContent"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Security"}),": Doesn\u2019t parse HTML."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Performance"}),": Including ",(0,s.jsx)(n.code,{children:"<script>"})," and ",(0,s.jsx)(n.code,{children:"<style>"})," text content."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"innerText"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Doesn't parse HTML."}),"\n",(0,s.jsxs)(n.li,{children:["Only show ",(0,s.jsx)(n.strong,{children:"human-readable"})," text content"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"innerText"})," care CSS styles, read ",(0,s.jsx)(n.code,{children:"innerText"})," value will trigger ",(0,s.jsx)(n.code,{children:"reflow"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"innerHTML"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Do parse HTML."}),"\n"]}),"\n"]}),"\n"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const textContent = element.textContent\nconst innerHTML = element.innerHTML\n// eslint-disable-next-line unicorn/prefer-dom-node-text-content -- API example\nconst innerText = element.innerText\n"})})]}),"\n",(0,s.jsx)(n.h3,{id:"document",children:"Document"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"document"})," node (",(0,s.jsx)(n.code,{children:"#document"}),"):"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'alert(document.nodeType) // 9\nalert(document.nodeName) // "#document"\nalert(document.nodeValue) // null\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const html = document.documentElement\nconst doctype = document.doctype\nconst head = document.head // HTML5 head.\nconst body = document.body\n\nconst title = document.title // \u53EF\u4FEE\u6539.\nconst domain = document.domain // \u53EF\u8BBE\u7F6E\u540C\u6E90\u57DF\u540D.\nconst url = document.URL\nconst referer = document.referer\nconst charSet = document.characterSet // HTML5 characterSet.\n\nconst anchors = documents.anchors\nconst images = documents.images\nconst links = documents.links\nconst forms = documents.forms\nconst formElements = documents.forms[0].elements // \u7B2C\u4E00\u4E2A\u8868\u5355\u5185\u7684\u6240\u6709\u5B57\u6BB5\n\n// HTML5 compatMode:\nif (document.compatMode === 'CSS1Compat')\n  console.log('Standards mode')\nelse if (document.compatMode === 'BackCompat')\n  console.log('Quirks mode')\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"document.getElementById(id)\n\ndocument.getElementsByName(name)\ndocument.getElementsByTagName(tagName)\ndocument.getElementsByClassName(className) // HTML5\ndocument.querySelector(cssSelector) // Selectors API\ndocument.querySelectorAll(cssSelector) // Selectors API\ndocument.write()\ndocument.writeln()\n"})}),"\n",(0,s.jsx)(n.h3,{id:"document-type",children:"Document Type"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'<!DOCTYPE html PUBLIC "-// W3C// DTD HTML 4.01// EN" "http:// www.w3.org/TR/html4/strict.dtd">\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"console.log(document.doctype.name) // \"html\"\nconsole.log(document.nodeType) // 10\nconsole.log(document.doctype.nodeName) // \"html\"\nconsole.log(document.doctype.nodeValue) // null\nconsole.log(document.doctype.publicId) // \"-// W3C// DTD HTML 4.01// EN\"\nconsole.log(document.doctype.systemId) // \"http://www.w3.org/TR/html4/strict.dtd\"\n\nconst doctype = document.implementation.createDocumentType(\n  'html',\n  '-// W3C// DTD HTML 4.01// EN',\n  'http://www.w3.org/TR/html4/strict.dtd'\n)\nconst doc = document.implementation.createDocument(\n  'http://www.w3.org/1999/xhtml',\n  'html',\n  doctype\n)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"document-fragment",children:"Document Fragment"}),"\n",(0,s.jsx)(n.p,{children:"\u51CF\u5C11 DOM \u64CD\u4F5C\u6B21\u6570, \u51CF\u5C11\u9875\u9762\u6E32\u67D3\u6B21\u6570:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const frag = document.createDocumentFragment()\n\nlet p\nlet t\n\np = document.createElement('p')\nt = document.createTextNode('first paragraph')\np.appendChild(t)\nfrag.appendChild(p)\n\np = document.createElement('p')\nt = document.createTextNode('second paragraph')\np.appendChild(t)\nfrag.appendChild(p)\n\n// \u53EA\u6E32\u67D3\u4E00\u6B21HTML\u9875\u9762\ndocument.body.appendChild(frag)\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u514B\u9686\u8282\u70B9\u8FDB\u884C\u5904\u7406, \u5904\u7406\u5B8C\u6BD5\u540E\u518D\u66FF\u6362\u539F\u8282\u70B9:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const oldNode = document.getElementById('result')\nconst clone = oldNode.cloneNode(true)\n// work with the clone\n\n// when you're done:\noldNode.parentNode.replaceChild(clone, oldNode)\n"})}),"\n",(0,s.jsx)(n.p,{children:"Parse HTML:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const range = document.createRange()\nconst parse = range.createContextualFragment.bind(range)\n\nparse(`<ol>\n  <li>a</li>\n  <li>b</li>\n</ol>\n<ol>\n  <li>c</li>\n  <li>d</li>\n</ol>`)\n\nfunction parseHTML(string) {\n  const context = document.implementation.createHTMLDocument()\n\n  // Set the base href for the created document so any parsed elements with URLs\n  // are based on the document's URL\n  const base = context.createElement('base')\n  base.href = document.location.href\n  context.head.appendChild(base)\n\n  context.body.innerHTML = string\n  return context.body.children\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"manipulation",children:"Manipulation"}),"\n",(0,s.jsx)(n.h3,{id:"append",children:"Append"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Method"}),(0,s.jsx)(n.th,{children:"Node"}),(0,s.jsx)(n.th,{children:"HTML"}),(0,s.jsx)(n.th,{children:"Text"}),(0,s.jsx)(n.th,{children:"IE"}),(0,s.jsx)(n.th,{children:"Event Listeners"}),(0,s.jsx)(n.th,{children:"Secure"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"append"}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Preserves"}),(0,s.jsx)(n.td,{children:"Yes"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"appendChild"}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Preserves"}),(0,s.jsx)(n.td,{children:"Yes"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"innerHTML"}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Loses"}),(0,s.jsx)(n.td,{children:"Careful"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"insertAdjacentHTML"}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"Preserves"}),(0,s.jsx)(n.td,{children:"Careful"})]})]})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const testDiv = document.getElementById('testDiv')\n\nconst para = document.createElement('p')\ntestDiv.appendChild(para)\n\nconst txt = document.createTextNode('Hello World')\npara.appendChild(txt)\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"innerHTML"}),": non-concrete, including all types of childNodes:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"div.innerHTML = '<p>Test<em>test</em>Test.</p>'\n// <div>\n//   <p>Test<em>test</em>Test.</p>\n// </div>\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"innerHTML"})," performance:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// BAD\nfor (const value of values)\n  ul.innerHTML += `<li>${value}</li>` // \u522B\u8FD9\u6837\u505A\uFF01\n\n// GOOD\nlet itemsHtml = ''\nfor (const value of values)\n  itemsHtml += `<li>${value}</li>`\n\nul.innerHTML = itemsHtml\n\n// BEST\nul.innerHTML = values.map(value => `<li>${value}</li>`).join('')\n"})}),"\n",(0,s.jsx)(n.h3,{id:"insert",children:"Insert"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// Append\nel.appendChild(newEl)\n\n// Prepend\nel.insertBefore(newEl, el.firstChild)\n\n// InsertBefore\nel.parentNode.insertBefore(newEl, el)\n\n// InsertAfter\nfunction insertAfter(newElement, targetElement) {\n  const parent = targetElement.parentNode\n\n  if (parent.lastChild === targetElement)\n    parent.appendChild(newElement)\n  else\n    parent.insertBefore(newElement, targetElement.nextSibling)\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"insertAdjacentHTML"}),"/",(0,s.jsx)(n.code,{children:"insertAdjacentText"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"beforebegin: \u63D2\u5165\u524D\u4E00\u4E2A\u5144\u5F1F\u8282\u70B9."}),"\n",(0,s.jsx)(n.li,{children:"afterbegin: \u63D2\u5165\u7B2C\u4E00\u4E2A\u5B50\u8282\u70B9."}),"\n",(0,s.jsx)(n.li,{children:"beforeend: \u63D2\u5165\u6700\u540E\u4E00\u4E2A\u5B50\u8282\u70B9."}),"\n",(0,s.jsx)(n.li,{children:"afterend: \u63D2\u5165\u4E0B\u4E00\u4E2A\u5144\u5F1F\u8282\u70B9."}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// 4 positions:\n//\n// \x3c!-- beforebegin --\x3e\n// <p>\n// \x3c!-- afterbegin --\x3e\n// foo\n// \x3c!-- beforeend --\x3e\n// </p>\n// \x3c!-- afterend --\x3e\nconst p = document.querySelector('p')\n\np.insertAdjacentHTML('beforebegin', '<a></a>')\np.insertAdjacentText('afterbegin', 'foo')\n\n// simply be moved element, not copied element\np.insertAdjacentElement('beforebegin', link)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"replace",children:"Replace"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"node.replaceChild(document.createTextNode(text), node.firstChild)\nnode.replaceChildren(...nodeList)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"remove",children:"Remove"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u5220\u9664\u7B2C\u4E00\u4E2A\u5B50\u8282\u70B9\nconst formerFirstChild = someNode.removeChild(someNode.firstChild)\n\n// \u5220\u9664\u6700\u540E\u4E00\u4E2A\u5B50\u8282\u70B9\nconst formerLastChild = someNode.removeChild(someNode.lastChild)\n\nwhile (div.firstChild)\n  div.removeChild(div.firstChild)\n\n// Remove self\nel.parentNode.removeChild(el)\nel.remove()\n"})}),"\n",(0,s.jsx)(n.h3,{id:"traverse",children:"Traverse"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const parent = node.parentNode\nconst children = node.childNodes\nconst first = node.firstChild\nconst last = node.lastChild\nconst previous = node.previousSibling\nconst next = node.nextSibling\n\nnode.matches(selector)\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://www.w3.org/TR/ElementTraversal",children:"Element Traversal API"}),":\nnavigation properties listed above refer to all nodes.\nFor instance,\nin ",(0,s.jsx)(n.code,{children:"childNodes"})," can see both text nodes, element nodes, and even comment nodes."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const count = el.childElementCount\nconst parent = el.parentElement\nconst children = el.children\nconst first = el.firstElementChild\nconst last = el.lastElementChild\nconst previous = el.previousElementSibling\nconst next = el.nextElementSibling\n\nel.matches(selector)\n"})}),"\n",(0,s.jsx)(n.p,{children:"NodeList is iterable:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const elements = document.querySelectorAll('div')\n\nfor (const element of elements)\n  console.log(element)\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://developer.mozilla.org/docs/Web/API/NodeIterator",children:"Node Iterator"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const div = document.getElementById('div1')\nfunction filter(node) {\n  return node.tagName.toLowerCase() === 'li'\n    ? NodeFilter.FILTER_ACCEPT\n    : NodeFilter.FILTER_SKIP\n}\nconst iterator = document.createNodeIterator(\n  div,\n  NodeFilter.SHOW_ELEMENT,\n  filter,\n  false\n)\n\nfor (\n  let node = iterator.nextNode();\n  node !== null;\n  node = iterator.nextNode()\n)\n  console.log(node.tagName) // \u8F93\u51FA\u6807\u7B7E\u540D\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://developer.mozilla.org/docs/Web/API/TreeWalker",children:"Tree Walker"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const div = document.getElementById('div1')\nconst walker = document.createTreeWalker(\n  div,\n  NodeFilter.SHOW_ELEMENT,\n  null,\n  false\n)\n\nwalker.firstChild() // \u524D\u5F80<p>\nwalker.nextSibling() // \u524D\u5F80<ul>\n\nfor (\n  let node = walker.firstChild();\n  node !== null;\n  node = walker.nextSibling()\n)\n  console.log(node.tagName) // \u904D\u5386 <li>\n"})}),"\n",(0,s.jsx)(n.admonition,{title:"NodeIterator vs TreeWalker",type:"tip",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"NodeFilter.acceptNode()"})," ",(0,s.jsx)(n.code,{children:"FILTER_REJECT"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["For ",(0,s.jsx)(n.code,{children:"NodeIterator"}),", this flag is synonymous with ",(0,s.jsx)(n.code,{children:"FILTER_SKIP"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["For ",(0,s.jsx)(n.code,{children:"TreeWalker"}),", child nodes are also rejected."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"TreeWalker"})," has more methods:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"firstChild"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"lastChild"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"previousSibling"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"nextSibling"}),"."]}),"\n"]}),"\n"]}),"\n"]})}),"\n",(0,s.jsx)(n.h3,{id:"attributes",children:"Attributes"}),"\n",(0,s.jsx)(n.p,{children:"HTML attributes \u8BBE\u7F6E\u5BF9\u5E94\u7684 DOM properties \u521D\u59CB\u503C:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"alert(div.getAttribute('id')) // \"myDiv\" default div.id\nalert(div.getAttribute('class')) // \"bd\" default div.class\ndiv.setAttribute('id', 'someOtherId')\ndiv.setAttribute('class', 'ft')\ndiv.removeAttribute('id')\ndiv.removeAttribute('class')\n\n// `data-src`\nconsole.log(el.dataset.src)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"select",children:"Select"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://developer.mozilla.org/docs/Web/API/Range",children:"Range API"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"startContainer"}),": \u8303\u56F4\u8D77\u70B9\u6240\u5728\u7684\u8282\u70B9 (\u9009\u533A\u4E2D\u7B2C\u4E00\u4E2A\u5B50\u8282\u70B9\u7684\u7236\u8282\u70B9)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"startOffset"}),": \u8303\u56F4\u8D77\u70B9\u5728 startContainer \u4E2D\u7684\u504F\u79FB\u91CF."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"endContainer"}),": \u8303\u56F4\u7EC8\u70B9\u6240\u5728\u7684\u8282\u70B9 (\u9009\u533A\u4E2D\u6700\u540E\u4E00\u4E2A\u5B50\u8282\u70B9\u7684\u7236\u8282\u70B9)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"endOffset"}),": \u8303\u56F4\u8D77\u70B9\u5728 startContainer \u4E2D\u7684\u504F\u79FB\u91CF."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"commonAncestorContainer"}),":\n\u6587\u6863\u4E2D\u4EE5 ",(0,s.jsx)(n.code,{children:"startContainer"})," \u548C ",(0,s.jsx)(n.code,{children:"endContainer"})," \u4E3A\u540E\u4EE3\u7684\u6700\u6DF1\u7684\u8282\u70B9."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"setStartBefore(refNode)"}),":\n\u628A\u8303\u56F4\u7684\u8D77\u70B9\u8BBE\u7F6E\u5230 refNode \u4E4B\u524D,\n\u4ECE\u800C\u8BA9 refNode \u6210\u4E3A\u9009\u533A\u7684\u7B2C\u4E00\u4E2A\u5B50\u8282\u70B9."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"setStartAfter(refNode)"}),":\n\u628A\u8303\u56F4\u7684\u8D77\u70B9\u8BBE\u7F6E\u5230 refNode \u4E4B\u540E,\n\u4ECE\u800C\u5C06 refNode \u6392\u9664\u5728\u9009\u533A\u4E4B\u5916,\n\u8BA9\u5176\u4E0B\u4E00\u4E2A\u540C\u80DE\u8282\u70B9\u6210\u4E3A\u9009\u533A\u7684\u7B2C\u4E00\u4E2A\u5B50\u8282\u70B9."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"setEndBefore(refNode)"}),":\n\u628A\u8303\u56F4\u7684\u7EC8\u70B9\u8BBE\u7F6E\u5230 refNode \u4E4B\u524D,\n\u4ECE\u800C\u5C06 refNode \u6392\u9664\u5728\u9009\u533A\u4E4B\u5916,\n\u8BA9\u5176\u4E0A\u4E00\u4E2A\u540C\u80DE\u8282\u70B9\u6210\u4E3A\u9009\u533A\u7684\u6700\u540E\u4E00\u4E2A\u5B50\u8282\u70B9."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"setEndAfter(refNode)"}),":\n\u628A\u8303\u56F4\u7684\u7EC8\u70B9\u8BBE\u7F6E\u5230 refNode \u4E4B\u540E,\n\u4ECE\u800C\u8BA9 refNode \u6210\u4E3A\u9009\u533A\u7684\u6700\u540E\u4E00\u4E2A\u5B50\u8282\u70B9."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"setStart(refNode, offset)"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"setEnd(refNode, offset)"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"deleteContents()"}),": remove."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"extractContents()"}),": remove and return."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"cloneContents()"}),": clone."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"insertNode(node)"}),": \u5728\u8303\u56F4\u9009\u533A\u7684\u5F00\u59CB\u4F4D\u7F6E\u63D2\u5165\u4E00\u4E2A\u8282\u70B9."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"surroundContents(node)"}),": \u63D2\u5165\u5305\u542B\u8303\u56F4\u7684\u5185\u5BB9."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"collapse(boolean)"}),": \u8303\u56F4\u6298\u53E0."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"compareBoundaryPoints(Range.HOW, sourceRange)"}),": \u786E\u5B9A\u8303\u56F4\u4E4B\u95F4\u662F\u5426\u5B58\u5728\u516C\u5171\u7684\u8FB9\u754C (\u8D77\u70B9\u6216\u7EC8\u70B9)."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'<!doctype html>\n<html>\n  <body>\n    <p id="p1"><b>Hello</b> world!</p>\n  </body>\n</html>\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const p1 = document.getElementById('p1')\nconst helloNode = p1.firstChild.firstChild\nconst worldNode = p1.lastChild\nconst range = document.createRange()\n\nrange.setStart(helloNode, 2)\nrange.setEnd(worldNode, 3)\nconst fragment1 = range.cloneContents() // clone\nconst fragment2 = range.extractContents() // remove and return\n\np1.parentNode.appendChild(fragment1)\np1.parentNode.appendChild(fragment2)\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const p1 = document.getElementById('p1')\nconst helloNode = p1.firstChild.firstChild\nconst worldNode = p1.lastChild\nconst range = document.createRange()\n\nconst span = document.createElement('span')\nspan.style.color = 'red'\nspan.appendChild(document.createTextNode('Inserted text'))\n\nrange.setStart(helloNode, 2)\nrange.setEnd(worldNode, 3)\nrange.insertNode(span)\n// <p id=\"p1\"><b>He<span style=\"color: red\">Inserted text</span>llo</b> world</p>\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const p1 = document.getElementById('p1')\nconst helloNode = p1.firstChild.firstChild\nconst worldNode = p1.lastChild\nconst range = document.createRange()\n\nconst span = document.createElement('span')\nspan.style.backgroundColor = 'yellow'\n\nrange.selectNode(helloNode)\nrange.surroundContents(span)\n// <p><b><span style=\"background-color:yellow\">Hello</span></b> world!</p>\n"})}),"\n",(0,s.jsx)(n.h2,{id:"geometry",children:"Geometry"}),"\n",(0,s.jsx)(n.h3,{id:"dimensions",children:"Dimensions"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"outerHeight: \u6574\u4E2A\u6D4F\u89C8\u5668\u7A97\u53E3\u7684\u5927\u5C0F, \u5305\u62EC\u7A97\u53E3\u6807\u9898/\u5DE5\u5177\u680F/\u72B6\u6001\u680F\u7B49."}),"\n",(0,s.jsx)(n.li,{children:"innerHeight: DOM \u89C6\u53E3\u7684\u5927\u5C0F, \u5305\u62EC\u6EDA\u52A8\u6761."}),"\n",(0,s.jsx)(n.li,{children:"offsetHeight: \u6574\u4E2A\u53EF\u89C6\u533A\u57DF\u5927\u5C0F, \u5305\u62EC border \u548C scrollbar \u5728\u5185 (content + padding + border)."}),"\n",(0,s.jsx)(n.li,{children:"clientHeight: \u5185\u90E8\u53EF\u89C6\u533A\u57DF\u5927\u5C0F (content + padding)."}),"\n",(0,s.jsx)(n.li,{children:"scrollHeight: \u5143\u7D20\u5185\u5BB9\u7684\u9AD8\u5EA6, \u5305\u62EC\u6EA2\u51FA\u90E8\u5206."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Client Size",src:t(44108).A+"",title:"Client Size",width:"683",height:"617"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// const supportInnerWidth = window.innerWidth !== undefined;\n// const supportInnerHeight = window.innerHeight !== undefined;\n// const isCSS1Compat = (document.compatMode || '') === 'CSS1Compat';\nconst width\n  = window.innerWidth\n    || document.documentElement.clientWidth\n    || document.body.clientWidth\nconst height\n  = window.innerHeight\n    || document.documentElement.clientHeight\n    || document.body.clientHeight\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u7F29\u653E\u5230 100\xd7100\nwindow.resizeTo(100, 100)\n// \u7F29\u653E\u5230 200\xd7150\nwindow.resizeBy(100, 50)\n// \u7F29\u653E\u5230 300\xd7300\nwindow.resizeTo(300, 300)\n"})}),"\n",(0,s.jsx)(n.admonition,{title:"DOM Rect API",type:"tip",children:(0,s.jsx)(n.p,{children:"In case of transforms,\nthe offsetWidth and offsetHeight returns the layout width and height (all the same),\nwhile getBoundingClientRect() returns the rendering width and height."})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"getBoundingClientRect"}),":"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://developer.mozilla.org/docs/Web/API/Element/getBoundingClientRect",children:(0,s.jsx)(n.img,{src:"https://developer.mozilla.org/docs/Web/API/Element/getBoundingClientRect/element-box-diagram.png",alt:"Client Rect"})})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"function isElementInViewport(el) {\n  const { top, height, left, width } = el.getBoundingClientRect()\n  const w\n    = window.innerWidth\n      || document.documentElement.clientWidth\n      || document.body.clientWidth\n  const h\n    = window.innerHeight\n      || document.documentElement.clientHeight\n      || document.body.clientHeight\n\n  return top <= h && top + height >= 0 && left <= w && left + width >= 0\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"position",children:"Position"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"offsetLeft/offsetTop:\n\u8868\u793A\u8BE5\u5143\u7D20\u7684\u5DE6\u4E0A\u89D2 (\u8FB9\u6846\u5916\u8FB9\u7F18) \u4E0E\u5DF2\u5B9A\u4F4D\u7684\u7236\u5BB9\u5668 (offsetParent \u5BF9\u8C61) \u5DE6\u4E0A\u89D2\u7684\u8DDD\u79BB."}),"\n",(0,s.jsxs)(n.li,{children:["clientLeft/clientTop:\n\u8868\u793A\u8BE5\u5143\u7D20 padding \u81F3 margin \u7684\u8DDD\u79BB,\n\u59CB\u7EC8\u7B49\u4E8E ",(0,s.jsx)(n.code,{children:".getComputedStyle()"})," \u8FD4\u56DE\u7684 ",(0,s.jsx)(n.code,{children:"border-left-width"}),"/",(0,s.jsx)(n.code,{children:"border-top-width"}),"."]}),"\n",(0,s.jsx)(n.li,{children:"scrollLeft/scrollTop:\n\u5143\u7D20\u6EDA\u52A8\u6761\u4F4D\u7F6E, \u88AB\u9690\u85CF\u7684\u5185\u5BB9\u533A\u57DF\u5DE6\u4FA7/\u4E0A\u65B9\u7684\u50CF\u7D20\u4F4D\u7F6E."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Offset Size",src:t(47472).A+"",title:"Offset Size",width:"965",height:"614"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"function getElementLeft(element) {\n  let actualLeft = element.offsetLeft\n  let current = element.offsetParent\n\n  while (current !== null) {\n    actualLeft += current.offsetLeft\n    current = current.offsetParent\n  }\n\n  return actualLeft\n}\n\nfunction getElementTop(element) {\n  let actualTop = element.offsetTop\n  let current = element.offsetParent\n\n  while (current !== null) {\n    actualTop += current.offsetTop\n    current = current.offsetParent\n  }\n\n  return actualTop\n}\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u628A\u7A97\u53E3\u79FB\u52A8\u5230\u5DE6\u4E0A\u89D2\nwindow.moveTo(0, 0)\n// \u628A\u7A97\u53E3\u5411\u4E0B\u79FB\u52A8 100 \u50CF\u7D20\nwindow.moveBy(0, 100)\n// \u628A\u7A97\u53E3\u79FB\u52A8\u5230\u5750\u6807\u4F4D\u7F6E (200, 300)\nwindow.moveTo(200, 300)\n// \u628A\u7A97\u53E3\u5411\u5DE6\u79FB\u52A8 50 \u50CF\u7D20\nwindow.moveBy(-50, 0)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"scrolling",children:"Scrolling"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"scrollLeft/scrollX/PageXOffset: \u5143\u7D20\u5185\u5BB9\u5411\u53F3\u6EDA\u52A8\u4E86\u591A\u5C11\u50CF\u7D20, \u5982\u679C\u6CA1\u6709\u6EDA\u52A8\u5219\u4E3A 0."}),"\n",(0,s.jsx)(n.li,{children:"scrollTop/scrollY/pageYOffset: \u5143\u7D20\u5185\u5BB9\u5411\u4E0A\u6EDA\u52A8\u4E86\u591A\u5C11\u50CF\u7D20, \u5982\u679C\u6CA1\u6709\u6EDA\u52A8\u5219\u4E3A 0."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Scroll Size",src:t(22186).A+"",title:"Scroll Size",width:"1162",height:"710"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// const supportPageOffset = window.pageXOffset !== undefined;\n// const isCSS1Compat = (document.compatMode || '') === 'CSS1Compat';\nconst x\n  = window.pageXOffset\n    || document.documentElement.scrollLeft\n    || document.body.scrollLeft\nconst y\n  = window.pageYOffset\n    || document.documentElement.scrollTop\n    || document.body.scrollTop\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"if (window.innerHeight + window.pageYOffset === document.body.scrollHeight)\n  console.log('Scrolled to Bottom!')\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// \u76F8\u5BF9\u4E8E\u5F53\u524D\u89C6\u53E3\u5411\u4E0B\u6EDA\u52A8 100 \u50CF\u7D20\nwindow.scrollBy(0, 100)\n// \u76F8\u5BF9\u4E8E\u5F53\u524D\u89C6\u53E3\u5411\u53F3\u6EDA\u52A8 40 \u50CF\u7D20\nwindow.scrollBy(40, 0)\n\n// \u6EDA\u52A8\u5230\u9875\u9762\u5DE6\u4E0A\u89D2\nwindow.scrollTo(0, 0)\n// \u6EDA\u52A8\u5230\u8DDD\u79BB\u5C4F\u5E55\u5DE6\u8FB9\u53CA\u9876\u8FB9\u5404 100 \u50CF\u7D20\u7684\u4F4D\u7F6E\nwindow.scrollTo(100, 100)\n// \u6B63\u5E38\u6EDA\u52A8\nwindow.scrollTo({\n  left: 100,\n  top: 100,\n  behavior: 'auto',\n})\n// \u5E73\u6ED1\u6EDA\u52A8\nwindow.scrollTo({\n  left: 100,\n  top: 100,\n  behavior: 'smooth',\n})\n\ndocument.forms[0].scrollIntoView() // \u7A97\u53E3\u6EDA\u52A8\u540E, \u5143\u7D20\u5E95\u90E8\u4E0E\u89C6\u53E3\u5E95\u90E8\u5BF9\u9F50.\ndocument.forms[0].scrollIntoView(true) // \u7A97\u53E3\u6EDA\u52A8\u540E, \u5143\u7D20\u9876\u90E8\u4E0E\u89C6\u53E3\u9876\u90E8\u5BF9\u9F50.\ndocument.forms[0].scrollIntoView({ block: 'start' })\ndocument.forms[0].scrollIntoView({ behavior: 'smooth', block: 'start' })\n"})}),"\n",(0,s.jsx)(n.h2,{id:"loading",children:"Loading"}),"\n",(0,s.jsx)(n.h3,{id:"dynamic-scripts",children:"Dynamic Scripts"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"function loadScript(url) {\n  const script = document.createElement('script')\n  script.src = url\n  script.async = true\n  document.body.appendChild(script)\n}\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"function loadScriptString(code) {\n  const script = document.createElement('script')\n  script.async = true\n  script.type = 'text/javascript'\n\n  try {\n    script.appendChild(document.createTextNode(code))\n  } catch (ex) {\n    script.text = code\n  }\n\n  document.body.appendChild(script)\n}\n"})}),"\n",(0,s.jsx)(n.admonition,{title:"InnerHTML Script",type:"caution",children:(0,s.jsxs)(n.p,{children:["\u6240\u6709\u73B0\u4EE3\u6D4F\u89C8\u5668\u4E2D, \u901A\u8FC7 ",(0,s.jsx)(n.code,{children:"innerHTML"})," \u5C5E\u6027\u521B\u5EFA\u7684 ",(0,s.jsx)(n.code,{children:"<script>"})," \u5143\u7D20\u6C38\u8FDC\u4E0D\u4F1A\u6267\u884C."]})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Next.js route ",(0,s.jsx)(n.a,{href:"https://github.com/vercel/next.js/blob/canary/packages/next/client/route-loader.ts",children:"loader"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Next.js ",(0,s.jsx)(n.code,{children:"<Script>"})," ",(0,s.jsx)(n.a,{href:"https://github.com/vercel/next.js/blob/canary/packages/next/client/script.tsx",children:"component"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"dynamic-styles",children:"Dynamic Styles"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"function loadStyles(url) {\n  const link = document.createElement('link')\n  link.rel = 'stylesheet'\n  link.type = 'text/css'\n  link.href = url\n\n  const head = document.getElementsByTagName('head')[0]\n  head.appendChild(link)\n}\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"function loadStyleString(css) {\n  const style = document.createElement('style')\n  style.type = 'text/css'\n\n  try {\n    style.appendChild(document.createTextNode(css))\n  } catch (ex) {\n    style.styleSheet.cssText = css\n  }\n\n  const head = document.getElementsByTagName('head')[0]\n  head.appendChild(style)\n}\n"})}),"\n",(0,s.jsx)(n.admonition,{title:"StyleSheet CSSText",type:"danger",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u82E5\u91CD\u7528\u540C\u4E00\u4E2A ",(0,s.jsx)(n.code,{children:"<style>"})," \u5143\u7D20\u5E76\u8BBE\u7F6E\u8BE5\u5C5E\u6027\u8D85\u8FC7\u4E00\u6B21, \u5219\u53EF\u80FD\u5BFC\u81F4\u6D4F\u89C8\u5668\u5D29\u6E83."]}),"\n",(0,s.jsxs)(n.li,{children:["\u5C06 ",(0,s.jsx)(n.code,{children:"cssText"})," \u8BBE\u7F6E\u4E3A\u7A7A\u5B57\u7B26\u4E32\u4E5F\u53EF\u80FD\u5BFC\u81F4\u6D4F\u89C8\u5668\u5D29\u6E83."]}),"\n"]})}),"\n",(0,s.jsx)(n.h2,{id:"xml-namespace",children:"XML Namespace"}),"\n",(0,s.jsxs)(n.p,{children:["XML \u547D\u540D\u7A7A\u95F4\u53EF\u4EE5\u5B9E\u73B0\u5728\u4E00\u4E2A\u683C\u5F0F\u89C4\u8303\u7684\u6587\u6863\u4E2D\u6DF7\u7528\u4E0D\u540C\u7684 XML \u8BED\u8A00,\n\u907F\u514D\u5143\u7D20\u547D\u540D\u51B2\u7A81 (",(0,s.jsx)(n.code,{children:"tagName"}),"/",(0,s.jsx)(n.code,{children:"localName"}),"/",(0,s.jsx)(n.code,{children:"namespaceURI"}),"):"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'<html xmlns="http://www.w3.org/1999/xhtml">\n  <head>\n    <title>Example XHTML page</title>\n  </head>\n  <body>\n    <s:svg xmlns:s="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 100 100" style="width: 100%; height: 100%">\n      <s:rect x="0" y="0" width="100" height="100" style="fill: red" />\n    </s:svg>\n  </body>\n</html>\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"console.log(document.body.isDefaultNamespace('http://www.w3.org/1999/xhtml'))\nconsole.log(svg.lookupPrefix('http://www.w3.org/2000/svg')) // \"s\"\nconsole.log(svg.lookupNamespaceURI('s')) // \"http://www.w3.org/2000/svg\"\n\nconst newSvg = document.createElementNS('http://www.w3.org/2000/svg', 'svg')\nconst newAttr = document.createAttributeNS('http://www.somewhere.com', 'random')\nconst elems = document.getElementsByTagNameNS(\n  'http://www.w3.org/1999/xhtml',\n  '*'\n)\n"})})]})}function h(e={}){let{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},44108(e,n,t){t.d(n,{A:()=>l});let l=t.p+"assets/images/client-size-188639869aa83d77661cdd7924b149a1.png"},47472(e,n,t){t.d(n,{A:()=>l});let l=t.p+"assets/images/offset-size-aae54cfc6d6752f66a0d8587797f0820.png"},22186(e,n,t){t.d(n,{A:()=>l});let l=t.p+"assets/images/scroll-size-0fbec70f8a0fcc83776fd80e9ff17f01.png"},30416(e,n,t){t.d(n,{R:()=>i,x:()=>r});var l=t(59471);let s={},d=l.createContext(s);function i(e){let n=l.useContext(d);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),l.createElement(d.Provider,{value:n},e.children)}}}]);