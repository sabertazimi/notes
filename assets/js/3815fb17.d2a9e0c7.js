"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([["41661"],{92654(n,e,t){t.r(e),t.d(e,{metadata:()=>r,default:()=>o,frontMatter:()=>a,contentTitle:()=>l,toc:()=>p,assets:()=>c});var r=JSON.parse('{"id":"cs/compilers/ast","title":"Abstract Syntax Tree","description":"\u8BED\u6CD5\u5236\u5BFC\u7FFB\u8BD1","source":"@site/content/cs/compilers/ast.md","sourceDirName":"cs/compilers","slug":"/cs/compilers/ast","permalink":"/notes/cs/compilers/ast","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/cs/compilers/ast.md","tags":[{"inline":true,"label":"CS","permalink":"/notes/tags/cs"},{"inline":true,"label":"Compiler","permalink":"/notes/tags/compiler"},{"inline":true,"label":"Syntax","permalink":"/notes/tags/syntax"},{"inline":true,"label":"AST","permalink":"/notes/tags/ast"}],"version":"current","lastUpdatedBy":"Sabertaz","lastUpdatedAt":1769518084000,"sidebarPosition":5,"frontMatter":{"sidebar_position":5,"tags":["CS","Compiler","Syntax","AST"]},"sidebar":"tutorialSidebar","previous":{"title":"Bottom-Up Parsing","permalink":"/notes/cs/compilers/bottom-up"},"next":{"title":"Semantic Analysis","permalink":"/notes/cs/compilers/semantic"}}'),i=t(62615),s=t(30416);let a={sidebar_position:5,tags:["CS","Compiler","Syntax","AST"]},l="Abstract Syntax Tree",c={},p=[{value:"\u8BED\u6CD5\u5236\u5BFC\u7FFB\u8BD1",id:"\u8BED\u6CD5\u5236\u5BFC\u7FFB\u8BD1",level:2},{value:"\u62BD\u8C61\u8BED\u6CD5",id:"\u62BD\u8C61\u8BED\u6CD5",level:2},{value:"Data Structure",id:"data-structure",level:2},{value:"Algorithms",id:"algorithms",level:2},{value:"Construction",id:"construction",level:2}];function d(n){let e={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",mermaid:"mermaid",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"abstract-syntax-tree",children:"Abstract Syntax Tree"})}),"\n",(0,i.jsx)(e.admonition,{type:"tip",children:(0,i.jsx)(e.mermaid,{value:'flowchart LR\n    A["Tokens + Grammar"] --\x3e|Syntax Analysis| B["AST"]'})}),"\n",(0,i.jsx)(e.h2,{id:"\u8BED\u6CD5\u5236\u5BFC\u7FFB\u8BD1",children:"\u8BED\u6CD5\u5236\u5BFC\u7FFB\u8BD1"}),"\n",(0,i.jsx)(e.p,{children:"Syntax-directed translation,\n\u5728\u8FDB\u884C\u5F52\u7EA6(reduce)\u7684\u540C\u65F6, \u8FDB\u884C\u8BED\u4E49\u52A8\u4F5C:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7ED9\u6BCF\u6761\u4EA7\u751F\u89C4\u5219\u9644\u52A0\u4E00\u4E2A\u8BED\u4E49\u52A8\u4F5C"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bison",children:"exp : exp '+' exp { $$ = $1 + $3; }\n;\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5728\u5206\u6790\u6808\u4E2D\u538B\u5165 symbol, value, state (\u539F\u672C\u53EA\u538B\u5165 symbol, state)"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-cpp",children:"push(right side symbol);\npush(right side value);\npush(next state);\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u62BD\u8C61\u8BED\u6CD5",children:"\u62BD\u8C61\u8BED\u6CD5"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u8868\u8FBE\u8BED\u6CD5\u7ED3\u6784\u7684\u5185\u90E8\u8868\u793A, \u4F5C\u4E3A\u524D\u7AEF(\u8BCD\u6CD5\u8BED\u6CD5\u5206\u6790)\u548C\u540E\u7AEF(\u4EE3\u7801\u751F\u6210)\u7684\u4E2D\u95F4\u4EF6:"}),"\n"]}),"\n",(0,i.jsx)(e.mermaid,{value:'flowchart LR\n    A["tokens"] --\x3e|\u8BED\u6CD5\u5206\u6790\u5668| B["\u62BD\u8C61\u8BED\u6CD5(\u6811)"]\n    B --\x3e|\u4EE3\u7801\u751F\u6210\u5668| C["\u76EE\u6807\u4EE3\u7801"]'}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u62BD\u8C61\u8BED\u6CD5\u65E0\u9700\u8003\u8651\u5DE6/\u53F3\u9012\u5F52, \u5DE6\u516C\u56E0\u5B50\u63D0\u53D6, \u5206\u9694\u7B26\u7B49"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-cpp",children:"// \u5177\u4F53\u8BED\u6CD5\nE: E + T\n | T\n ;\nT: T * F\n | F\n ;\nF: n\n | (E)\n ;\n\n// \u62BD\u8C61\u8BED\u6CD5\nE: n\n | E + E\n | E * E\n"})}),"\n",(0,i.jsx)(e.h2,{id:"data-structure",children:"Data Structure"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-cpp",children:"E: n\n | E + E\n | E * E\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-cpp",children:"enum kind {\n  E_INT,\n  E_ADD,\n  E_TIMES\n};\n\nstruct exp {\n  enum kind kind;\n};\n\nstruct exp_int {\n  enum kind kind;\n  int value;\n};\n\nstruct exp_add {\n  enum kind kind;\n  struct exp *left;\n  struct exp *right;\n};\n\nstruct exp_times {\n  enum kind kind;\n  struct exp *left;\n  struct exp *right;\n};\n\nstruct exp_int *new_exp_int(int value) {\n  struct exp_int *p = (struct exp_int *)malloc(sizeof(struct exp_int));\n  if (!p) throw new Error();\n  p->kind = E_INT;\n  p->value = value;\n  return p;\n}\n\nstruct exp_add *new_exp_add(exp *left, exp *right) {\n  struct exp_add *p = (struct exp_add *)malloc(sizeof(struct exp_add));\n  if (!p) throw new Error();\n  p->kind = E_ADD;\n  p->left = left;\n  p->right = right;\n  return p;\n}\n\nstruct exp_times *new_exp_times(exp *left, exp *right) {\n  struct exp_times *p = (struct exp_times *)malloc(sizeof(struct exp_times));\n  if (!p) throw new Error();\n  p->kind = E_TIMES;\n  p->left = left;\n  p->right = right;\n  return p;\n}\n"})}),"\n",(0,i.jsx)(e.h2,{id:"algorithms",children:"Algorithms"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-cpp",children:'int nodes_num(exp *e) {\n  switch (e->kind) {\n    case E_INT:\n      return 1;\n    case E_ADD: // fall through\n    case E_TIMES:\n      return 1 + nodes_num(e->left) + nodes_num(e->right);\n    default:\n      throw new SyntaxError("compile bug");\n  }\n}\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-cpp",children:'int pretty_print(exp *e) {\n  switch (e->kind) {\n    case E_INT:\n      printf("%d", e->value);\n      return 1;\n    case E_ADD:\n      printf("(");\n      pretty_print(e->left);\n      printf(")");\n      printf("+");\n      printf("(");\n      pretty_print(e->right);\n      printf(")");\n      return 1;\n    case E_TIMES:\n      printf("(");\n      pretty_print(e->left);\n      printf(")");\n      printf("*");\n      printf("(");\n      pretty_print(e->right);\n      printf(")");\n      return 1;\n    default:\n      throw new SyntaxError();\n      break;\n  }\n}\n'})}),"\n",(0,i.jsx)(e.h2,{id:"construction",children:"Construction"}),"\n",(0,i.jsx)(e.p,{children:"\u5229\u7528\u8BED\u6CD5\u5236\u5BFC\u7FFB\u8BD1, \u5728\u8BED\u6CD5\u52A8\u4F5C(action)/\u8BED\u6CD5\u5F52\u7EA6(reduce)\u4E2D\u52A0\u5165\u751F\u6210\u8BED\u6CD5\u6811\u7684\u4EE3\u7801(\u81EA\u5E95(\u53F6\u5B50)\u5411\u4E0A(\u6839)\u6784\u9020\u51FD\u6570)"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-cpp",children:"E: E + E { $$ = new_exp_add($1, $3); }\n | E * E { $$ = new_exp_times($1, $3); }\n | n     { $$ = new_exp_int($1); }\n ;\n"})})]})}function o(n={}){let{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(d,{...n})}):d(n)}},30416(n,e,t){t.d(e,{R:()=>a,x:()=>l});var r=t(59471);let i={},s=r.createContext(i);function a(n){let e=r.useContext(s);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:a(n.components),r.createElement(s.Provider,{value:e},n.children)}}}]);