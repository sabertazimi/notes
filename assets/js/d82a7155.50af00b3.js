"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([["68747"],{78388(e,t,n){n.r(t),n.d(t,{metadata:()=>s,default:()=>u,frontMatter:()=>i,contentTitle:()=>c,toc:()=>l,assets:()=>a});var s=JSON.parse('{"id":"web/react/hooks/best-practices","title":"Best Practices","description":"\u5982\u679C\u5C06\u4E00\u4E2A\u51FD\u6570\u4EFB\u610F\u5730\u5C06\u5176\u653E\u5728 useEffect Deps List \u4E2D","source":"@site/content/web/react/hooks/best-practices.md","sourceDirName":"web/react/hooks","slug":"/web/react/hooks/best-practices","permalink":"/notes/web/react/hooks/best-practices","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/web/react/hooks/best-practices.md","tags":[{"inline":true,"label":"Web","permalink":"/notes/tags/web"},{"inline":true,"label":"React","permalink":"/notes/tags/react"},{"inline":true,"label":"Hook","permalink":"/notes/tags/hook"},{"inline":true,"label":"Best Practice","permalink":"/notes/tags/best-practice"}],"version":"current","lastUpdatedBy":"Sabertaz","lastUpdatedAt":1769518084000,"sidebarPosition":50,"frontMatter":{"sidebar_position":50,"tags":["Web","React","Hook","Best Practice"]},"sidebar":"tutorialSidebar","previous":{"title":"Store","permalink":"/notes/web/react/hooks/store"},"next":{"title":"Internals","permalink":"/notes/web/react/hooks/internals"}}'),r=n(62615),o=n(30416);let i={sidebar_position:50,tags:["Web","React","Hook","Best Practice"]},c="Best Practices",a={},l=[];function d(e){let t={code:"code",h1:"h1",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"best-practices",children:"Best Practices"})}),"\n",(0,r.jsx)(t.p,{children:"\u5982\u679C\u5C06\u4E00\u4E2A\u51FD\u6570\u4EFB\u610F\u5730\u5C06\u5176\u653E\u5728 useEffect Deps List \u4E2D\n\u53EF\u80FD\u4F1A\u5BFC\u81F4\u91CD\u590D\u65E0\u610F\u4E49\u7684 useEffect \u6267\u884C\n(\u56E0\u4E3A\u6BCF\u6B21 render \u671F\u95F4\u7684\u6B64\u51FD\u6570\u90FD\u4F1A\u91CD\u65B0\u5B9A\u4E49).\n\u6709\u4E24\u4E2A\u89E3\u51B3\u529E\u6CD5:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"\u5BF9\u4E8E\u88AB\u591A\u6B21\u590D\u7528 Utils \u51FD\u6570 (\u4E14\u4E0D\u4F9D\u8D56\u7EC4\u4EF6\u7684\u4EFB\u4F55\u503C),\n\u5E94\u8BE5\u63D0\u5230\u7EC4\u4EF6\u5916\u9762\u7684\u516C\u5171\u533A\u57DF\u53BB\u5B9A\u4E49."}),"\n",(0,r.jsx)(t.li,{children:"\u5BF9\u4E8E\u53EA\u88AB\u7279\u5B9A Effect Hook \u8C03\u7528\u7684 Utils \u51FD\u6570,\n\u53EF\u4EE5\u653E\u5230 useEffect \u5185\u90E8\u5B9A\u4E49."}),"\n",(0,r.jsx)(t.li,{children:"\u5BF9\u4E8E\u5176\u4ED6\u9700\u8981\u5728\u7EC4\u4EF6\u5185(\u6216\u81EA\u5B9A\u4E49 Hooks \u5185)\u5B9A\u4E49\u7684\u51FD\u6570,\n\u53EF\u4F7F\u7528 useCallback \u5305\u88F9\u51FD\u6570, \u5E76\u8BBE\u7F6E\u6B63\u786E\u7684 Deps List,\n\u5C3D\u53EF\u80FD\u5730\u51CF\u5C11 render \u65F6\u91CD\u65B0\u5B9A\u4E49\u6B64\u51FD\u6570."}),"\n"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-ts",children:"// \u2705 Not affected by the data flow\nfunction getFetchUrl(query) {\n  return `https://hn.algolia.com/api/v1/search?query=${query}`\n}\n\nfunction SearchResults() {\n  useEffect(() => {\n    const url = getFetchUrl('react')\n    // ... Fetch data and do something ...\n  }, []) // \u2705 Deps are OK\n\n  useEffect(() => {\n    const url = getFetchUrl('redux')\n    // ... Fetch data and do something ...\n  }, []) // \u2705 Deps are OK\n\n  // ...\n}\n"})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Don't forget to cleanup side effects (return function in useEffect)"}),"\n",(0,r.jsxs)(t.li,{children:["Set correct deps list for useEffect:","\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"avoid object deps (should use object property)."}),"\n",(0,r.jsx)(t.li,{children:"enough deps list to avoid infinite loop rendering pitfall."}),"\n",(0,r.jsx)(t.li,{children:"enough deps list to avoid stale closure."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(t.li,{children:"setState(state => state + 1) is better (avoid outdated state)."}),"\n",(0,r.jsxs)(t.li,{children:["Change ",(0,r.jsx)(t.code,{children:"useState"})," to ",(0,r.jsx)(t.code,{children:"useRef"})," when values not for rendering."]}),"\n",(0,r.jsxs)(t.li,{children:["Don't put any ",(0,r.jsx)(t.code,{children:"if"})," statement before hooks function."]}),"\n",(0,r.jsx)(t.li,{children:"Only call Hooks at the top level (don't inside loops, conditions or nested functions)."}),"\n",(0,r.jsx)(t.li,{children:"Only call Hooks from React function components."}),"\n"]})]})}function u(e={}){let{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},30416(e,t,n){n.d(t,{R:()=>i,x:()=>c});var s=n(59471);let r={},o=s.createContext(r);function i(e){let t=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(o.Provider,{value:t},e.children)}}}]);