"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([["68694"],{13642(e,n,l){l.r(n),l.d(n,{metadata:()=>s,default:()=>t,frontMatter:()=>c,contentTitle:()=>r,toc:()=>h,assets:()=>a});var s=JSON.parse('{"id":"language/assembly/assembly","title":"Assembly","description":"Execution Model","source":"@site/content/language/assembly/assembly.md","sourceDirName":"language/assembly","slug":"/language/assembly/","permalink":"/notes/language/assembly/","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/language/assembly/assembly.md","tags":[{"inline":true,"label":"Language","permalink":"/notes/tags/language"},{"inline":true,"label":"Assembly","permalink":"/notes/tags/assembly"}],"version":"current","lastUpdatedBy":"Sabertaz","lastUpdatedAt":1769518084000,"frontMatter":{"tags":["Language","Assembly"]},"sidebar":"tutorialSidebar","previous":{"title":"Language","permalink":"/notes/language/"},"next":{"title":"C","permalink":"/notes/language/c/"}}'),i=l(62615),d=l(30416);let c={tags:["Language","Assembly"]},r="Assembly",a={},h=[{value:"Execution Model",id:"execution-model",level:2},{value:"Bitwise",id:"bitwise",level:2},{value:"Address",id:"address",level:2},{value:"Read",id:"read",level:2},{value:"Jump",id:"jump",level:2},{value:"If",id:"if",level:2},{value:"Switch",id:"switch",level:2},{value:"Stack Frame",id:"stack-frame",level:2},{value:"Array",id:"array",level:2},{value:"Gcc",id:"gcc",level:2},{value:"Gdb",id:"gdb",level:2},{value:"Masm",id:"masm",level:2},{value:"Link",id:"link",level:2},{value:"Turbo Debugger",id:"turbo-debugger",level:2},{value:"Alt",id:"alt",level:3},{value:"\u4EE3\u7801\u533A",id:"\u4EE3\u7801\u533A",level:3},{value:"\u6570\u636E\u533A",id:"\u6570\u636E\u533A",level:3},{value:"Make",id:"make",level:2},{value:"Objdump",id:"objdump",level:2}];function x(e){let n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,d.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"assembly",children:"Assembly"})}),"\n",(0,i.jsx)(n.h2,{id:"execution-model",children:"Execution Model"}),"\n",(0,i.jsx)(n.p,{children:"Load-ALU-Store \u6A21\u5F0F - \u8BFB\u5165\u5BC4\u5B58\u5668\uFF0C\u7B97\u672F\u903B\u8F91\u5355\u5143\u8FD0\u7B97\uFF0C\u56DE\u5199\u81F3\u5185\u5B58"}),"\n",(0,i.jsx)(n.h2,{id:"bitwise",children:"Bitwise"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"^"}),"\uFF1A\u65E0\u8FDB\u4F4D"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"p && *p++"})," : NULL \u68C0\u67E5"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u7F16\u7801\uFF1A2^n e.g. \u4E00\u526F\u724C\u7684\u7F16\u7801 2 \u4F4D\u724C\u8272\u4F4D+4 \u4F4D\u6570\u5B57\u4F4D"}),"\n",(0,i.jsx)(n.h2,{id:"address",children:"Address"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"movX src dest"}),": X \u53EF\u4E3A b/w/l/q \uFF081/2/4/8 \u5B57\u8282\uFF09"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"D(Rb, Ri, S)"}),": ",(0,i.jsx)(n.code,{children:"MEM[ Reg[Rb] + S * Reg[Ri] + D]"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"leal"})," \u547D\u4EE4:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"leal D(Rb, Ri, S) dest"})," - \u5C06\u5730\u5740\u6A21\u5F0F\u8868\u8FBE\u5F0F\u7684\u5740\u5B58\u5165 dest.\n\u4F5C\u7528\u4E3A\u5FEB\u901F\u7ED9\u6307\u9488\u8D4B\u503C",(0,i.jsx)(n.code,{children:"p = &x[i]"})," \u5373",(0,i.jsx)(n.code,{children:"Mem[Reg[x] + i * size]->(x, size, I)"}),",\n\u5FEB\u901F\u8BA1\u7B97\u4E8C\u6B21\u591A\u9879\u5F0F ",(0,i.jsx)(n.code,{children:"x + i * k"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"read",children:"Read"}),"\n",(0,i.jsx)(n.p,{children:"\u5185\u5B58\u6570\u636E\u91CD\u590D\u8BFB\u5165\u5BC4\u5B58\u5668 - \u4F7F\u5F97\u6C47\u7F16\u4EE3\u7801\u4E0E\u4E0A\u4E0B\u6587\u65E0\u5173,\u51CF\u5C11 BUG \u4EA7\u751F\u53EF\u80FD\u6027"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:"R1 = MEM[SP + 8]\n\u2026\u2026\nR1 = MEM[SP + 8]\n\u2026\u2026\nR1 = MEM[SP + 8]\n\u2026\u2026\n"})}),"\n",(0,i.jsx)(n.h2,{id:"jump",children:"Jump"}),"\n",(0,i.jsx)(n.p,{children:"Flags"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"CF\uFF1ACarry Flag(unsigned) \u8FDB\u4F4D\u6807\u5FD7\u2014\u2014\u5F53\u6709\u8FDB\u4F4D\u65F6\u8BBE\u4E3A 1"}),"\n",(0,i.jsx)(n.li,{children:"OF\uFF1AOverFlow Flag(signed) \u6EA2\u51FA\u6807\u5FD7\u2014\u2014\u5F53\u8865\u7801\u6EA2\u51FA\u65F6\u8BBE\u4E3A 1"}),"\n",(0,i.jsxs)(n.li,{children:["SF\uFF1ASign Flag(signed) \u7B26\u53F7\u6807\u5FD7\u2014\u2014\u5F53 ",(0,i.jsx)(n.code,{children:"t < 0"})," \u65F6\u8BBE\u4E3A 1"]}),"\n",(0,i.jsxs)(n.li,{children:["ZF\uFF1AZero Flag \u96F6\u6807\u5FD7\u2014\u2014\u5F53 ",(0,i.jsx)(n.code,{children:"t == 0"})," \u65F6\u8BBE\u4E3A 1"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["cmpX \u547D\u4EE4: ",(0,i.jsx)(n.code,{children:"cmpl Src2, Src1"}),",\n\u6839\u636E Src1 \u2013 Src2(subl Src2, Src1)\u7684\u7ED3\u679C\u8BBE\u7F6E\u6807\u5FD7\u5BC4\u5B58\u5668\u7684\u503C"]}),"\n",(0,i.jsxs)(n.p,{children:["testX \u547D\u4EE4: ",(0,i.jsx)(n.code,{children:"testl Src2, Src1"}),",\n\u6839\u636E Src1 & Src2(andl Src2, Src1)\u7684\u7ED3\u679C\u8BBE\u7F6E\u6807\u5FD7\u5BC4\u5B58\u5668\u7684\u503C"]}),"\n",(0,i.jsx)(n.p,{children:"e.g. testl %eax, %eax \u5B9E\u73B0\u7B26\u53F7\u51FD\u6570"}),"\n",(0,i.jsxs)(n.p,{children:["setX \u547D\u4EE4: ",(0,i.jsx)(n.code,{children:"setX dest"}),",\n\u6839\u636E\u6807\u5FD7\u5BC4\u5B58\u5668\u8FD0\u7B97\u503C\uFF0C\u5C06\u503C\u5B58\u5165 dest"]}),"\n",(0,i.jsx)(n.h2,{id:"if",children:"If"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"cmovC src, dest"}),"(C \u8868\u793A Conditional\u2014\u2014e/ne \u7B49)\n\u5F53\u6761\u4EF6\u6210\u7ACB\u65F6\uFF0Csrc->dest src \u4E0E dest \u53EF\u5206\u522B\u7528\u4E8E\u5B58\u653E\u4E24\u79CD\u60C5\u51B5\u7684\u503C"]}),"\n",(0,i.jsx)(n.h2,{id:"switch",children:"Switch"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Jump Table"}),":"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"break; \u2192 leave"}),"\n",(0,i.jsx)(n.code,{children:"ret"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"fallThrough(without break)"}),"\n",(0,i.jsx)(n.li,{children:"mixing(\u8FDE\u5192\u53F7)"}),"\n",(0,i.jsx)(n.li,{children:"missing case"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"stack-frame",children:"Stack Frame"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:"# \u51C6\u5907\u9636\u6BB5\n# Caller-Save: %eax %ecx %edx\n# Callee-Save: %ebx %esi %edi\n# \u4F20\u53C2\u987A\u5E8F: rdi, dsi, rdx, rcx, r8, r9, stack\n\npushl %ebp\nmovl %esp, %ebp\npushl %ebx\n\n# \u7ED3\u675F\u9636\u6BB5\n\nmovl -4(%ebp), %ebx\nmovl %ebp, %esp\npopl %ebp\nret\n"})}),"\n",(0,i.jsx)(n.h2,{id:"array",children:"Array"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:"int get_sea_digit(int index, int dig) {\n    return sea[index][dig];\n}\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:"# \u8BBF\u95EE\u4E8C\u7EF4\u6570\u7EC4\u5143\u7D20\n# %ecx = dig\n# %eax = index\nleal 0(,%ecx,4), %edx        # 4 * dig\nleal (%eax,%eax,4), %eax     # 5 * index\nmovl sea(%edx,%eax,4), %eax  # * (sea + 4 * dig + 20 * index)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"gcc",children:"Gcc"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"gcc -01/-02/-03 source.c"})," \u2014\u2014 \u7F16\u8BD1\u4F18\u5316\u7B49\u7EA7"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"gcc -S source.c"})," \u2014\u2014 \u7F16\u8BD1\u6210\u6C47\u7F16\u4EE3\u7801(\u6587\u672C\u6587\u4EF6)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"gcc -o source.c"})," \u2014\u2014 \u7F16\u8BD1\u6210 Object \u4EE3\u7801(\u4E8C\u8FDB\u5236\u6587\u4EF6)"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"gdb",children:"Gdb"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"si"})," \u5355\u6307\u4EE4\u6267\u884C"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"x/i $pc"})," \u6267\u884C si \u547D\u4EE4\u65F6\u6253\u5370\u6C47\u7F16\u4EE3\u7801"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"disas"})," \u663E\u793A\u6C47\u7F16\u4EE3\u7801"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"bt"})," \u67E5\u770B\u51FD\u6570\u5806\u6808"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"step1"})," \u4E0B\u4E00\u6761\u6C47\u7F16\u6307\u4EE4"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"info register"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"x /numsizeformat $pc/rsp/rbp"})}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"masm",children:"Masm"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"masm /Zi/Zd src dist\nmasm /I(path)           // \u5F15\u7528 \u6807\u51C6\u5E93/\u5B8F\nmasm /I..\\include\n"})}),"\n",(0,i.jsx)(n.h2,{id:"link",children:"Link"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"link /DEBUG src\n"})}),"\n",(0,i.jsx)(n.h2,{id:"turbo-debugger",children:"Turbo Debugger"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"tab"})," \u5207\u6362\u5206\u533A"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"alt"})," \u529F\u80FD\u952E"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ctrl"})," \u5B50\u529F\u80FD\u952E"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"F2"}),": break"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"F7"}),": step into"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"F8"}),": step over"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"alt",children:"Alt"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Alt+F5"})," : \u4E34\u65F6\u8DF3\u8F6C\u81F3 dos \u754C\u9762"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Alt+Enter"}),": \u5168\u5C4F"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Alt+X"})," : \u9000\u51FA"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"\u4EE3\u7801\u533A",children:"\u4EE3\u7801\u533A"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"<C-A>"})," Assemble: \u4E34\u65F6\u4FEE\u6539\u6C47\u7F16\u6307\u4EE4"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"<C-C>"})," Caller : \u4ECE\u5B50\u7A0B\u5E8F\u5904\u8DF3\u56DE\u81F3 Caller \u5904"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"<C-F>"})," Follow : \u67E5\u770B CALL/JMP/INT \u8DF3\u8F6C\u81F3\u7684\u5B50\u7A0B\u5E8F\u5904"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"<C-O>"})," Origin : \u8DF3\u8F6C\u81F3 cs",":ip"," \u6307\u5411\u6307\u4EE4\u5904"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"\u6570\u636E\u533A",children:"\u6570\u636E\u533A"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"<C-C>"})," Change: \u4E34\u65F6\u4FEE\u6539\u6570\u636E"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"<C-D>"})," Display: \u9009\u62E9\u663E\u793A\u683C\u5F0F e.g. Byte/Word/Long/Comp/Float/Real/Double/Extended"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"<C-G>"})," Goto: \u8DF3\u8F6C\u81F3\u6307\u5B9A\u5730\u5740\u533A"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"make",children:"Make"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"$<"}),": \u6E90\u6587\u4EF6\u540D"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"$?"}),": \u6240\u6709\u6E90\u6587\u4EF6\u540D"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"$@"}),": \u5168\u8DEF\u5F84\u7684\u76EE\u6807\u6587\u4EF6"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"$*"}),": \u9664\u53BB\u6269\u5C55\u540D\u7684\u5168\u8DEF\u5F84\u7684\u76EE\u6807\u6587\u4EF6"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-makefile",children:"EXE = $(NAME).exe\nOBJS = $(NAME).obj\nSRCS = $(NAME).asm\nSIMPLE_MODE = ;\n\nLINK_FLAG = /subsystem:windows\nML_FLAG = /c/coff/Zi\nMASM_FLAG = /Zi/Zd\n\n$(EXE): $(OBJS)\n    link $(LINK_FLAG) $(OBJS) $(SIMPLE_MODE)\n\n$(OBJS): $(SRCS)\n    masm $(MASM_FLAG) $(SRCS) $(SIMPLE_MODE)\n\nclean:\n    del *.obj\n    del *.tr\n\ntest:\n    td $(EXE)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"objdump",children:"Objdump"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"AT&T"}),"\u53CD\u6C47\u7F16\u5DE5\u5177"]})]})}function t(e={}){let{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(x,{...e})}):x(e)}},30416(e,n,l){l.d(n,{R:()=>c,x:()=>r});var s=l(59471);let i={},d=s.createContext(i);function c(e){let n=s.useContext(d);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),s.createElement(d.Provider,{value:n},e.children)}}}]);