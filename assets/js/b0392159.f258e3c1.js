"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([["7653"],{96991(e,n,t){t.r(n),t.d(n,{metadata:()=>r,default:()=>p,frontMatter:()=>o,contentTitle:()=>a,toc:()=>c,assets:()=>l});var r=JSON.parse('{"id":"web/typescript/signature","title":"Signature","description":"Call Signature","source":"@site/content/web/typescript/signature.md","sourceDirName":"web/typescript","slug":"/web/typescript/signature","permalink":"/notes/web/typescript/signature","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/web/typescript/signature.md","tags":[{"inline":true,"label":"Web","permalink":"/notes/tags/web"},{"inline":true,"label":"TypeScript","permalink":"/notes/tags/type-script"},{"inline":true,"label":"Signature","permalink":"/notes/tags/signature"}],"version":"current","lastUpdatedBy":"Sabertaz","lastUpdatedAt":1769518084000,"sidebarPosition":8,"frontMatter":{"sidebar_position":8,"tags":["Web","TypeScript","Signature"]},"sidebar":"tutorialSidebar","previous":{"title":"Modifiers","permalink":"/notes/web/typescript/modifier"},"next":{"title":"Literal","permalink":"/notes/web/typescript/literal"}}'),s=t(62615),i=t(30416);let o={sidebar_position:8,tags:["Web","TypeScript","Signature"]},a="Signature",l={},c=[{value:"Call Signature",id:"call-signature",level:2},{value:"Index Signature",id:"index-signature",level:2},{value:"Type Check",id:"type-check",level:3},{value:"Select",id:"select",level:3},{value:"Symbol",id:"symbol",level:3},{value:"Template Literal",id:"template-literal",level:3},{value:"Indexed Access Types",id:"indexed-access-types",level:3}];function d(e){let n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"signature",children:"Signature"})}),"\n",(0,s.jsx)(n.h2,{id:"call-signature",children:"Call Signature"}),"\n",(0,s.jsxs)(n.p,{children:["Call signature looks similar to a function type,\nbut with a ",(0,s.jsx)(n.code,{children:":"})," colon instead of an ",(0,s.jsx)(n.code,{children:"=>"})," arrow:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"type FunctionAlias = (input: string) => number\n\ninterface CallSignature {\n  (input: string): number\n}\n\n// Type: (input: string) => number\nconst typedFunctionAlias: FunctionAlias = input => input.length // Ok\n\n// Type: (input: string) => number\nconst typedCallSignature: CallSignature = input => input.length // Ok\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Call signatures can be used to describe functions\nthat have some ",(0,s.jsx)(n.strong,{children:"additional user-defined property"})," on them:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"interface FunctionWithCount {\n  count: number\n  (): void\n}\n\nlet hasCallCount: FunctionWithCount\n\nfunction keepsTrackOfCalls() {\n  keepsTrackOfCalls.count += 1\n  console.log(`I've been called ${keepsTrackOfCalls.count} times!`)\n}\n\nkeepsTrackOfCalls.count = 0\n\nhasCallCount = keepsTrackOfCalls // Ok\n\nfunction doesNotHaveCount() {\n  console.log('No idea!')\n}\n\nhasCallCount = doesNotHaveCount\n// Error: Property 'count' is missing in type\n// '() => void' but required in type 'FunctionWithCalls'\n"})}),"\n",(0,s.jsx)(n.h2,{id:"index-signature",children:"Index Signature"}),"\n",(0,s.jsxs)(n.p,{children:["For ",(0,s.jsx)(n.code,{children:"JavaScript"}),",\nimplicitly calls ",(0,s.jsx)(n.code,{children:"toString"})," on any object index signature:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const obj = {\n  toString() {\n    console.log('toString called')\n    return 'Hello'\n  },\n}\n\nconst foo: any = {}\nfoo[obj] = 'World' // toString called\nconsole.log(foo[obj]) // toString called, World\nconsole.log(foo.Hello) // World\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"TypeScript"})," will give an error to prevent beginners from doing such things,\nthrow ",(0,s.jsx)(n.strong,{children:"index signature error"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"Element implicitly has an 'any' type\nbecause expression of type 'string' can't be used to index type XXX.\n"})}),"\n",(0,s.jsx)(n.p,{children:"Can fixed with:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Record<string, T>"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"K extends keyof T"}),": explicit Constrained key type."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// propertyName should be extends keyof T\nfunction getProperty<T, K extends keyof T>(o: T, propertyName: K): T[K] {\n  return o[propertyName] // o[propertyName] is of type T[K]\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"type-check",children:"Type Check"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const x: { foo: number, [x: string]: any }\nx = { foo: 1, baz: 2 } // ok, 'baz' \u5C5E\u6027\u5339\u914D\u4E8E\u7D22\u5F15\u7B7E\u540D\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5F53\u4F60\u58F0\u660E\u4E00\u4E2A\u7D22\u5F15\u7B7E\u540D\u65F6\uFF0C\u6240\u6709\u660E\u786E\u7684\u6210\u5458\u90FD\u5FC5\u987B\u7B26\u5408\u7D22\u5F15\u7B7E\u540D:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// ok\ninterface Foo {\n  [key: string]: number\n  x: number\n  y: number\n}\n\n// Error\ninterface Bar {\n  [key: string]: number\n  x: number\n  y: string // Error: y \u5C5E\u6027\u5FC5\u987B\u4E3A number \u7C7B\u578B\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u4F7F\u7528\u4EA4\u53C9\u7C7B\u578B\u53EF\u4EE5\u89E3\u51B3\u4E0A\u8FF0\u95EE\u9898:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"interface FieldState {\n  value: string\n}\n\ntype FormState = { isValid: boolean } & Record<string, FieldState>\n"})}),"\n",(0,s.jsx)(n.h3,{id:"select",children:"Select"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"type Index = 'a' | 'b' | 'c'\ntype FromIndex = { [k in Index]?: number }\n\nconst good: FromIndex = { b: 1, c: 2 }\n\n// Error:\n// `{ b: 1, c: 2, d: 3 }` \u4E0D\u80FD\u5206\u914D\u7ED9 'FromIndex'\n// \u5BF9\u8C61\u5B57\u9762\u91CF\u53EA\u80FD\u6307\u5B9A\u5DF2\u77E5\u7C7B\u578B\uFF0C'd' \u4E0D\u5B58\u5728 'FromIndex' \u7C7B\u578B\u4E0A\nconst bad: FromIndex = { b: 1, c: 2, d: 3 }\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"type FromSomeIndex<K extends string> = { [key in K]: number }\n"})}),"\n",(0,s.jsx)(n.h3,{id:"symbol",children:"Symbol"}),"\n",(0,s.jsxs)(n.p,{children:["Since ",(0,s.jsx)(n.a,{href:"https://github.com/microsoft/TypeScript/pull/44512",children:"typescript v4.4.0"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"type SymbolMap<T> = Record<symbol, T>\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"interface PropertyMap {\n  [key: string]: string\n  [key: number]: string\n  [key: symbol]: string\n}\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"type Colors = Record<symbol, number>\n\nconst red = Symbol('red')\nconst green = Symbol('green')\nconst blue = Symbol('blue')\n\nconst colors: Colors = {}\n\ncolors[red] = 255 // Assignment of a number is allowed\nconst redVal = colors[red] // 'redVal' has the type 'number'\n\ncolors[blue] = 'da ba dee' // Error: Type 'string' is not assignable to type 'number'.\n"})}),"\n",(0,s.jsx)(n.h3,{id:"template-literal",children:"Template Literal"}),"\n",(0,s.jsxs)(n.p,{children:["Since ",(0,s.jsx)(n.a,{href:"https://github.com/microsoft/TypeScript/pull/44512",children:"typescript v4.4.0"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"type DataProps = Record<`data-${string}`, string>\n\ninterface OptionsWithDataProps extends Options {\n  // Permit any property starting with 'data-'.\n  [optName: `data-${string}`]: unknown\n}\n\nconst b: OptionsWithDataProps = {\n  'width': 100,\n  'height': 100,\n  'data-blah': true, // Works!\n  'unknown-property': true, // Error! 'unknown-property' wasn't declared in 'OptionsWithDataProps'.\n}\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"type Thing<T> = Record<'a' | `foo${T}` | symbol, string>\n\ntype StringThing = Thing<string>\n// => { [a: string, [x: `foo${string}`]: string, [x: symbol]: string }\ntype BarThing = Thing<'bar'>\n// => { [a: string, foobar: string, [x: symbol]: string }\n"})}),"\n",(0,s.jsx)(n.h3,{id:"indexed-access-types",children:"Indexed Access Types"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const MyArray = [\n  { name: 'Alice', age: 15 },\n  { name: 'Bob', age: 23 },\n  { name: 'Eve', age: 38 },\n]\n\ntype Person = (typeof MyArray)[number]\n// type Person = {\n//   name: string;\n//   age: number;\n// }\n\ntype Age = (typeof MyArray)[number]['age']\n// type Age = number\n\ntype Age2 = Person['age']\n// type Age2 = number\n\ninterface UserRoleConfig {\n  visitor: ['up']\n  user: ['view', 'create', 'update']\n  admin: ['view', 'create', 'update', 'delete']\n}\n\ntype Role = UserRoleConfig[keyof UserRoleConfig][number]\n// type Role = 'up' | 'view' | 'create' | 'update' | \"delete\"\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"{ [K in keyof T]: indexedType }[keyof T]"})," \u8FD4\u56DE\u952E\u540D (\u952E\u540D\u7EC4\u6210\u7684\u8054\u5408\u7C7B\u578B):"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"type PickByValueType<T, ValueType> = Pick<\n  T,\n  { [K in keyof T]-?: T[K] extends ValueType ? K : never }[keyof T]\n>\n\ntype OmitByValueType<T, ValueType> = Pick<\n  T,\n  { [K in keyof T]-?: T[K] extends ValueType ? never : K }[keyof T]\n>\n\ntype RequiredKeys<T> = {\n  [K in keyof T]-?: object extends Pick<T, K> ? never : K\n}[keyof T]\n\ntype OptionalKeys<T> = {\n  [K in keyof T]-?: object extends Pick<T, K> ? K : never\n}[keyof T]\n\ntype FunctionTypeKeys<T extends object> = {\n  [K in keyof T]-?: T[K] extends Function ? K : never\n}[keyof T]\n\ntype Filter<T extends object, ValueType> = {\n  [K in keyof T as ValueType extends T[K] ? K : never]: T[K]\n} // Filter<{name: string; id: number;}, string> => {name: string;}\n\ntype FuncName<T> = {\n  [K in keyof T]: T[K] extends Function ? K : never\n}[keyof T]\n"})})]})}function p(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},30416(e,n,t){t.d(n,{R:()=>o,x:()=>a});var r=t(59471);let s={},i=r.createContext(s);function o(e){let n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);