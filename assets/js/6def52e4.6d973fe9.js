"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([["96127"],{40571(e,n,t){t.r(n),t.d(n,{metadata:()=>r,default:()=>p,frontMatter:()=>o,contentTitle:()=>s,toc:()=>d,assets:()=>l});var r=JSON.parse('{"id":"programming/android/device","title":"Device","description":"Map","source":"@site/content/programming/android/device.md","sourceDirName":"programming/android","slug":"/programming/android/device","permalink":"/notes/programming/android/device","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/programming/android/device.md","tags":[{"inline":true,"label":"Programming","permalink":"/notes/tags/programming"},{"inline":true,"label":"Android","permalink":"/notes/tags/android"},{"inline":true,"label":"Device","permalink":"/notes/tags/device"},{"inline":true,"label":"Map","permalink":"/notes/tags/map"},{"inline":true,"label":"Sensor","permalink":"/notes/tags/sensor"}],"version":"current","lastUpdatedBy":"Sabertaz","lastUpdatedAt":1769518084000,"sidebarPosition":21,"frontMatter":{"sidebar_position":21,"tags":["Programming","Android","Device","Map","Sensor"]},"sidebar":"tutorialSidebar","previous":{"title":"Media","permalink":"/notes/programming/android/media"},"next":{"title":"NetWork","permalink":"/notes/programming/android/network"}}'),i=t(62615),a=t(30416);let o={sidebar_position:21,tags:["Programming","Android","Device","Map","Sensor"]},s="Device",l={},d=[{value:"Map",id:"map",level:2},{value:"Sensor",id:"sensor",level:2},{value:"Light",id:"light",level:3},{value:"Accelerometer",id:"accelerometer",level:3},{value:"Orientation",id:"orientation",level:3}];function c(e){let n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",pre:"pre",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"device",children:"Device"})}),"\n",(0,i.jsx)(n.h2,{id:"map",children:"Map"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'public class MainActivity extends Activity {\n\n  public static final int SHOW_LOCATION = 0;\n\n  private TextView positionTextView;\n\n  private LocationManager locationManager;\n\n  private String provider;\n\n  @Override\n  protected void onCreate(Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n    setContentView(R.layout.activity_main);\n    positionTextView = (TextView) findViewById(R.id.position_text_view);\n    locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);\n    // \u83B7\u53D6\u6240\u6709\u53EF\u7528\u7684\u4F4D\u7F6E\u63D0\u4F9B\u5668\n    List<String> providerList = locationManager.getProviders(true);\n    if (providerList.contains(LocationManager.GPS_PROVIDER)) {\n      provider = LocationManager.GPS_PROVIDER;\n    } else if (providerList.contains(LocationManager.NETWORK_PROVIDER)) {\n      provider = LocationManager.NETWORK_PROVIDER;\n    } else {\n      // \u5F53\u6CA1\u6709\u53EF\u7528\u7684\u4F4D\u7F6E\u63D0\u4F9B\u5668\u65F6\uFF0C\u5F39\u51FAToast\u63D0\u793A\u7528\u6237\n      Toast.makeText(this, "No location provider to use",\n          Toast.LENGTH_SHORT).show();\n      return;\n    }\n    Location location = locationManager.getLastKnownLocation(provider);\n    if (location != null) {\n      // \u663E\u793A\u5F53\u524D\u8BBE\u5907\u7684\u4F4D\u7F6E\u4FE1\u606F\n      showLocation(location);\n    }\n    locationManager.requestLocationUpdates(provider, 5000, 1,\n        locationListener);\n  }\n\n  protected void onDestroy() {\n    super.onDestroy();\n    if (locationManager != null) {\n      // \u5173\u95ED\u7A0B\u5E8F\u65F6\u5C06\u76D1\u542C\u5668\u79FB\u9664\n      locationManager.removeUpdates(locationListener);\n    }\n  }\n\n  LocationListener locationListener = new LocationListener() {\n\n    @Override\n    public void onStatusChanged(String provider, int status, Bundle extras) {\n    }\n\n    @Override\n    public void onProviderEnabled(String provider) {\n    }\n\n    @Override\n    public void onProviderDisabled(String provider) {\n    }\n\n    @Override\n    public void onLocationChanged(Location location) {\n      // \u66F4\u65B0\u5F53\u524D\u8BBE\u5907\u7684\u4F4D\u7F6E\u4FE1\u606F\n      showLocation(location);\n    }\n  };\n\n  private void showLocation(final Location location) {\n    new Thread(new Runnable() {\n      @Override\n      public void run() {\n        try {\n          // \u7EC4\u88C5\u53CD\u5411\u5730\u7406\u7F16\u7801\u7684\u63A5\u53E3\u5730\u5740\n          StringBuilder url = new StringBuilder();\n          url.append("https://maps.googleapis.com/maps/api/geocode/json?latlng=");\n          url.append(location.getLatitude()).append(",")\n              .append(location.getLongitude());\n          url.append("&sensor=false");\n          HttpClient httpClient = new DefaultHttpClient();\n          HttpGet httpGet = new HttpGet(url.toString());\n          // \u5728\u8BF7\u6C42\u6D88\u606F\u5934\u4E2D\u6307\u5B9A\u8BED\u8A00\uFF0C\u4FDD\u8BC1\u670D\u52A1\u5668\u4F1A\u8FD4\u56DE\u4E2D\u6587\u6570\u636E\n          httpGet.addHeader("Accept-Language", "zh-CN");\n          HttpResponse httpResponse = httpClient.execute(httpGet);\n          if (httpResponse.getStatusLine().getStatusCode() == 200) {\n            HttpEntity entity = httpResponse.getEntity();\n            String response = EntityUtils.toString(entity, "utf-8");\n            JSONObject jsonObject = new JSONObject(response);\n            // \u83B7\u53D6results\u8282\u70B9\u4E0B\u7684\u4F4D\u7F6E\u4FE1\u606F\n            JSONArray resultArray = jsonObject.getJSONArray("results");\n            if (resultArray.length() > 0) {\n              JSONObject subObject = resultArray.getJSONObject(0);\n              // \u53D6\u51FA\u683C\u5F0F\u5316\u540E\u7684\u4F4D\u7F6E\u4FE1\u606F\n              String address = subObject.getString("formatted_address");\n              Message message = new Message();\n              message.what = SHOW_LOCATION;\n              message.obj = address;\n              handler.sendMessage(message);\n            }\n          }\n        } catch (Exception e) {\n          e.printStackTrace();\n        }\n      }\n    }).start();\n  }\n\n  private Handler handler = new Handler() {\n\n    public void handleMessage(Message msg) {\n      switch (msg.what) {\n      case SHOW_LOCATION:\n        String currentPosition = (String) msg.obj;\n        positionTextView.setText(currentPosition);\n        break;\n      default:\n        break;\n      }\n    }\n\n  };\n\n}\n\n'})}),"\n",(0,i.jsx)(n.h2,{id:"sensor",children:"Sensor"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"SensorManager sensorManager = (SensorManager)getSystemService(Context.SENSOR_SERVICE);\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"SensorEventListener listener = new SensorEventListener() {\n    @Override\n    public void onAccuracyChanged(Sensor sensor, int accuracy) {\n    }\n    @Override\n    public void onSensorChanged(SensorEvent event) {\n    }\n};\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"sensorManager.registerListener(listener, sensor, SensorManager.SENSOR_DELAY_NORMAL);\nsensorManager.unregisterListener(listener);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"light",children:"Light"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"Sensor sensor = sensorManager.getDefaultSensor(Sensor.TYPE_LIGHT);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"accelerometer",children:"Accelerometer"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"Sensor sensor = sensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"orientation",children:"Orientation"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"Sensor sensor = sensorManager.getDefaultSensor(Sensor.TYPE_ORIENTATION);\n"})})]})}function p(e={}){let{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},30416(e,n,t){t.d(n,{R:()=>o,x:()=>s});var r=t(59471);let i={},a=r.createContext(i);function o(e){let n=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);