"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([["62606"],{36960(e,n,i){i.r(n),i.d(n,{metadata:()=>r,default:()=>h,frontMatter:()=>l,contentTitle:()=>a,toc:()=>o,assets:()=>c});var r=JSON.parse('{"id":"ai/gen/agent/eval","title":"Eval","description":"Principles","source":"@site/content/ai/gen/agent/eval.md","sourceDirName":"ai/gen/agent","slug":"/ai/gen/agent/eval","permalink":"/notes/ai/gen/agent/eval","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/ai/gen/agent/eval.md","tags":[{"inline":true,"label":"AI","permalink":"/notes/tags/ai"},{"inline":true,"label":"Generative AI","permalink":"/notes/tags/generative-ai"},{"inline":true,"label":"LLM","permalink":"/notes/tags/llm"},{"inline":true,"label":"Agent","permalink":"/notes/tags/agent"},{"inline":true,"label":"Eval","permalink":"/notes/tags/eval"}],"version":"current","lastUpdatedBy":"sabertazimi","lastUpdatedAt":1770002107000,"sidebarPosition":22,"frontMatter":{"sidebar_position":22,"tags":["AI","Generative AI","LLM","Agent","Eval"]},"sidebar":"tutorialSidebar","previous":{"title":"Security","permalink":"/notes/ai/gen/agent/security"},"next":{"title":"Toolchain","permalink":"/notes/ai/gen/agent/toolchain"}}'),s=i(62615),t=i(30416);let l={sidebar_position:22,tags:["AI","Generative AI","LLM","Agent","Eval"]},a="Eval",c={},o=[{value:"Principles",id:"principles",level:2},{value:"Targets",id:"targets",level:2},{value:"Methods",id:"methods",level:2},{value:"Metrics",id:"metrics",level:2},{value:"Regression",id:"regression",level:3},{value:"Performance",id:"performance",level:3},{value:"Cost",id:"cost",level:3},{value:"Effectiveness",id:"effectiveness",level:3},{value:"Quality",id:"quality",level:3},{value:"LLM",id:"llm",level:2},{value:"Human",id:"human",level:2},{value:"Trace",id:"trace",level:2},{value:"Trajectory",id:"trajectory",level:2},{value:"Benchmarks",id:"benchmarks",level:2},{value:"References",id:"references",level:2}];function d(e){let n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"eval",children:"Eval"})}),"\n",(0,s.jsx)(n.h2,{id:"principles",children:"Principles"}),"\n",(0,s.jsxs)(n.p,{children:["Agents ",(0,s.jsx)(n.a,{href:"https://www.anthropic.com/engineering/demystifying-evals-for-ai-agents",children:"eval"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Start early."}),"\n",(0,s.jsx)(n.li,{children:"Source realistic tasks from failures."}),"\n",(0,s.jsx)(n.li,{children:"Define unambiguous, robust success criteria."}),"\n",(0,s.jsx)(n.li,{children:"Design graders thoughtfully and combine multiple types (code-based, model-based, human)."}),"\n",(0,s.jsx)(n.li,{children:"Make sure the problems are hard enough for model."}),"\n",(0,s.jsx)(n.li,{children:"Iterate on evaluations to improve signal-to-noise ratio."}),"\n",(0,s.jsx)(n.li,{children:"Read transcripts (\u8BB0\u5F55)."}),"\n",(0,s.jsxs)(n.li,{children:["Pick framework:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/promptfoo/promptfoo",children:"Promptfoo"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/laude-institute/harbor",children:"Harbor"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/laude-institute/terminal-bench",children:"Terminal"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.admonition,{title:"Agent Failure",type:"tip",children:[(0,s.jsxs)(n.p,{children:["\u667A\u80FD\u4F53\u7684\u5931\u8D25\u901A\u5E38\u4E0D\u662F\u7CFB\u7EDF\u5D29\u6E83, \u800C\u662F\u8D28\u91CF\u7684\u7EC6\u5FAE\u9000\u5316,\n\u6E90\u4E8E\u6A21\u578B\u6743\u91CD\u3001\u8BAD\u7EC3\u6570\u636E\u548C\u73AF\u5883\u4EA4\u4E92\u7684\u590D\u6742\u76F8\u4E92\u4F5C\u7528.\n\u8FD9\u4E9B\u5931\u8D25\u662F",(0,s.jsx)(n.strong,{children:"\u9690\u6666\u7684"}),":"]}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Algorithm bias."}),"\n",(0,s.jsx)(n.li,{children:"Factual hallucination."}),"\n",(0,s.jsx)(n.li,{children:"Concept drift: \u6027\u80FD\u968F\u65F6\u95F4\u63A8\u79FB\u800C\u4E0B\u964D, \u65E0\u6CD5\u53D1\u73B0\u65B0\u95EE\u9898."}),"\n",(0,s.jsx)(n.li,{children:"Emergent unintended behaviors."}),"\n"]})]}),"\n",(0,s.jsx)(n.h2,{id:"targets",children:"Targets"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Effectiveness: goal achievement."}),"\n",(0,s.jsx)(n.li,{children:"Efficiency: operational cost."}),"\n",(0,s.jsx)(n.li,{children:"Robustness: reliability."}),"\n",(0,s.jsx)(n.li,{children:"Safety and alignment: trustworthiness."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"methods",children:"Methods"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Method"}),(0,s.jsx)(n.th,{children:"\u{1F44D} Strengths"}),(0,s.jsx)(n.th,{children:"\u{1F44E} Weaknesses"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Automated Metrics"}),(0,s.jsx)(n.td,{children:"Objective, scalable, efficient"}),(0,s.jsx)(n.td,{children:"May not capture full capabilities"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"LLM-as-a-Judge"}),(0,s.jsx)(n.td,{children:"Consistent, scalable, efficient"}),(0,s.jsx)(n.td,{children:"May overlook intermediate steps, limited by LLM capabilities"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Human Evaluation"}),(0,s.jsx)(n.td,{children:"Captures nuanced behavior"}),(0,s.jsx)(n.td,{children:"Subjective, time-consuming, expensive, difficult to scale"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"metrics",children:"Metrics"}),"\n",(0,s.jsx)(n.h3,{id:"regression",children:"Regression"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"String-based similarity: ROUGE, BLEU."}),"\n",(0,s.jsx)(n.li,{children:"Embedding-based similarity: BERTScore, cosine similarity."}),"\n",(0,s.jsx)(n.li,{children:"Task-specific benchmarks."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"performance",children:"Performance"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Latency: P50, P90, P99."}),"\n",(0,s.jsx)(n.li,{children:"Error rate."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"cost",children:"Cost"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Tokens per task."}),"\n",(0,s.jsx)(n.li,{children:"API cost per run."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"effectiveness",children:"Effectiveness"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Task completion rate."}),"\n",(0,s.jsx)(n.li,{children:"Tool usage frequency."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"quality",children:"Quality"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Correctness."}),"\n",(0,s.jsx)(n.li,{children:"Accuracy."}),"\n",(0,s.jsx)(n.li,{children:"Relevance."}),"\n",(0,s.jsx)(n.li,{children:"Trajectory adherence."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"llm",children:"LLM"}),"\n",(0,s.jsx)(n.p,{children:"Robust pairwise comparison:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-md",children:'You are an expert evaluator for a customer support chatbot.\nYour goal is to assess which of two responses is more helpful, polite, and correct.\n\n[User Query]\n"Hi, my order #12345 hasn\'t arrived yet."\n\n[Answer A]\n"I can see that order #12345 is currently out for delivery and should arrive by 5 PM today."\n\n[Answer B]\n"Order #12345 is on the truck. It will be there by 5."\n\nPlease evaluate which answer is better. Compare them on correctness, helpfulness, and tone.\nProvide reasoning and output final decision in JSON object with "winner" key ("A", "B", or "tie") and "rationale" key.\n'})}),"\n",(0,s.jsx)(n.p,{children:"Critic agent:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-md",children:"1. Based on the trace, was the initial plan logical?\n2. Was the {tool_A} tool the correct first choice, or should another tool have been used?\n3. Were the arguments correct and properly formatted?\n"})}),"\n",(0,s.jsx)(n.h2,{id:"human",children:"Human"}),"\n",(0,s.jsx)(n.p,{children:"Human-in-the-Loop (HITL):"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Domain expertise: \u9886\u57DF\u4E13\u4E1A\u77E5\u8BC6."}),"\n",(0,s.jsx)(n.li,{children:"Interpreting nuance: \u89E3\u91CA\u7EC6\u5FAE\u5DEE\u522B."}),"\n",(0,s.jsx)(n.li,{children:"Golden set: \u5C06\u751F\u4EA7\u6545\u969C\u8F6C\u5316\u4E3A\u6D4B\u8BD5\u7528\u4F8B."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"trace",children:"Trace"}),"\n",(0,s.jsxs)(n.p,{children:["When building agents, ",(0,s.jsx)(n.a,{href:"https://x.com/hwchase17/status/2010044779225329688",children:"trace"})," is the source of truth:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Debugging becomes trace analysis"}),"\n",(0,s.jsx)(n.li,{children:"Testing becomes eval-driven"}),"\n",(0,s.jsx)(n.li,{children:"Can't set breakpoints in reasoning"}),"\n",(0,s.jsx)(n.li,{children:"Performance optimization changes: task success rate, reasoning quality, tool usage efficiency"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://www.kaggle.com/whitepaper-agent-quality",children:(0,s.jsx)(n.img,{alt:"Trace",src:i(6429).A+"",title:"Trace",width:"1552",height:"808"})})}),"\n",(0,s.jsx)(n.h2,{id:"trajectory",children:"Trajectory"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Trajectory"})," is equally important as ",(0,s.jsx)(n.strong,{children:"final response"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Exact match: produce trajectory that perfectly mirrors ideal solution."}),"\n",(0,s.jsx)(n.li,{children:"In-order match: complete expected trajectory, while accommodating extra, un-penalized actions."}),"\n",(0,s.jsx)(n.li,{children:"Any-order match: include all necessary actions."}),"\n",(0,s.jsx)(n.li,{children:"Precision: relevant tool calls."}),"\n",(0,s.jsx)(n.li,{children:"Recall: essential tool calls."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://www.kaggle.com/whitepaper-agent-companion",children:(0,s.jsx)(n.img,{alt:"Trajectory",src:i(25215).A+"",width:"1160",height:"696"})})}),"\n",(0,s.jsx)(n.admonition,{title:"Trajectory Score",type:"tip",children:(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Response match score."}),"\n",(0,s.jsx)(n.li,{children:"Tool trajectory score."}),"\n"]})}),"\n",(0,s.jsx)(n.h2,{id:"benchmarks",children:"Benchmarks"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://blog.sshh.io/p/understanding-ai-benchmarks",children:"Benchmarks"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Aggregate: Don\u2019t obsess over a 1-2% lead on one benchmark, focus on specific and comprehensive domain."}),"\n",(0,s.jsx)(n.li,{children:"Relative: Compare within the same model family or lab, how did the score change from v1 to v2?"}),"\n",(0,s.jsx)(n.li,{children:"Verify: The only benchmark that matters at the end of the day is your workload."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Agent evaluation ",(0,s.jsx)(n.a,{href:"https://www.kaggle.com/whitepaper-agent-companion",children:"whitepaper"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Agent quality ",(0,s.jsx)(n.a,{href:"https://www.kaggle.com/whitepaper-agent-quality",children:"whitepaper"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Claude Opus 4.5 ",(0,s.jsx)(n.a,{href:"https://assets.anthropic.com/m/64823ba7485345a7/Claude-Opus-4-5-System-Card.pdf",children:"system card"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Autonomous agents ",(0,s.jsx)(n.a,{href:"https://github.com/GAIR-NLP/AgencyBench",children:"benchmark"}),"."]}),"\n"]})]})}function h(e={}){let{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},6429(e,n,i){i.d(n,{A:()=>r});let r=i.p+"assets/images/trace-8731493b0688ce7f7d73071df3169553.png"},25215(e,n,i){i.d(n,{A:()=>r});let r=i.p+"assets/images/trajectory-98c945d1745ae924af5db69a6e9f1312.png"},30416(e,n,i){i.d(n,{R:()=>l,x:()=>a});var r=i(59471);let s={},t=r.createContext(s);function l(e){let n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);