"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([["60438"],{32010(e,n,r){r.r(n),r.d(n,{metadata:()=>t,default:()=>p,frontMatter:()=>s,contentTitle:()=>i,toc:()=>a,assets:()=>c});var t=JSON.parse('{"id":"web/javascript/inheritance","title":"Inheritance","description":"Prototype Proxy","source":"@site/content/web/javascript/inheritance.md","sourceDirName":"web/javascript","slug":"/web/javascript/inheritance","permalink":"/notes/web/javascript/inheritance","draft":false,"unlisted":false,"editUrl":"https://github.com/sabertazimi/notes/edit/main/content/web/javascript/inheritance.md","tags":[{"inline":true,"label":"Web","permalink":"/notes/tags/web"},{"inline":true,"label":"JavaScript","permalink":"/notes/tags/java-script"},{"inline":true,"label":"ECMAScript","permalink":"/notes/tags/ecma-script"},{"inline":true,"label":"Object","permalink":"/notes/tags/object"}],"version":"current","lastUpdatedBy":"Sabertaz","lastUpdatedAt":1769518084000,"sidebarPosition":15,"frontMatter":{"sidebar_position":15,"tags":["Web","JavaScript","ECMAScript","Object"]},"sidebar":"tutorialSidebar","previous":{"title":"Property","permalink":"/notes/web/javascript/property"},"next":{"title":"Class","permalink":"/notes/web/javascript/class"}}'),o=r(62615),l=r(30416);let s={sidebar_position:15,tags:["Web","JavaScript","ECMAScript","Object"]},i="Inheritance",c={},a=[{value:"Prototype Proxy",id:"prototype-proxy",level:2},{value:"Class Simulation",id:"class-simulation",level:2},{value:"Composite",id:"composite",level:2},{value:"Clone",id:"clone",level:2},{value:"Shallow",id:"shallow",level:3},{value:"Deep",id:"deep",level:3},{value:"Global Object",id:"global-object",level:2}];function d(e){let n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"inheritance",children:"Inheritance"})}),"\n",(0,o.jsx)(n.h2,{id:"prototype-proxy",children:"Prototype Proxy"}),"\n",(0,o.jsx)(n.p,{children:"\u53EF\u7528\u4E8E\u6240\u6709\u7EE7\u627F\u6A21\u5F0F\u4E2D, \u51CF\u5C11\u5185\u5B58\u6D88\u8017:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"const inherit = (function () {\n  // \u51CF\u5C11\u7EE7\u627F\u8FC7\u7A0B\u4E2D\u7236\u7C7B\u7684\u5B9E\u4F8B\u5316,\u51CF\u5C11\u8D44\u6E90\u6D88\u8017\n  // \u5B9E\u4F8B\u5316\u4E00\u4E2A\u7A7A\u7C7B\u6240\u9700\u8D44\u6E90\u66F4\u5C11\n  const F = function () {}\n  return function (C, P) {\n    // c.__proto__ = C.prototype = f\n    // f.__proto__ = F.prototype\n    // F.prototype = P.prototype\n    // c.__proto__.__proto__ = f.__proto__ = P.prototype\n    F.prototype = P.prototype // f.__proto__ = F.prototype = P.prototype\n    C.prototype = new F() // C.prototype = f\n    C.prototype.constructor = C\n    C.super = P.prototype // \u6B64\u53E5\u53EF\u63D0\u9AD8\u4EE3\u7801\u7684\u91CD\u7528\u6027\n  }\n})()\n\nChild.prototype.add = function () {\n  return Child.super.add.call(this)\n}\n"})}),"\n",(0,o.jsx)(n.h2,{id:"class-simulation",children:"Class Simulation"}),"\n",(0,o.jsx)(n.p,{children:"\u590D\u5236\u5F0F\u5730\u7EE7\u627F, \u5C06\u4F1A\u6D88\u8017\u5927\u91CF\u5185\u5B58\u5355\u5143:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"function classSim(Parent, props) {\n  // \u65B0\u7684\u6784\u9020\u51FD\u6570\n  const Child = function (...args) {\n    if (\n      Child.uber\n      && Object.prototype.hasOwnProperty.call(Child.uber, '_construct')\n    ) {\n      Child.uber._construct.apply(this, args)\n    }\n\n    if (Object.prototype.hasOwnProperty.call(Child.prototype, '_construct'))\n      Child.prototype._construct.apply(this, args)\n  }\n\n  // \u7C7B\u5F0F\u7EE7\u627F\n  Parent = Parent || Object\n\n  // \u4EE3\u7406\u6784\u9020\u51FD\u6570F\n  const F = function () {}\n  F.prototype = Parent.prototype\n  Child.prototype = new F()\n  Child.prototype.constructor = Child\n\n  // \u6DFB\u52A0\u5C5E\u6027\u4E0E\u65B9\u6CD5\n  for (const i in props) {\n    if (Object.prototype.hasOwnProperty.call(props, i))\n      Child.prototype[i] = props[i]\n  }\n\n  // return the \"class\"\n  return Child\n}\n\nconst SuperMan = classSim(Man, {\n  _construct(what) {\n    console.log('SuperMan\\'s constructor')\n  },\n  getName() {\n    const name = SuperMan.uber.getName.call(this)\n    return `I am ${name}`\n  },\n})\n"})}),"\n",(0,o.jsx)(n.h2,{id:"composite",children:"Composite"}),"\n",(0,o.jsxs)(n.p,{children:["\u539F\u578B\u7EE7\u627F (",(0,o.jsx)(n.strong,{children:"\u8BBE\u7F6E\u539F\u578B"}),")\n\u4E0E\u7C7B\u5F0F\u7EE7\u627F (",(0,o.jsx)(n.strong,{children:"\u501F\u7528\u6784\u9020\u51FD\u6570"}),")\n\u7EC4\u5408\u7EE7\u627F\u6A21\u5F0F:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"child.prototype = new Parent(); Child.prototype.constructor = Child"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"Parent.apply(this, arguments)"}),": \u501F\u7528\u6784\u9020\u51FD\u6570\u53EF\u4EE5\u9632\u6B62\u5F15\u7528\u7C7B\u578B\u88AB\u8FEB\u5171\u4EAB."]}),"\n",(0,o.jsx)(n.li,{children:"\u6B64\u6A21\u5F0F\u4F1A\u8C03\u7528\u4E24\u6B21\u7236\u7C7B\u6784\u9020\u51FD\u6570, \u4F7F\u5F97\u5B50\u7C7B\u5C5E\u6027\u7EE7\u627F\u4E24\u6B21, \u5B58\u5728\u4E00\u5B9A\u7684\u6548\u7387\u95EE\u9898."}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"function Parent(name) {\n  this.name = name || 'Adam'\n}\n// Adding functionality to the prototype\nParent.prototype.say = function () {\n  return this.name\n}\n\n// Child constructor\nfunction Child(...args) {\n  // \u89E3\u51B3\u5F15\u7528\u7C7B\u578B\u5171\u4EAB\u95EE\u9898\n  Parent.apply(this, args)\n  this.childName = 'Child Name'\n}\n\n// Child.prototype = Object.create(Parent.prototype);\nChild.prototype = new Parent() // \u8BBE\u7F6E\u539F\u578B\u94FE,\u5EFA\u7ACB\u7EE7\u627F\u5173\u7CFB\nChild.prototype.constructor = Child // \u4F7F\u5F97 Prototype \u5BF9\u8C61\u4E0E Constructor \u5BF9\u8C61\u5F62\u6210\u95ED\u73AF\n"})}),"\n",(0,o.jsx)(n.h2,{id:"clone",children:"Clone"}),"\n",(0,o.jsx)(n.h3,{id:"shallow",children:"Shallow"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"Object.assign"}),":"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Enumerable: ",(0,o.jsx)(n.strong,{children:"\u53EF\u679A\u4E3E"}),"\u5C5E\u6027\u6269\u5C55."]}),"\n",(0,o.jsxs)(n.li,{children:["Own: ",(0,o.jsx)(n.strong,{children:"\u81EA\u6709"}),"\u5C5E\u6027\u6269\u5C55."]}),"\n",(0,o.jsxs)(n.li,{children:["Shallow: ",(0,o.jsx)(n.strong,{children:"\u6D45\u62F7\u8D1D"}),"\u6269\u5C55."]}),"\n",(0,o.jsxs)(n.li,{children:["Trigger ",(0,o.jsx)(n.code,{children:"sourceObj.set"})," and change ",(0,o.jsx)(n.code,{children:"sourceObj"}),"."]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"const dest = {}\nconst src = { a: {} }\nObject.assign(dest, src)\n\n// \u6D45\u590D\u5236\u610F\u5473\u7740\u53EA\u4F1A\u590D\u5236\u5BF9\u8C61\u7684\u5F15\u7528\nconsole.log(dest) // { a :{} }\nconsole.log(dest.a === src.a) // true\n"})}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"..."})," object spread syntax:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Enumerable: ",(0,o.jsx)(n.strong,{children:"\u53EF\u679A\u4E3E"}),"\u5C5E\u6027\u6269\u5C55."]}),"\n",(0,o.jsxs)(n.li,{children:["Own: ",(0,o.jsx)(n.strong,{children:"\u81EA\u6709"}),"\u5C5E\u6027\u6269\u5C55."]}),"\n",(0,o.jsxs)(n.li,{children:["Shallow: ",(0,o.jsx)(n.strong,{children:"\u6D45\u62F7\u8D1D"}),"\u6269\u5C55."]}),"\n",(0,o.jsxs)(n.li,{children:["Not copy prototype (",(0,o.jsx)(n.code,{children:"__proto__"}),")."]}),"\n",(0,o.jsx)(n.li,{children:"Not copy getter and setter."}),"\n",(0,o.jsxs)(n.li,{children:["Not trigger ",(0,o.jsx)(n.code,{children:"sourceObj.set"})," and not change ",(0,o.jsx)(n.code,{children:"sourceObj"})," (create new properties)."]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"// Shallow copy\nconst foo = { a: 1 }\nconst bar = { b: 2, c: { d: 3 } }\nconst foobar = { ...foo, ...bar }\nconsole.log(foobar.c === bar.c) // true\n\n// Not copy prototype (`__proto__`)\nclass MyClass {}\nconst original = new MyClass()\nassert.equal(original instanceof MyClass, true)\nconst copy = { ...original }\nassert.equal(copy instanceof MyClass, false)\n"})}),"\n",(0,o.jsx)(n.h3,{id:"deep",children:"Deep"}),"\n",(0,o.jsx)(n.p,{children:"Recursively copy all properties of an object:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"function deepClone(original) {\n  if (Array.isArray(original)) {\n    return original.map(elem => deepClone(elem))\n  } else if (typeof original === 'object' && original !== null) {\n    return Object.fromEntries(\n      Object.entries(original).map(([key, value]) => [key, deepClone(value)])\n    )\n  } else {\n    // Primitive value: atomic, no need to copy\n    return original\n  }\n}\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"function deepUpdate(original, keys, value) {\n  if (keys.length === 0)\n    return value\n\n  const currentKey = keys[0]\n\n  if (Array.isArray(original)) {\n    return original.map((v, index) =>\n      index === currentKey ? deepUpdate(v, keys.slice(1), value) : v\n    )\n  } else if (typeof original === 'object' && original !== null) {\n    return Object.fromEntries(\n      Object.entries(original).map(([k, v]) =>\n        k === currentKey ? [k, deepUpdate(v, keys.slice(1), value)] : [k, v]\n      )\n    )\n  } else {\n    // Primitive value\n    return original\n  }\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Using ",(0,o.jsx)(n.code,{children:"JSON.parse(JSON.stringify(obj))"}),":"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Not copy prototype (",(0,o.jsx)(n.code,{children:"__proto__"}),")."]}),"\n",(0,o.jsx)(n.li,{children:"Not copy getter and setter."}),"\n",(0,o.jsx)(n.li,{children:"Not copy non-enumerable properties."}),"\n",(0,o.jsx)(n.li,{children:"Not copy Symbol properties."}),"\n",(0,o.jsx)(n.li,{children:"Not copy circular references."}),"\n",(0,o.jsxs)(n.li,{children:["Not copy ",(0,o.jsx)(n.code,{children:"undefined"}),", ",(0,o.jsx)(n.code,{children:"function"}),", ",(0,o.jsx)(n.code,{children:"symbol"}),"."]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"const obj = { a: 1, b: { c: 2 } }\nconst clone = JSON.parse(JSON.stringify(obj))\nconsole.log(clone) // { a: 1, b: { c: 2 } }\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Using ",(0,o.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/structuredClone",children:(0,o.jsx)(n.code,{children:"window.structuredClone()"})}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"// Create an object with a value and a circular reference to itself.\nconst original = { name: 'MDN' }\noriginal.itself = original\n\n// Clone it\nconst clone = structuredClone(original)\n\nconsole.assert(clone !== original) // the objects are not the same (not same identity)\nconsole.assert(clone.name === 'MDN') // they do have the same values\nconsole.assert(clone.itself === clone) // and the circular reference is preserved\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:'const room1 = {\n  people: [\'Alan\', \'Bob\'],\n}\n\nconst room2 = structuredClone(room1)\n\nroom2.people.push(\'Charlie\')\nroom1.people.pop()\n\nconsole.log(room2.people) // ["Alan", "Bob", "Charlie"]\nconsole.log(room1.people) // ["Alan"]\n'})}),"\n",(0,o.jsx)(n.h2,{id:"global-object",children:"Global Object"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.a,{href:"https://exploringjs.com/deep-js/ch_global-scope.html",children:(0,o.jsx)(n.img,{alt:"Global Scope",src:r(75239).A+"",width:"1447",height:"823"})})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"// \u7ACB\u5373\u51FD\u6570\u6A21\u5F0F:\n// \u6B64\u65F6\u8FD4\u56DE\u503C\u4E0D\u662F\u51FD\u6570\u672C\u8EAB, \u800C\u662F\u51FD\u6570\u6267\u884C\u540E\u7684 return \u8BED\u53E5\u8FD4\u56DE\u503C.\nconst global = (function () {\n  // \u8FD4\u56DE\u5168\u5C40\u5BF9\u8C61\n  return this\n})()\n"})}),"\n",(0,o.jsx)(n.p,{children:"Global Object \u5C5E\u6027:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"undefined."}),"\n",(0,o.jsx)(n.li,{children:"NaN."}),"\n",(0,o.jsx)(n.li,{children:"Infinity."}),"\n",(0,o.jsx)(n.li,{children:"Object."}),"\n",(0,o.jsx)(n.li,{children:"Array."}),"\n",(0,o.jsx)(n.li,{children:"Function."}),"\n",(0,o.jsx)(n.li,{children:"Boolean."}),"\n",(0,o.jsx)(n.li,{children:"String."}),"\n",(0,o.jsx)(n.li,{children:"Number."}),"\n",(0,o.jsx)(n.li,{children:"Date."}),"\n",(0,o.jsx)(n.li,{children:"RegExp."}),"\n",(0,o.jsx)(n.li,{children:"Symbol."}),"\n",(0,o.jsx)(n.li,{children:"Error."}),"\n",(0,o.jsx)(n.li,{children:"EvalError."}),"\n",(0,o.jsx)(n.li,{children:"RangeError."}),"\n",(0,o.jsx)(n.li,{children:"ReferenceError."}),"\n",(0,o.jsx)(n.li,{children:"SyntaxError."}),"\n",(0,o.jsx)(n.li,{children:"TypeError."}),"\n",(0,o.jsx)(n.li,{children:"URIError."}),"\n",(0,o.jsx)(n.li,{children:"encodeURI."}),"\n",(0,o.jsx)(n.li,{children:"encodeURIComponent."}),"\n",(0,o.jsx)(n.li,{children:"decodeURI."}),"\n",(0,o.jsx)(n.li,{children:"decodeURIComponent."}),"\n",(0,o.jsx)(n.li,{children:"eval."}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:";(function () {\n  // Grab browser's default global variables.\n  const iframe = window.document.createElement('iframe')\n  iframe.src = 'about:blank'\n  window.document.body.appendChild(iframe)\n  const browserGlobals = Object.keys(iframe.contentWindow)\n  window.document.body.removeChild(iframe)\n\n  // Get the global variables added at runtime by filtering out the browser's\n  // default global variables from the current window object.\n  const runtimeGlobals = Object.keys(window).filter((key) => {\n    const isFromBrowser = browserGlobals.includes(key)\n    return !isFromBrowser\n  })\n\n  console.log('Runtime globals', runtimeGlobals)\n})()\n"})})]})}function p(e={}){let{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},75239(e,n,r){r.d(n,{A:()=>t});let t=r.p+"assets/images/global-scope-1c99e41217be6d08f2578d375fd7efd2.png"},30416(e,n,r){r.d(n,{R:()=>s,x:()=>i});var t=r(59471);let o={},l=t.createContext(o);function s(e){let n=t.useContext(l);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),t.createElement(l.Provider,{value:n},e.children)}}}]);